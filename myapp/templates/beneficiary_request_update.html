{% extends 'base.html' %}{% load static %}{% block title %}الطلبات{% endblock %}
{% block head %}
<!-- Include jQuery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<!-- Include jQuery Validation Plugin -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js"></script>

<script src="{% static 'js/beneficiary_request_update.js' %}"></script>

{% endblock %}
{% block content %}
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
<div class="container mt-5">
  <div class="nav-breadcrumb mb-4">
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'home' %}">الصفحة الرئيسية</a></li>
        <li class="breadcrumb-item"><a href="{% url 'beneficiary_requests' username=user.username %}">الطلبات</a></li>
        <li class="breadcrumb-item active" aria-current="page">تفاصيل الطلب</li>
      </ol>
    </nav>
  </div>

  <div class="card bg-light">
    <div class="card-body">
      <h2 class="card-title fw-bold mt-3">تحديث بيانات الطلب</h2>
      <small class="text-muted">رقم الطلب #{{ request_id }}</small>
      <!-- Tabs navs -->
      <form
          id="edit_beneficiary_request_form"
          name="edit_beneficiary_request_form"
          enctype="multipart/form-data"
          method="POST"
          action="{% url 'beneficiary_request_update_confirm' username=user_info.username b_request_id=request_id %}"
          class="needs-validation"
          novalidate
        >
        {% csrf_token %}
        <div class="mt-4">

          <div class="alert alert-danger" role="alert" id="alert-danger-error-fields">
            
          </div>
          <ul class="nav nav-fill nav-tabs" role="tablist">
            <li class="nav-item" role="presentation">
              <a class="nav-link active text-dark next" id="fill-tab-0" data-bs-toggle="tab" href="#fill-tabpanel-0" role="tab" aria-controls="fill-tabpanel-0" aria-selected="true"> المعلومات الشخصية </a>
            </li>
            <li class="nav-item" role="presentation">
              <a class="nav-link text-dark next" id="fill-tab-1" data-bs-toggle="tab" href="#fill-tabpanel-1" role="tab" aria-controls="fill-tabpanel-1" aria-selected="false"> معلومات السكن </a>
            </li>
            <li class="nav-item" role="presentation">
              <a class="nav-link text-dark next" id="fill-tab-2" data-bs-toggle="tab" href="#fill-tabpanel-2" role="tab" aria-controls="fill-tabpanel-2" aria-selected="false"> معلومات الدخل والمصروفات </a>
            </li>
            <li class="nav-item" role="presentation">
              <a class="nav-link text-dark disabled" id="fill-tab-3" data-bs-toggle="tab" href="#fill-tabpanel-3" role="tab" aria-controls="fill-tabpanel-3" aria-selected="false"> معلومات المرافقين </a>
            </li>
            <li class="nav-item" role="presentation">
              <a class="nav-link text-dark disabled" id="fill-tab-4" data-bs-toggle="tab" href="#fill-tabpanel-4" role="tab" aria-controls="fill-tabpanel-4" aria-selected="false"> معلومات المرفقات </a>
            </li>
          </ul>
          <div class="tab-content pt-3" id="tab-content">
            <div class="tab-pane active" id="fill-tabpanel-0" role="tabpanel" aria-labelledby="fill-tab-0">

              <div class="personal_info">
                <h3 class="mt-4 mb-4">المعلومات الشخصية</h3>
                <div class="row row-cols-lg-2 row-cols-xl-4">
                  <div class="mb-3">
                    <h6 class="col form-label" for="id_personalinfo_file_no">رقم الملف</h6>
                    <input type="text" class="form-control" id="id_personalinfo_file_no" name="personalinfo_file_no" value="{{ beneficiary.file_no }}" disabled readonly>
                  </div>
                  <div class="mb-3">
                    <h6 class="col form-label" for="id_personalinfo_first_name">الأسم الأول<span style="color: red">*</span></h6>
                    <input type="text" class="form-control" id="id_personalinfo_first_name" name="personalinfo_first_name" data-bs-title="الأسم الأول" value="{{ beneficiary.first_name }}">
                  </div>
                  <div class="mb-3">
                    <h6 class="col form-label" for="id_personalinfo_second_name">الأسم الثاني<span style="color: red">*</span></h6>
                    <input type="text" class="form-control" id="id_personalinfo_second_name" name="personalinfo_second_name" data-bs-title="الأسم الثاني" value="{{ beneficiary.second_name }}">
                  </div>
                  <div class="mb-3">
                    <h6 class="col form-label" for="id_personalinfo_last_name">الأسم الأخير<span style="color: red">*</span></h6>
                    <input type="text" class="form-control" id="id_personalinfo_last_name" name="personalinfo_last_name" data-bs-title="الأسم الأخير" value="{{ beneficiary.last_name }}">
                  </div>
                </div>
      
                <div class="row row-cols-lg-2 row-cols-xl-4">
                  <div class="mb-3">
                    <h6 class="col form-label" for="id_personalinfo_gender">الجنس<span style="color: red">*</span></h6>
                    <select
                      name="personalinfo_gender"
                      class="form-select"
                      id="id_personalinfo_gender"
                      data-bs-title="الجنس"
                    >
                      <option value>---------</option>
                      <option value="ذكر">ذكر</option>
                      <option value="انثى">انثى</option>
                    </select>
                  </div>
                  <div class="mb-3">
                    <h6 class="col form-label" for="id_personalinfo_date_of_birth">تاريخ الميلاد<span style="color: red">*</span></h6>
                    <input type="date" class="form-control" id="id_personalinfo_date_of_birth" name="personalinfo_date_of_birth" data-bs-title="تاريخ الميلاد">
                  </div>
                  <div class="mb-3">
                    <h6 class="col form-label" for="id_personalinfo_phone_number">رقم الجوال<span style="color: red">*</span></h6>
                    <input type="text" class="form-control convert-to-english" data-bs-title="رقم الجوال" id="id_personalinfo_phone_number" name="personalinfo_phone_number" value="{{ beneficiary.phone_number }}">
                  </div>
                  <div class="mb-3">
                    <h6 class="col form-label" for="id_personalinfo_email">البريد الالكتروني<span style="color: red">*</span></h6>
                    <input type="email" class="form-control" id="id_personalinfo_email" name="personalinfo_email" data-bs-title="البريد الالكتروني" value="{{ beneficiary.email }}">
                  </div>
                </div>

                <hr>
      
                <div class="row row-cols-md-1 row-cols-xl-3">
                  <div class="mb-3">
                    <h6 class="col form-label" for="id_personalinfo_nationality">الجنسية<span style="color: red">*</span></h6>
                    <select
                      name="personalinfo_nationality"
                      class="form-select"
                      id="id_personalinfo_nationality"
                      data-bs-title="الجنسية"
                    >
                      <option value>إختر</option>
                      <option value="السعودية">السعودية</option>
                      <option value="أفغانستان">أفغانستان</option>
                      <option value="ألبانيا">ألبانيا</option>
                      <option value="الجزائر">الجزائر</option>
                      <option value="أندورا">أندورا</option>
                      <option value="أنغولا">أنغولا</option>
                      <option value="أنتيغوا وباربودا">أنتيغوا وباربودا</option>
                      <option value="الأرجنتين">الأرجنتين</option>
                      <option value="أرمينيا">أرمينيا</option>
                      <option value="أستراليا">أستراليا</option>
                      <option value="النمسا">النمسا</option>
                      <option value="أذربيجان">أذربيجان</option>
                      <option value="البهاما">البهاما</option>
                      <option value="البحرين">البحرين</option>
                      <option value="بنغلاديش">بنغلاديش</option>
                      <option value="باربادوس">باربادوس</option>
                      <option value="بيلاروسيا">بيلاروسيا</option>
                      <option value="بلجيكا">بلجيكا</option>
                      <option value="بليز">بليز</option>
                      <option value="بنين">بنين</option>
                      <option value="بوتان">بوتان</option>
                      <option value="بوليفيا">بوليفيا</option>
                      <option value="البوسنة والهرسك ">البوسنة والهرسك</option>
                      <option value="بوتسوانا">بوتسوانا</option>
                      <option value="البرازيل">البرازيل</option>
                      <option value="بروناي">بروناي</option>
                      <option value="بلغاريا">بلغاريا</option>
                      <option value="بوركينا فاسو ">بوركينا فاسو</option>
                      <option value="بوروندي">بوروندي</option>
                      <option value="كمبوديا">كمبوديا</option>
                      <option value="الكاميرون">الكاميرون</option>
                      <option value="كندا">كندا</option>
                      <option value="الرأس الأخضر">الرأس الأخضر</option>
                      <option value="جمهورية أفريقيا الوسطى ">
                        جمهورية أفريقيا الوسطى
                      </option>
                      <option value="تشاد">تشاد</option>
                      <option value="تشيلي">تشيلي</option>
                      <option value="الصين">الصين</option>
                      <option value="كولومبيا">كولومبيا</option>
                      <option value="جزر القمر">جزر القمر</option>
                      <option value="كوستاريكا">كوستاريكا</option>
                      <option value="ساحل العاج">ساحل العاج</option>
                      <option value="كرواتيا">كرواتيا</option>
                      <option value="كوبا">كوبا</option>
                      <option value="قبرص">قبرص</option>
                      <option value="التشيك">التشيك</option>
                      <option value="جمهورية الكونغو الديمقراطية">
                        جمهورية الكونغو الديمقراطية
                      </option>
                      <option value="الدنمارك">الدنمارك</option>
                      <option value="جيبوتي">جيبوتي</option>
                      <option value="دومينيكا">دومينيكا</option>
                      <option value="جمهورية الدومينيكان">
                        جمهورية الدومينيكان
                      </option>
                      <option value="تيمور الشرقية ">تيمور الشرقية</option>
                      <option value="الإكوادور">الإكوادور</option>
                      <option value="مصر">مصر</option>
                      <option value="السلفادور">السلفادور</option>
                      <option value="غينيا الاستوائية">غينيا الاستوائية</option>
                      <option value="إريتريا">إريتريا</option>
                      <option value="إستونيا">إستونيا</option>
                      <option value="إثيوبيا">إثيوبيا</option>
                      <option value="فيجي">فيجي</option>
                      <option value="فنلندا">فنلندا</option>
                      <option value="فرنسا">فرنسا</option>
                      <option value="الغابون">الغابون</option>
                      <option value="غامبيا">غامبيا</option>
                      <option value="جورجيا">جورجيا</option>
                      <option value="ألمانيا">ألمانيا</option>
                      <option value="غانا">غانا</option>
                      <option value="اليونان">اليونان</option>
                      <option value="جرينادا">جرينادا</option>
                      <option value="غواتيمالا">غواتيمالا</option>
                      <option value="غينيا">غينيا</option>
                      <option value="غينيا بيساو">غينيا بيساو</option>
                      <option value="غويانا">غويانا</option>
                      <option value="هايتي">هايتي</option>
                      <option value="هندوراس">هندوراس</option>
                      <option value="المجر">المجر</option>
                      <option value="آيسلندا">آيسلندا</option>
                      <option value="الهند">الهند</option>
                      <option value="إندونيسيا">إندونيسيا</option>
                      <option value="إيران">إيران</option>
                      <option value="العراق">العراق</option>
                      <option value="جمهورية أيرلندا ">جمهورية أيرلندا</option>
                      <option value="فلسطين">فلسطين</option>
                      <option value="إيطاليا">إيطاليا</option>
                      <option value="جامايكا">جامايكا</option>
                      <option value="اليابان">اليابان</option>
                      <option value="الأردن">الأردن</option>
                      <option value="كازاخستان">كازاخستان</option>
                      <option value="كينيا">كينيا</option>
                      <option value="كيريباتي">كيريباتي</option>
                      <option value="الكويت">الكويت</option>
                      <option value="قرغيزستان">قرغيزستان</option>
                      <option value="لاوس">لاوس</option>
                      <option value="لاوس">لاوس</option>
                      <option value="لاتفيا">لاتفيا</option>
                      <option value="لبنان">لبنان</option>
                      <option value="ليسوتو">ليسوتو</option>
                      <option value="ليبيريا">ليبيريا</option>
                      <option value="ليبيا">ليبيا</option>
                      <option value="ليختنشتاين">ليختنشتاين</option>
                      <option value="ليتوانيا">ليتوانيا</option>
                      <option value="لوكسمبورغ">لوكسمبورغ</option>
                      <option value="مدغشقر">مدغشقر</option>
                      <option value="مالاوي">مالاوي</option>
                      <option value="ماليزيا">ماليزيا</option>
                      <option value="جزر المالديف">جزر المالديف</option>
                      <option value="مالي">مالي</option>
                      <option value="مالطا">مالطا</option>
                      <option value="جزر مارشال">جزر مارشال</option>
                      <option value="موريتانيا">موريتانيا</option>
                      <option value="موريشيوس">موريشيوس</option>
                      <option value="المكسيك">المكسيك</option>
                      <option value="مايكرونيزيا">مايكرونيزيا</option>
                      <option value="مولدوفا">مولدوفا</option>
                      <option value="موناكو">موناكو</option>
                      <option value="منغوليا">منغوليا</option>
                      <option value="الجبل الأسود">الجبل الأسود</option>
                      <option value="المغرب">المغرب</option>
                      <option value="موزمبيق">موزمبيق</option>
                      <option value="بورما">بورما</option>
                      <option value="ناميبيا">ناميبيا</option>
                      <option value="ناورو">ناورو</option>
                      <option value="نيبال">نيبال</option>
                      <option value="هولندا">هولندا</option>
                      <option value="نيوزيلندا">نيوزيلندا</option>
                      <option value="نيكاراجوا">نيكاراجوا</option>
                      <option value="النيجر">النيجر</option>
                      <option value="نيجيريا">نيجيريا</option>
                      <option value="كوريا الشمالية ">كوريا الشمالية</option>
                      <option value="النرويج">النرويج</option>
                      <option value="سلطنة عمان">سلطنة عمان</option>
                      <option value="باكستان">باكستان</option>
                      <option value="بالاو">بالاو</option>
                      <option value="بنما">بنما</option>
                      <option value="بابوا غينيا الجديدة">
                        بابوا غينيا الجديدة
                      </option>
                      <option value="باراغواي">باراغواي</option>
                      <option value="بيرو">بيرو</option>
                      <option value="الفلبين">الفلبين</option>
                      <option value="بولندا">بولندا</option>
                      <option value="البرتغال">البرتغال</option>
                      <option value="قطر">قطر</option>
                      <option value="جمهورية الكونغو">جمهورية الكونغو</option>
                      <option value="جمهورية مقدونيا">جمهورية مقدونيا</option>
                      <option value="رومانيا">رومانيا</option>
                      <option value="روسيا">روسيا</option>
                      <option value="رواندا">رواندا</option>
                      <option value="سانت كيتس ونيفيس">سانت كيتس ونيفيس</option>
                      <option value="سانت لوسيا">سانت لوسيا</option>
                      <option value="سانت فنسينت والجرينادينز">
                        سانت فنسينت والجرينادينز
                      </option>
                      <option value="ساموا">ساموا</option>
                      <option value="سان مارينو">سان مارينو</option>
                      <option value="ساو تومي وبرينسيب">
                        ساو تومي وبرينسيب
                      </option>
                      <option value="السنغال">السنغال</option>
                      <option value="صربيا">صربيا</option>
                      <option value="سيشيل">سيشيل</option>
                      <option value="سيراليون">سيراليون</option>
                      <option value="سنغافورة">سنغافورة</option>
                      <option value="سلوفاكيا">سلوفاكيا</option>
                      <option value="سلوفينيا">سلوفينيا</option>
                      <option value="جزر سليمان">جزر سليمان</option>
                      <option value="الصومال">الصومال</option>
                      <option value="جنوب أفريقيا">جنوب أفريقيا</option>
                      <option value="كوريا الجنوبية">كوريا الجنوبية</option>
                      <option value="جنوب السودان">جنوب السودان</option>
                      <option value="إسبانيا">إسبانيا</option>
                      <option value="سريلانكا">سريلانكا</option>
                      <option value="السودان">السودان</option>
                      <option value="سورينام">سورينام</option>
                      <option value="سوازيلاند">سوازيلاند</option>
                      <option value="السويد">السويد</option>
                      <option value="سويسرا">سويسرا</option>
                      <option value="سوريا">سوريا</option>
                      <option value="طاجيكستان">طاجيكستان</option>
                      <option value="تنزانيا">تنزانيا</option>
                      <option value="تايلاند">تايلاند</option>
                      <option value="توغو">توغو</option>
                      <option value="تونجا">تونجا</option>
                      <option value="ترينيداد وتوباغو">ترينيداد وتوباغو</option>
                      <option value="تونس">تونس</option>
                      <option value="تركيا">تركيا</option>
                      <option value="تركمانستان">تركمانستان</option>
                      <option value="توفالو">توفالو</option>
                      <option value="أوغندا">أوغندا</option>
                      <option value="أوكرانيا">أوكرانيا</option>
                      <option value="الإمارات العربية المتحدة">
                        الإمارات العربية المتحدة
                      </option>
                      <option value="المملكة المتحدة">المملكة المتحدة</option>
                      <option value="الولايات المتحدة">الولايات المتحدة</option>
                      <option value="أوروغواي">أوروغواي</option>
                      <option value="أوزبكستان">أوزبكستان</option>
                      <option value="فانواتو">فانواتو</option>
                      <option value="فنزويلا">فنزويلا</option>
                      <option value="فيتنام">فيتنام</option>
                      <option value="اليمن">اليمن</option>
                      <option value="زامبيا">زامبيا</option>
                      <option value="زيمبابوي">زيمبابوي</option>
                    </select>
                  </div>
                  <div class="mb-3">
                    <h6 class="col form-label" for="id_personalinfo_national_id">رقم الهوية/الإقامة<span style="color: red">*</span></h6>
                    <input type="text" class="form-control convert-to-english" id="id_personalinfo_national_id" name="personalinfo_national_id" data-bs-title="رقم الهوية / الإقامة" value="{{ beneficiary.national_id }}">
                  </div>
                  <div class="mb-3">
                    <h6 class="col form-label" for="id_personalinfo_national_id_exp_date">تاريخ انتهاء الهوية/الإقامة<span style="color: red">*</span></h6>
                    <input type="date" class="form-control" id="id_personalinfo_national_id_exp_date" name="personalinfo_national_id_exp_date"
                    data-bs-title="تاريخ انتهاء الهوية / الإقامة">
                  </div>
                </div>
      
                <div class="row row-cols-md-1 row-cols-lg-3">
                  <div class="mb-3">
                    <h6 class="col form-label" for="id_personalinfo_category">التصنيف الرئيسي<span style="color: red">*</span></h6>
                    <select
                      name="personalinfo_category"
                      class="form-select"
                      id="id_personalinfo_category"
                      data-bs-title="التصنيف الرئيسي"
                      {% comment %} onchange="categoryCheck(this);" {% endcomment %}
                    >
                      <option value>---------</option>
                      <option value="أسرة عادية">أسرة عادية</option>
                      <option value="أسرة أيتام">أسرة أيتام</option>
                      <option value="أسرة أرملة">أسرة أرملة</option>
                      <option value="أسرة سجناء">أسرة سجناء</option>
                      <option value="أسرة مطلقة">أسرة مطلقة</option>
                      <option value="فرد">فرد</option>
                    </select>
                  </div>
                  <div class="mb-3">
                    <h6 class="col form-label" for="id_personalinfo_marital_status">الحالة الاجتماعية<span style="color: red">*</span></h6>
                    <select
                      name="personalinfo_marital_status"
                      class="form-select"
                      id="id_personalinfo_marital_status"
                      onchange="widowerCheck(this);"
                      data-bs-title="الحالة الاجتماعية"
                    >
                      <option value>---------</option>
                      <option value="متزوج/ـة">متزوج/ـة</option>
                      <option value="أعزب/ـة">أعزب/ـة</option>
                      <option value="أرمل/ـة">أرمل/ـة</option>
                      <option value="مطلقة">مطلقة</option>
                      <option value="مهجورة">مهجورة</option>
                    </select>
                  </div>
      
                  <div class="mb-3">
                    <h6 class="col form-label" for="id_personalinfo_educational_level">المستوى التعليمي<span style="color: red">*</span></h6>
                    <select
                      name="personalinfo_educational_level"
                      class="form-select"
                      id="id_personalinfo_educational_level"
                      data-bs-title="المستوى التعليمي"
                    >
                      <option value>---------</option>
                      <option value="أول ابتدائي">أول ابتدائي</option>
                      <option value="ثاني ابتدائي">ثاني ابتدائي</option>
                      <option value="ثالث ابتدائي">ثالث ابتدائي</option>
                      <option value="رابع ابتدائي">رابع ابتدائي</option>
                      <option value="خامس ابتدائي">خامس ابتدائي</option>
                      <option value="سادس ابتدائي">سادس ابتدائي</option>
                      <option value="أول متوسط">أول متوسط</option>
                      <option value="ثاني متوسط">ثاني متوسط</option>
                      <option value="ثالث متوسط">ثالث متوسط</option>
                      <option value="أول ثانوي">أول ثانوي</option>
                      <option value="ثاني ثانوي">ثاني ثانوي</option>
                      <option value="ثالث ثانوي">ثالث ثانوي</option>
                      <option value="جامعي">جامعي</option>
                      <option value="لا يدرس">لا يدرس</option>
                    </select>
                  </div>
                </div>

                <hr>

                <div class="row row-cols-lg-2" id="id_personalinfo_widower_group_info"
                style="display: none !important">
                  <div class="mb-3">
                    <h6 class="col form-label" for="id_personalinfo_death_date_father_husband">تاريخ وفاة الأب/الزوج</h6>
                    <input type="date" class="form-control" id="id_personalinfo_death_date_father_husband" name="personalinfo_death_date_father_husband"
                    data-bs-title="تاريخ وفاة الأب/الزوج">
                  </div>
                  <div class="mb-3">
                    <h6 class="col form-label" for="id_personalinfo_washing_place">المغسلة التي تم التجهيز فيها</h6>
                    <select
                      name="personalinfo_washing_place"
                      class="form-select"
                      id="id_personalinfo_washing_place"
                      data-bs-title="المغسلة التي تم التجهيز فيها"
                    >
                      <option value>---------</option>
                      <option value="إكرام فلسطين">إكرام فلسطين</option>
                      <option value="الثنيان">الثنيان</option>
                      <option value="العمودي">العمودي</option>
                      <option value="ابن القيم">ابن القيم</option>
                      <option value="الأمير منصور">الأمير منصور</option>
                      <option value="الملك فهد">الملك فهد</option>
                      <option value="الملك عبدالعزيز">الملك عبدالعزيز</option>
                      <option value="اللامي">اللامي</option>
                      <option value="طيبة">طيبة</option>
                      <option value="القريقري">القريقري</option>
                      <option value="شرق جدة">شرق جدة</option>
                      <option value="أخرى">أخرى</option>
                    </select>
                  </div>
                </div>

                <hr id="widower_hr" style="display: none"/>
      
                <div class="row row-cols-lg-2 row-cols-xl-4">
                  <div class="mb-3">
                    <h6 class="col form-label" for="id_personalinfo_health_status">الحالة الصحية<span style="color: red">*</span></h6>
                    <select
                      name="personalinfo_health_status"
                      class="form-select"
                      id="id_personalinfo_health_status"
                      onchange="personalInfoHealthCheck(this);"
                      data-bs-title="الحالة الصحية"
                    >
                      <option value>---------</option>
                      <option value="جيدة">جيدة</option>
                      <option value="غير جيدة">غير جيدة</option>
                    </select>
                  </div>
                  <div class="mb-3" id="id_personalinfo_disease_type_group_info"
                  style="display: none">
                    <h6 class="col form-label" for="id_personalinfo_disease_type">نوع المرض</h6>
                    <input type="text" class="form-control" id="id_personalinfo_disease_type" name="personalinfo_disease_type" data-bs-title="نوع المرض" value="{{ beneficiary.disease_type }}">
                  </div>
                  <div class="mb-3">
                    <h6 class="col form-label" for="id_personalinfo_work_status">هل يعمل؟<span style="color: red">*</span></h6>
                    <select
                      name="personalinfo_work_status"
                      class="form-select"
                      id="id_personalinfo_work_status"
                      onchange="workCheck(this);"
                      data-bs-title="هل يعمل؟"
                    >
                      <option value=>---------</option>
                      <option value="نعم">نعم</option>
                      <option value="لا">لا</option>
                    </select>
                  </div>
                  <div class="mb-3" id="id_personalinfo_employer_group_info"
                  style="display: none">
                    <h6 class="col form-label" for="id_personalinfo_employer">جهة العمل</h6>
                    <input type="text" class="form-control" id="id_personalinfo_employer" name="personalinfo_employer" data-bs-title="جهة العمل" value="{{ beneficiary.employer }}">
                  </div>
                </div>
                
                <div class="row row-cols-lg-2">
                  <div class="mb-3">
                    <h6 class="col form-label" for="id_personalinfo_bank_iban">رقم الإيبان<span style="color: red">*</span></h6>
                    <input type="text" class="form-control convert-to-english" id="id_personalinfo_bank_iban" name="personalinfo_bank_iban" data-bs-title="رقم الإيبان" value="{{ beneficiary.bank_iban }}">
                  </div>
                  <div class="mb-3">
                    <h6 class="col form-label" for="id_personalinfo_bank_type">أسم البنك<span style="color: red">*</span></h6>
                    <select
                      name="personalinfo_bank_type"
                      class="form-select"
                      id="id_personalinfo_bank_type"
                      data-bs-title="أسم البنك"
                    >
                      <option value>---------</option>
                      <option value="الأهلي السعودي">الأهلي السعودي</option>
                      <option value="الراجحي">الراجحي</option>
                      <option value="الجزيرة">الجزيرة</option>
                      <option value="الإنماء">الإنماء</option>
                      <option value="البلاد">البلاد</option>
                      <option value="الرياض">الرياض</option>
                      <option value="ساب">ساب</option>
                      <option value="السعودي الفرنسي">السعودي الفرنسي</option>
                      <option value="العربي">العربي</option>
                      <option value="مسقط">مسقط</option>
                      <option value="الإمارات دبي الوطني">الإمارات دبي الوطني</option>
                      <option value="الخليج الدولي">الخليج الدولي</option>
                      <option value="البحرين الوطني">البحرين الوطني</option>
                      <option value="الكويت الوطني">الكويت الوطني</option>
                      <option value="باكستان الوطني">باكستان الوطني</option>
                      <option value="الأول">الأول</option>
                      <option value="السعودي للاستثمار">السعودي للاستثمار</option>
                      <option value="زراعات">زراعات</option>
                      <option value="أخرى">أخرى</option>
                    </select>
                  </div>
                </div>

                <hr>

                <div class="row mt-3" id="family_issues_needs_container">
                  <div class="col-md-6 mb-4 form-group">
                    <label class="form-label"
                      >المشكلات التي تعاني منها الأسرة<span style="color: red">*</span> <span class="text-muted" style="font-size: 0.9rem">
                        (إختيار متعدد)</span
                      ></label
                    >
                      <div
                        name="familyinfo_family_issues"
                        class="d-grid gap-2"
                        style="grid-template-columns: 1fr 1fr;"
                        id="id_familyinfo_family_issues"
                      >
                        <input type="checkbox" class="btn-check" id="id_familyinfo_issues_economical" autocomplete="off" name="familyinfo_issues_economical" value="اقتصادية">
                        <label class="btn btn-outline-primary" for="id_familyinfo_issues_economical">اقتصادية</label>
    
                        <input type="checkbox" class="btn-check" id="id_familyinfo_issues_educational" autocomplete="off" name="familyinfo_issues_educational" value="تعليمية">
                        <label class="btn btn-outline-primary" for="id_familyinfo_issues_educational">تعليمية</label>
    
                        <input type="checkbox" class="btn-check" id="id_familyinfo_issues_employment" autocomplete="off" name="familyinfo_issues_employment" value="توظيف">
                        <label class="btn btn-outline-primary" for="id_familyinfo_issues_employment">توظيف</label>
    
                        <input type="checkbox" class="btn-check" id="id_familyinfo_issues_sponsorship" autocomplete="off" name="familyinfo_issues_sponsorship" value="كفالة">
                        <label class="btn btn-outline-primary" for="id_familyinfo_issues_sponsorship">كفالة</label>
    
                        <input type="checkbox" class="btn-check" id="id_familyinfo_issues_healthy" autocomplete="off" name="familyinfo_issues_healthy" value="صحية">
                        <label class="btn btn-outline-primary" for="id_familyinfo_issues_healthy">صحية</label>
                      </div>
                  </div>
                  <div class="col-md-6 mb-4 form-group">
                    <label class="form-label"
                      >احتياجات الأسرة<span style="color: red">*</span> <span class="text-muted" style="font-size: 0.9rem">
                        (إختيار متعدد)</span
                      ></label
                    >
                    <div
                      name="familyinfo_needs_type"
                      class="d-grid gap-2"
                      style="grid-template-columns: 1fr 1fr;"
                      id="id_familyinfo_needs_type"
                    >
                      <input type="checkbox" class="btn-check" id="id_familyinfo_needs_type_food_baskets" autocomplete="off" name="familyinfo_needs_type_food_baskets" value="سلال غذائية">
                      <label class="btn btn-outline-primary" for="id_familyinfo_needs_type_food_baskets">سلال غذائية</label>
    
                      <input type="checkbox" class="btn-check" id="id_familyinfo_needs_type_clothing" autocomplete="off" name="familyinfo_needs_type_clothing" value="كسوة">
                      <label class="btn btn-outline-primary" for="id_familyinfo_needs_type_clothing">كسوة</label>
    
                      <input type="checkbox" class="btn-check" id="id_familyinfo_needs_type_school_bags"  autocomplete="off" name="familyinfo_needs_type_school_bags" value="حقائب مدرسية">
                      <label class="btn btn-outline-primary" for="id_familyinfo_needs_type_school_bags">حقائب مدرسية</label>
    
                      <input type="checkbox" class="btn-check" id="id_familyinfo_needs_type_water_filters"  autocomplete="off" name="familyinfo_needs_type_water_filters" value="فلاتر مياه">
                      <label class="btn btn-outline-primary" for="id_familyinfo_needs_type_water_filters">فلاتر مياه</label>
    
                      <input type="checkbox" class="btn-check" id="id_familyinfo_needs_type_rent_payment"  autocomplete="off" name="familyinfo_needs_type_rent_payment" value="سداد إيجار">
                      <label class="btn btn-outline-primary" for="id_familyinfo_needs_type_rent_payment">سداد إيجار</label>
    
                      <input type="checkbox" class="btn-check" id="id_familyinfo_needs_type_electricity_payment"  autocomplete="off" name="familyinfo_needs_type_electricity_payment" value="سداد كهرباء">
                      <label class="btn btn-outline-primary" for="id_familyinfo_needs_type_electricity_payment">سداد كهرباء</label>
    
                      <input type="checkbox" class="btn-check" id="id_familyinfo_needs_type_dept_payment" autocomplete="off" name="familyinfo_needs_type_dept_payment" value="سداد دين">
                      <label class="btn btn-outline-primary" for="id_familyinfo_needs_type_dept_payment">سداد دين</label>
    
                      <input type="checkbox" class="btn-check" id="id_familyinfo_needs_type_training"  autocomplete="off" name="familyinfo_needs_type_training" value="تدريب">
                      <label class="btn btn-outline-primary" for="id_familyinfo_needs_type_training">تدريب</label>
    
                      <input type="checkbox" class="btn-check" id="id_familyinfo_needs_type_electronic_devices" autocomplete="off" name="familyinfo_needs_type_electronic_devices" value="أجهزة كهربائية">
                      <label class="btn btn-outline-primary" for="id_familyinfo_needs_type_electronic_devices">أجهزة كهربائية</label>
    
                      <input type="checkbox" class="btn-check" id="id_familyinfo_needs_type_furniture" autocomplete="off" name="familyinfo_needs_type_furniture" value="أثاث">
                      <label class="btn btn-outline-primary" for="id_familyinfo_needs_type_furniture">أثاث</label>
    
                      <input type="checkbox" class="btn-check" id="id_familyinfo_needs_type_home_renovation" autocomplete="off" name="familyinfo_needs_type_home_renovation" value="ترميم">
                      <label class="btn btn-outline-primary" for="id_familyinfo_needs_type_home_renovation">ترميم</label>
                    </div>
                  </div>
                </div>
              </div> <!-- end line personal info --> 
      
            </div>
            <div class="tab-pane" id="fill-tabpanel-1" role="tabpanel" aria-labelledby="fill-tab-1">

              <div class="housing_info">
                <h3 class="mt-4 mb-4">معلومات السكن</h3>
                <div class="row row-cols-lg-2 row-cols-xl-4">
                  <div class="mb-3 form-group">
                    <label for="id_houseinfo_building_number" class="form-label"
                      >رقم المبنى<span style="color: red">*</span></label>
                    <input
                      type="number"
                      name="houseinfo_building_number"
                      min="0"
                      max="9999999"
                      class="form-control text-start"
                      id="id_houseinfo_building_number"
                      value="{{ beneficiary_house.building_number }}"
                      data-bs-title="رقم المبنى"
                    />
                  </div>
                  <div class="mb-3 form-group">
                    <label for="id_houseinfo_street_name" class="form-label"
                      >اسم الشارع<span style="color: red">*</span></label>
                    <input
                      type="text"
                      name="houseinfo_street_name"
                      maxlength="50"
                      class="form-control"
                      id="id_houseinfo_street_name"
                      value="{{ beneficiary_house.street_name }}"
                      data-bs-title="اسم الشارع"
                    />
                  </div>
                  <div class="mb-3 form-group">
                    <label for="id_houseinfo_neighborhood" class="form-label"
                      >الحي<span style="color: red">*</span></label>
                    <input
                      type="text"
                      name="houseinfo_neighborhood"
                      maxlength="50"
                      class="form-control"
                      id="id_houseinfo_neighborhood"
                      value="{{ beneficiary_house.neighborhood }}"
                      data-bs-title="الحي"
                    />
                  </div>
                  <div class="mb-3 form-group">
                    <label for="id_houseinfo_city" class="form-label"
                      >المدينة<span style="color: red">*</span></label>
                    <input
                      type="text"
                      name="houseinfo_city"
                      maxlength="50"
                      class="form-control"
                      id="id_houseinfo_city"
                      value="{{ beneficiary_house.city }}"
                      data-bs-title="المدينة"
                    />
                  </div>
                </div>
      
                <div class="row row-cols-lg-3">
                  <div class="mb-3 form-group">
                    <label for="id_houseinfo_postal_code" class="form-label"
                      >الرمز البريدي<span style="color: red">*</span></label>
                    <input
                      type="number"
                      name="houseinfo_postal_code"
                      min="0"
                      max="9999999"
                      class="form-control"
                      id="id_houseinfo_postal_code"
                      value="{{ beneficiary_house.postal_code }}"
                      data-bs-title="الرمز البريدي"
                    />
                  </div>
                  <div class="mb-3 form-group">
                    <label for="id_houseinfo_additional_number" class="form-label"
                      >الرقم الإضافي<span style="color: red">*</span></label>
                    <input
                      type="number"
                      name="houseinfo_additional_number"
                      min="0"
                      max="9999999"
                      class="form-control text-start"
                      id="id_houseinfo_additional_number"
                      value="{{ beneficiary_house.additional_number }}"
                      data-bs-title="الرقم الإضافي"
                    />
                  </div>
                  <div class="mb-3 form-group">
                    <label for="id_houseinfo_unit" class="form-label">الوحدة<span style="color: red">*</span></label>
                    <input
                      type="text"
                      name="houseinfo_unit"
                      maxlength="50"
                      class="form-control convert-to-english"
                      id="id_houseinfo_unit"
                      value="{{ beneficiary_house.unit }}"
                      data-bs-title="الوحدة"
                    />
                  </div>
                </div>
      
                <div class="row row-cols-xl-3">
                  <div class="mb-3 form-group">
                    <label for="id_houseinfo_location_url" class="form-label"
                      >رابط موقع المنزل<span style="color: red">*</span> (google maps)</label>
                    <input
                      type="url"
                      name="houseinfo_location_url"
                      maxlength="250"
                      class="form-control"
                      id="id_houseinfo_location_url"
                      value="{{ beneficiary_house.location_url }}"
                      data-bs-title="رابط موقع المنزل (google maps)"
                    />
                  </div>
                  <div class="mb-3 form-group">
                    <label for="id_houseinfo_housing_type" class="form-label"
                      >نوع السكن<span style="color: red">*</span></label>
                    <select
                      name="houseinfo_housing_type"
                      class="form-select"
                      id="id_houseinfo_housing_type"
                      data-bs-title="نوع السكن"
                    >
                      <option value>---------</option>
                      <option value="شعبي">شعبي</option>
                      <option value="شقة">شقة</option>
                      <option value="فيلا">فيلا</option>
                      <option value="ملحق">ملحق</option>
                    </select>
                  </div>
                  <div class="mb-3 form-group">
                    <label for="id_houseinfo_housing_ownership" class="form-label"
                      >ملكية السكن<span style="color: red">*</span></label>
                    <select
                      name="houseinfo_housing_ownership"
                      class="form-select"
                      id="id_houseinfo_housing_ownership"
                      data-bs-title="ملكية السكن"
                    >
                      <option value>---------</option>
                      <option value="ملك">ملك</option>
                      <option value="وقف">وقف</option>
                      <option value="إيجار">إيجار</option>
                    </select>
                  </div>
                </div>

              </div>
            </div>
            <div class="tab-pane" id="fill-tabpanel-2" role="tabpanel" aria-labelledby="fill-tab-2">

              <div class="income_expenses_info">
                <h3 class="mb-4 mt-4">معلومات مصادر الدخل والمصروفات</h3>
                <h4 class="mt-2 mb-3">مصادر دخل رب الأسرة (شهريًا)</h4>
                <div
                  class="alert alert-warning mt-3"
                  role="alert"
                  id="checkboxError"
                >
                  الرجاء إدخال مصادر الدخل ادناه, وفي حال عدم وجود الدخل المسمى,
                  يرجى ادخال قيمة صفر (0)
                </div>
                <div class="row row-cols-lg-2 row-cols-xl-4 mt-4">
                  <div class="mb-3 form-group">
                    <label for="id_incomeinfo_salary" class="form-label"
                      >الراتب<span style="color: red">*</span></label>
                    <div class="input-group mb-3">
                      <input
                        type="number"
                        name="incomeinfo_salary"
                        min="0.00"
                        max="99999999.00"
                        class="form-control"
                        id="id_incomeinfo_salary"
                        value="{{ beneficiary_income_expense.salary_in }}"
                        data-bs-title="الراتب"
                      />
                      <span class="input-group-text" id="basic-addon1">ر.س.</span>
                    </div>
                  </div>
                  <div class="mb-3 form-group">
                    <label for="id_incomeinfo_social_insurance" class="form-label"
                      >التأمينات الاجتماعية<span style="color: red">*</span></label>
                    <div class="input-group mb-3">
                      <input
                        type="number"
                        name="incomeinfo_social_insurance"
                        min="0.00"
                        max="99999999.00"
                        class="form-control"
                        id="id_incomeinfo_social_insurance"
                        value="{{ beneficiary_income_expense.social_insurance_in }}"
                        data-bs-title="التأمينات الاجتماعية"
                      />
                      <span class="input-group-text" id="basic-addon1">ر.س.</span>
                    </div>
                  </div>
                  <div class="mb-3 form-group">
                    <label for="id_incomeinfo_charity" class="form-label"
                      >جمعيات خيرية<span style="color: red">*</span></label>
                    <div class="input-group mb-3">
                      <input
                        type="number"
                        name="incomeinfo_charity"
                        min="0.00"
                        max="99999999.00"
                        class="form-control"
                        id="id_incomeinfo_charity"
                        value="{{ beneficiary_income_expense.charity_in }}"
                        data-bs-title="جمعيات خيرية"
                      />
                      <span class="input-group-text" id="basic-addon1">ر.س.</span>
                    </div>
                  </div>
                  <div class="mb-3 form-group">
                    <label for="id_incomeinfo_social_warranty" class="form-label"
                      >الضمان الاجتماعي<span style="color: red">*</span></label>
                    <div class="input-group mb-3">
                      <input
                        type="number"
                        name="incomeinfo_social_warranty"
                        min="0.00"
                        max="99999999.00"
                        class="form-control"
                        id="id_incomeinfo_social_warranty"
                        value="{{ beneficiary_income_expense.social_warranty_in }}"
                        data-bs-title="الضمان الاجتماعي"
                      />
                      <span class="input-group-text" id="basic-addon1">ر.س.</span>
                    </div>
                  </div>
                </div>
      
                <div class="row row-cols-lg-2 row-cols-xl-4">
                  <div class="mb-3 form-group">
                    <label for="id_incomeinfo_pension_agency" class="form-label"
                      >مصلحة التقاعد<span style="color: red">*</span></label>
                    <div class="input-group mb-3">
                      <input
                        type="number"
                        name="incomeinfo_pension_agency"
                        min="0.00"
                        max="99999999.00"
                        class="form-control"
                        id="id_incomeinfo_pension_agency"
                        value="{{ beneficiary_income_expense.pension_agency_in }}"
                        data-bs-title="مصلحة التقاعد"
                      />
                      <span class="input-group-text" id="basic-addon1">ر.س.</span>
                    </div>
                  </div>
                  <div class="mb-3 form-group">
                    <label for="id_incomeinfo_citizen_account" class="form-label"
                      >حساب المواطن<span style="color: red">*</span></label>
                    <div class="input-group mb-3">
                      <input
                        type="number"
                        name="incomeinfo_citizen_account"
                        min="0.00"
                        max="99999999.00"
                        class="form-control"
                        id="id_incomeinfo_citizen_account"
                        value="{{ beneficiary_income_expense.citizen_account_in }}"
                        data-bs-title="حساب المواطن"
                      />
                      <span class="input-group-text" id="basic-addon1">ر.س.</span>
                    </div>
                  </div>
                  <div class="mb-3 form-group">
                    <label for="id_incomeinfo_benefactor" class="form-label"
                      >فاعل خير<span style="color: red">*</span></label>
                    <div class="input-group mb-3">
                      <input
                        type="number"
                        name="incomeinfo_benefactor"
                        min="0.00"
                        max="99999999.00"
                        class="form-control"
                        id="id_incomeinfo_benefactor"
                        value="{{ beneficiary_income_expense.benefactor_in }}"
                        data-bs-title="فاعل خير"
                      />
                      <span class="input-group-text" id="basic-addon1">ر.س.</span>
                    </div>
                  </div>
                  <div class="mb-3 form-group">
                    <label for="id_incomeinfo_other" class="form-label">أخرى<span style="color: red">*</span></label>
                    <div class="input-group mb-3">
                      <input
                        type="number"
                        name="incomeinfo_other"
                        min="0.00"
                        max="99999999.00"
                        class="form-control"
                        id="id_incomeinfo_other"
                        value="{{ beneficiary_income_expense.other_in }}"
                        data-bs-title="أخرى (دخل)"
                      />
                      <span class="input-group-text" id="basic-addon1">ر.س.</span>
                    </div>
                  </div>
                </div>
      
                <div class="row">
                  <div class="mb-3 form-group">
                    <label for="id_incomeinfo_total" class="form-label"
                      >إجمالي الدخل</label>
                    <div class="input-group mb-3">
                      <input
                        type="number"
                        name="incomeinfo_total"
                        min="0.00"
                        max="99999999.00"
                        step="0.01"
                        class="form-control"
                        id="id_incomeinfo_total"
                        value="{{ beneficiary_income_expense.total_in }}"
                        disabled readonly
                      />
                      <span class="input-group-text" id="basic-addon1">ر.س.</span>
                    </div>
                  </div>
                </div>
      
                <h4 class="mt-4 mb-3">مصروفات الأسرة (شهريًا)</h4>
                <div
                  class="alert alert-warning mt-3"
                  role="alert"
                  id="checkboxError"
                >
                  الرجاء ادخال مصروفات الأسرة ادناه, وفي حال عدم وجود الدخل المسمى, يرجى ادخال قيمة صفر (0)
                </div>
                <div class="row row-cols-lg-2 row-cols-xl-4 mt-4">
                  <div class="mb-3 form-group">
                    <label for="id_expensesinfo_housing_rent" class="form-label"
                      >إيجار السكن<span style="color: red">*</span></label>
                    <div class="input-group mb-3">
                      <input
                        type="number"
                        name="expensesinfo_housing_rent"
                        min="0.00"
                        max="99999999.00"
                        class="form-control"
                        id="id_expensesinfo_housing_rent"
                        value="{{ beneficiary_income_expense.housing_rent_ex }}"
                        data-bs-title="إيجار السكن"
                      />
                      <span class="input-group-text" id="basic-addon1">ر.س.</span>
                    </div>
                  </div>
                  <div class="mb-3 form-group">
                    <label
                      for="id_expensesinfo_electricity_bills"
                      class="form-label"
                      >فواتير كهرباء<span style="color: red">*</span></label>
                    <div class="input-group mb-3">
                      <input
                        type="number"
                        name="expensesinfo_electricity_bills"
                        min="0.00"
                        max="99999999.00"
                        class="form-control"
                        id="id_expensesinfo_electricity_bills"
                        value="{{ beneficiary_income_expense.electricity_bills_ex }}"
                        data-bs-title="فواتير كهرباء"
                      />
                      <span class="input-group-text" id="basic-addon1">ر.س.</span>
                    </div>
                  </div>
                  <div class="mb-3 form-group">
                    <label for="id_expensesinfo_water_bills" class="form-label"
                      >فواتير ماء<span style="color: red">*</span></label>
                    <div class="input-group mb-3">
                      <input
                        type="number"
                        name="expensesinfo_water_bills"
                        min="0.00"
                        max="99999999.00"
                        class="form-control"
                        id="id_expensesinfo_water_bills"
                        value="{{ beneficiary_income_expense.water_bills_ex }}"
                        data-bs-title="فواتير الماء"
                      />
                      <span class="input-group-text" id="basic-addon1">ر.س.</span>
                    </div>
                  </div>
                  <div class="mb-3 form-group">
                    <label for="id_expensesinfo_transportation" class="form-label"
                      >مواصلات<span style="color: red">*</span></label>
                    <div class="input-group mb-3">
                      <input
                        type="number"
                        name="expensesinfo_transportation"
                        min="0.00"
                        max="99999999.00"
                        class="form-control"
                        id="id_expensesinfo_transportation"
                        value="{{ beneficiary_income_expense.transportation_ex }}"
                        data-bs-title="مواصلات"
                      />
                      <span class="input-group-text" id="basic-addon1">ر.س.</span>
                    </div>
                  </div>
                </div>
      
                <div class="row row-cols-lg-2 row-cols-xl-4">
                  <div class="mb-3 form-group">
                    <label for="id_expensesinfo_health_supplies" class="form-label"
                      >مستلزمات صحية<span style="color: red">*</span></label>
                    <div class="input-group mb-3">
                      <input
                        type="number"
                        name="expensesinfo_health_supplies"
                        min="0.00"
                        max="99999999.00"
                        class="form-control"
                        id="id_expensesinfo_health_supplies"
                        value="{{ beneficiary_income_expense.health_supplies_ex }}"
                        data-bs-title="مستلزمات صحية"
                      />
                      <span class="input-group-text" id="basic-addon1">ر.س.</span>
                    </div>
                  </div>
                  <div class="mb-3 form-group">
                    <label for="id_expensesinfo_food_supplies" class="form-label"
                      >مستلزمات غذائية<span style="color: red">*</span></label>
                    <div class="input-group mb-3">
                      <input
                        type="number"
                        name="expensesinfo_food_supplies"
                        min="0.00"
                        max="99999999.00"
                        class="form-control"
                        id="id_expensesinfo_food_supplies"
                        value="{{ beneficiary_income_expense.food_supplies_ex }}"
                        data-bs-title="مستلزمات غذائية"
                      />
                      <span class="input-group-text" id="basic-addon1">ر.س.</span>
                    </div>
                  </div>
                  <div class="mb-3 form-group">
                    <label
                      for="id_expensesinfo_educational_supplies"
                      class="form-label"
                      >مستلزمات دراسية<span style="color: red">*</span></label>
                    <div class="input-group mb-3">
                      <input
                        type="number"
                        name="expensesinfo_educational_supplies"
                        min="0.00"
                        max="99999999.00"
                        class="form-control"
                        id="id_expensesinfo_educational_supplies"
                        value="{{ beneficiary_income_expense.educational_supplies_ex }}"
                        data-bs-title="مستلزمات دراسية"
                      />
                      <span class="input-group-text" id="basic-addon1">ر.س.</span>
                    </div>
                  </div>
                  <div class="mb-3 form-group">
                    <label for="id_expensesinfo_proven_debts" class="form-label"
                      >ديون مثبتة<span style="color: red">*</span></label>
                    <div class="input-group mb-3">
                      <input
                        type="number"
                        name="expensesinfo_proven_debts"
                        min="0.00"
                        max="99999999.00"
                        class="form-control"
                        id="id_expensesinfo_proven_debts"
                        value="{{ beneficiary_income_expense.proven_debts_ex }}"
                        data-bs-title="ديون مثبتة"
                      />
                      <span class="input-group-text" id="basic-addon1">ر.س.</span>
                    </div>
                  </div>
                </div>
      
                <div class="row row-cols-lg-2">
                  <div class="mb-3 form-group">
                    <label for="id_expensesinfo_other" class="form-label"
                      >أخرى<span style="color: red">*</span></label>
                    <div class="input-group mb-3">
                      <input
                        type="number"
                        name="expensesinfo_other"
                        min="0.00"
                        max="99999999.00"
                        class="form-control"
                        id="id_expensesinfo_other"
                        value="{{ beneficiary_income_expense.other_ex }}"
                        data-bs-title="أخرى (مصروفات)"
                      />
                      <span class="input-group-text" id="basic-addon1">ر.س.</span>
                    </div>
                  </div>
                  <div class="mb-3 form-group">
                    <label for="id_expensesinfo_total" class="form-label"
                      >إجمالي المصروفات</label>
                    <div class="input-group mb-3">
                      <input
                        type="number"
                        name="expensesinfo_total"
                        min="0.00"
                        max="99999999.00"
                        class="form-control"
                        id="id_expensesinfo_total"
                        value="{{ beneficiary_income_expense.total_ex }}"
                        disabled readonly
                      />
                      <span class="input-group-text" id="basic-addon1">ر.س.</span>
                    </div>
                  </div>
                </div>



              </div>
            </div>
            <div class="tab-pane" id="fill-tabpanel-3" role="tabpanel" aria-labelledby="fill-tab-3">

              <div class="dependents">
                <h3 class="mt-4 mb-4">المرافقين</h3>
                <div>
                  <div class="accordion" id="dependentsAccordion">
                    {% for dependent in dependent_list %}
                      <div class="accordion-item">
                        <h2 class="accordion-header" id="dependentHeading{{ dependent.dependent_id }}">
                          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#dependentCollapse{{ dependent.dependent_id }}" aria-expanded="false" aria-controls="dependentCollapse{{ dependent.dependent_id }}">
                            {{ dependent.dependent_first_name }} {{ dependent.dependent_second_name }} {{ dependent.dependent_last_name }}
                          </button>
                        </h2>
                        <div id="dependentCollapse{{ dependent.dependent_id }}" class="accordion-collapse collapse" aria-labelledby="dependentHeading{{ dependent.dependent_id }}">
                          <div class="accordion-body">
      
                            <div class="row row-cols-lg-2 row-cols-xl-4">
                              <div class="mb-3">
                                <h6 class="col form-label" for="id_dependent_id{{ dependent.dependent_id }}">رقم المرافق</h6>
                                <input type="text" class="form-control" id="id_dependent_id{{ dependent.dependent_id }}" name="dependent_id" value="{{ dependent.dependent_id }}" disabled readonly>
                              </div>
                              <div class="mb-3">
                                <h6 class="col form-label" for="id_dependent_first_name{{ dependent.dependent_id }}">الأسم الأول</h6>
                                <input type="text" class="form-control" id="id_dependent_first_name{{ dependent.dependent_id }}" name="dependent_first_name" value="{{ dependent.dependent_first_name }}" disabled readonly>
                              </div>
                              <div class="mb-3">
                                <h6 class="col form-label" for="id_dependent_second_name{{ dependent.dependent_id }}">الأسم الثاني</h6>
                                <input type="text" class="form-control" id="id_dependent_second_name{{ dependent.dependent_id }}" name="dependent_second_name" value="{{ dependent.dependent_second_name }}" disabled readonly>
                              </div>
                              <div class="mb-3">
                                <h6 class="col form-label" for="id_dependent_last_name{{ dependent.dependent_id }}">الأسم الأخير</h6>
                                <input type="text" class="form-control" id="id_dependent_last_name{{ dependent.dependent_id }}" name="dependent_last_name" value="{{ dependent.dependent_last_name }}" disabled readonly>
                              </div>
                            </div>
      
                            <div class="row row-cols-lg-2 row-cols-xl-4">
                              <div class="mb-3">
                                <h6 class="col form-label" for="id_dependent_gender{{ dependent.dependent_id }}">الجنس</h6>
                                <input type="text" class="form-control" id="id_dependent_gender{{ dependent.dependent_id }}" name="dependent_gender" value="{{ dependent.dependent_gender }}" disabled readonly>
                              </div>
                              <div class="mb-3">
                                <h6 class="col form-label" for="id_dependent_relationship{{ dependent.dependent_id }}">صلة القرابة</h6>
                                <input type="text" class="form-control" id="id_dependent_relationship{{ dependent.dependent_id }}" name="dependent_relationship" value="{{ dependent.dependent_relationship }}" disabled readonly>
                              </div>
                              <div class="mb-3">
                                <h6 class="col form-label" for="id_dependent_marital_status{{ dependent.dependent_id }}">الحالة الاجتماعية</h6>
                                <input type="text" class="form-control" id="id_dependent_marital_status{{ dependent.dependent_id }}" name="dependent_marital_status" value="{{ dependent.dependent_marital_status }}" disabled readonly>
                              </div>
                              <div class="mb-3">
                                <h6 class="col form-label" for="id_dependent_educational_status{{ dependent.dependent_id }}">الحالة الدراسية</h6>
                                <input type="text" class="form-control" id="id_dependent_educational_status{{ dependent.dependent_id }}" name="dependent_educational_status" value="{{ dependent.dependent_educational_status }}" disabled readonly>
                              </div>
                            </div>
      
                            <div class="row row-cols-lg-2 row-cols-xl-4">
                              <div class="mb-3">
                                <h6 class="col form-label" for="id_dependent_educational_level{{ dependent.dependent_id }}">المرحلة الدراسية</h6>
                                <input type="text" class="form-control" id="id_dependent_educational_level{{dependent.dependent_id }}" name="dependent_educational_level" value="{{dependent.dependent_educational_level }}" disabled readonly>
                              </div>
                              <div class="mb-3">
                                <h6 class="col form-label" for="id_dependent_educational_degree{{ dependent.dependent_id }}">المؤهل التعليمي</h6>
                                <input type="text" class="form-control" id="id_dependent_educational_degree{{ dependent.dependent_id }}" name="dependent_educational_degree" value="{{ dependent.dependent_educational_degree }}" disabled readonly>
                              </div>
                              <div class="mb-3">
                                <h6 class="col form-label" for="id_dependent_health_status{{ dependent.dependent_id }}">الحالة الصحية</h6>
                                <input type="text" class="form-control" id="id_dependent_health_status{{ dependent.dependent_id }}" name="dependent_health_status" value="{{ dependent.dependent_health_status }}" disabled readonly>
                              </div>
                              <div class="mb-3">
                                <h6 class="col form-label" for="id_dependent_disease_type{{ dependent.dependent_id }}">نوع المرض</h6>
                                <input type="text" class="form-control" id="id_dependent_disease_type{{ dependent.dependent_id }}" name="dependent_disease_type" value="{{ dependent.dependent_disease_type }}" disabled readonly>
                              </div>
                            </div>
      
                            <div class="row row-cols-lg-2">
                              <div class="mb-3">
                                <h6 class="col form-label" for="id_dependent_national_id{{ dependent.dependent_id }}">رقم الهوية الوطنية / الإقامة</h6>
                                <input type="text" class="form-control" id="id_dependent_national_id{{ dependent.dependent_id }}" name="dependent_national_id" value="{{ dependent.dependent_national_id }}" disabled readonly>
                              </div>
                              <div class="mb-3">
                                <h6 class="col form-label" for="id_dependent_national_id_exp_date{{ dependent.dependent_id }}">تاريخ انتهاء الهوية / الإقامة</h6>
                                <input type="text" class="form-control" id="id_dependent_national_id_exp_date{{ dependent.dependent_id }}" name="dependent_national_id_exp_date" value="{{ dependent.dependent_national_id_exp_date }}" disabled readonly>
                              </div>
                            </div>
      
                            <div class="row row-cols-lg-2 row-cols-xl-3">
                              <div class="mb-3">
                                <h6 class="col form-label" for="id_dependent_date_of_birth{{ dependent.dependent_id }}">تاريخ الميلاد</h6>
                                <input type="text" class="form-control" id="id_dependent_date_of_birth{{ dependent.dependent_id }}" name="dependent_date_of_birth" value="{{ dependent.dependent_date_of_birth }}" disabled readonly>
                              </div>
                              <div class="mb-3">
                                <h6 class="col form-label" for="id_dependent_needs_description{{ dependent.dependent_id }}">وصف الاحتياج</h6>
                                <input type="text" class="form-control" id="id_dependent_needs_description{{ dependent.dependent_id }}" name="dependent_needs_description" value="{{ dependent.dependent_needs_description }}" disabled readonly>
                              </div>
                              <div class="mb-3">
                                <h6 class="col form-label" for="id_dependent_needs_type{{ dependent.dependent_id }}">نوع الاحتياج</h6>
                                <input type="text" class="form-control" id="id_dependent_needs_type{{ dependent.dependent_id }}" name="dependent_needs_type" value="{{ dependent.dependent_needs_type }}" disabled readonly>
                              </div>
                            </div>
      
                            <!-- Display dependent income data as a table -->
                            <table class="table">
                              <thead>
                                <tr>
                                  <th>مصدر الدخل</th>
                                  <th>قيمة الدخل</th>
                                </tr>
                              </thead>
                              <tbody>
                                {% for income in dependent.dependent_income_data %}
                                  <tr key="{{ income.id }}">
                                    <td>{{ income.income_source }}</td>
                                    <td>{{ income.income_amount }}</td>
                                  </tr>
                                {% endfor %}
                              </tbody>
                            </table>
      
                          </div>
                        </div>
                      </div>
                    {% endfor %}
                  </div>
                </div>
              </div>
            </div>
            <div class="tab-pane" id="fill-tabpanel-4" role="tabpanel" aria-labelledby="fill-tab-4">

              <div class="attachment_info">
                <h3 class="mt-4 mb-4">المرفقات</h3>
                <div>
                  {% if beneficiary_attachments %}
                  <div class="table-responsive">
                    <table class="table">
                      <thead>
                        <tr>
                          <th scope="col">اسم الملف</th>
                          <th scope="col">نوع المرفق</th>
                          <th scope="col">نوع الملف</th>
                          <th scope="col">الإجراءات</th>
                        </tr>
                      </thead>
                      <tbody>
                        {% for attachment in beneficiary_attachments %}
                        <tr data-bs-toggle="tooltip" title="">
                          <td>
                            <span>
                              {{ attachment.file_name }}
                            </span>
                          </td>
                          <td>
                            <span>
                              {{ attachment.attachment_type }}
                            </span>
                          </td>
                          <td>{{ attachment.file_extension }}</td>
                          <td>
                            <div class="d-flex align-items-center actions">
                              <div class="mb-2">
                                <a href="{{ attachment.file_path }}" target="_blank" class="btn btn-primary">عرض الملف</a>
                            </div>
                            </div>
                          </td>
                        </tr>
                        {% endfor %}
                      </tbody>
                    </table>
                  </div>
                  {% else %}
                  <p>لا يوجد مرفقات </p>
                  {% endif %}
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <hr>

        <div class="mt-4">
          <button type="submit" class="btn btn-success px-5 py-2 submit-btn" disabled id="submit-btn">تأكيد طلب تحديث البيانات</button>
          <a href="{% url 'beneficiary_requests' username=user.username %}" class="btn btn-secondary px-4 py-2">العودة للصفحة السابقة</a>
        </div>
      </form>

    </div> <!-- end line card body -->
  </div> <!-- end line card -->
</div> <!-- end line container -->
<script>

  // console.log({{ beneficiary_dob }})
  // Populate the date response into the data input element
  let dob = new Date({{ beneficiary_dob }});
  let datestring1 = dob.getFullYear().toString().padStart(4, '0') + '-' + (dob.getMonth()+1).toString().padStart(2, '0') + '-' + dob.getDate().toString().padStart(2, '0');
  document.getElementById('id_personalinfo_date_of_birth').value = datestring1;

  let national_id_exp_date = new Date({{ beneficiary_national_id_exp_data }});
  let datestring2 = national_id_exp_date.getFullYear().toString().padStart(4, '0') + '-' + (national_id_exp_date.getMonth()+1).toString().padStart(2, '0') + '-' + national_id_exp_date.getDate().toString().padStart(2, '0');
  document.getElementById('id_personalinfo_national_id_exp_date').value = datestring2;

  {% if beneficiary_death_date_father_husband %}
  let death_date_father_husband = new Date({{ beneficiary_death_date_father_husband }});
  let datestring3 = death_date_father_husband.getFullYear().toString().padStart(4, '0') + '-' + (death_date_father_husband.getMonth()+1).toString().padStart(2, '0') + '-' + death_date_father_husband.getDate().toString().padStart(2, '0');
  document.getElementById('id_personalinfo_death_date_father_husband').value = datestring3;
  {% endif %}

  $(document).ready(function () {
    // List of values to match
    var family_issues_list = {{ beneficiary.family_issues | safe }};
    var family_needs_list = {{ beneficiary.family_needs | safe }};

    // Iterate through the checkboxes and set "checked" property based on the match
    $('[name^="familyinfo_issues_"]').each(function () {
      if (family_issues_list.includes($(this).val())) {
        $(this).prop('checked', true);
      }
    });

    // Iterate through the checkboxes and set "checked" property based on the match
    $('[name^="familyinfo_needs_type_"]').each(function () {
      if (family_needs_list.includes($(this).val())) {
        $(this).prop('checked', true);
      }
    });

    // Function to set the selected option for a given select element
    function setSelectedOption(selectId, selectedValue) {
      $('#' + selectId).val(selectedValue);
    }

    // Call the function with the specific select element and value
    // Personal information selectors
    setSelectedOption('id_personalinfo_nationality', "{{ beneficiary.nationality }}");
    setSelectedOption('id_personalinfo_gender', "{{ beneficiary.gender }}");
    setSelectedOption('id_personalinfo_category', "{{ beneficiary.category }}");
    setSelectedOption('id_personalinfo_marital_status', "{{ beneficiary.marital_status }}");
    setSelectedOption('id_personalinfo_educational_level', "{{ beneficiary.educational_level }}");
    setSelectedOption('id_personalinfo_health_status', "{{ beneficiary.health_status }}");
    setSelectedOption('id_personalinfo_work_status', "{{ beneficiary.work_status }}");
    setSelectedOption('id_personalinfo_washing_place', "{{ beneficiary.washing_place}}");
    setSelectedOption('id_personalinfo_bank_type', "{{ beneficiary.bank_type }}");
    
    // Housing information selectors
    setSelectedOption('id_houseinfo_housing_type', "{{ beneficiary_house.housing_type }}");
    setSelectedOption('id_houseinfo_housing_ownership', "{{ beneficiary_house.housing_ownership }}");


    const banks = [
      {
        samaCode: "55",
        bankName: "Banque Saudi Fransi",
        nameEn: "Banque Saudi Fransi",
        nameAr: "السعودي الفرنسي",
      },
      {
        samaCode: "80",
        name: "Alrajhi Bank",
        nameEn: "Alrajhi Bank",
        nameAr: "الراجحي",
      },
      {
        samaCode: "10",
        bankName: "National Commercial Bank",
        nameEn: "National Commertial Bank",
        nameAr: "الأهلي السعودي",
      },
      {
        samaCode: "45",
        bankName: "Saudi British Bank",
        nameEn: "SABB",
        nameAr: "ساب",
      },
      {
        samaCode: "20",
        bankName: "Riyadh Bank",
        nameEn: "Riyad Bank",
        nameAr: "الرياض",
      },
      {
        samaCode: "05",
        bankName: "Alinma Bank",
        nameEn: "AL Inma Bank",
        nameAr: "الإنماء",
      },
      {
        samaCode: "60",
        bankName: "Bank AlJazira",
        nameEn: "Bank Aljazerah",
        nameAr: "الجزيرة",
      },
      {
        samaCode: "15",
        bankName: "Bank AlBilad ",
        nameEn: "BANK ALBELAD",
        nameAr: "البلاد",
      },
      {
        samaCode: "30",
        bankName: "Arab National Bank",
        nameEn: "Arab National Bank",
        nameAr: "العربي",
      },

      {
        samaCode: "76",
        bankName: "Bank Muscat",
        nameEn: "Bank Muscat",
        nameAr: "مسقط",
      },
      /*
      {
        samaCode: "98",
        bankName: "BNP Paribas",
        nameEn: "BNP Paribas",
        nameAr: "بي ان بي باريبا",
      },
      {
        samaCode: "81",
        bankName: "Deutsche Bank",
        nameEn: "Deutsche Bank",
        nameAr: "دويتشه",
      },
      */
      {
        samaCode: "95",
        bankName: "Emirates Bank",
        nameEn: "Emirates Bank",
        nameAr: "الإمارات دبي الوطني",
      },
      {
        samaCode: "90",
        bankName: "Gulf International Bank",
        nameEn: "Gulf International Bank",
        nameAr: "الخليج الدولي",
      },
      {
        samaCode: "71",
        bankName: "National Bank of Bahrain",
        nameEn: "National Bank of Bahrain",
        nameAr: "البحرين الوطني",
      },
      {
        samaCode: "75",
        bankName: "National Bank of Kuwait",
        nameEn: "National Bank of Kuwait",
        nameAr: "الكويت الوطني",
      },
      {
        samaCode: "82",
        bankName: "National Bank of Pakistan",
        nameEn: "National Bank of Pakistan",
        nameAr: "باكستان الوطني",
      },
      /*
      {
        samaCode: "40",
        bankName: "Samba Financial Services",
        nameEn: "Samba Financial Services",
        nameAr: "سامبا",
      },
      {
        samaCode: "01",
        bankName: "Saudi Arabian Monetary Agency",
        nameEn: "Saudi Arabian Monetary Agency",
        nameAr: "المركزي السعودي",
      },
      */
      {
        samaCode: "50",
        bankName: "Alawwal Bank",
        nameEn: "Alawwal Bank",
        nameAr: "الأول",
      },
      {
        samaCode: "65",
        bankName: "Saudi Investment Bank",
        nameEn: "Saudi Investment Bank",
        nameAr: "السعودي للاستثمار",
      },
      /*
      {
        samaCode: "83",
        bankName: "State Bank of India",
        nameEn: "State Bank of India",
        nameAr: "الهند الوطني",
      },
      */
      {
        samaCode: "84",
        bankName: "Turkiye Cumhuriyeti Ziraat Bankasi",
        nameEn: "Turkiye Cumhuriyeti Ziraat Bankasi",
        nameAr: "زراعات",
      },
      /*
      {
        samaCode: "87",
        bankName: "Industrial & Commercial Bank of China (Riyadh Branch)",
        nameEn: "Industrial & Commercial Bank of China (Riyadh Branch)",
        nameAr: "ICBC",
      },
      {
        samaCode: "86",
        bankName: "Saudi Arabian Monetary Agency",
        nameEn: "Saudi Arabian Monetary Agency",
        nameAr: "جي بي مورجان",
      },
      */
    ];

    /*
    // Function to update the names of the uploaded files for each file input
    function updateFileNamesDisplay(fileInputId, fileNamesDivId) {
      var fileInput = document.getElementById(fileInputId);
      var fileNamesDiv = document.getElementById(fileNamesDivId);

      // Initialize with a message indicating no file is uploaded
      fileNamesDiv.innerHTML = "[لم يتم إرفاق أي ملفات]";

      fileInput.addEventListener("change", function () {
        if (this.files.length > 0) {
          fileNamesDiv.innerHTML = ""; // Clear the initial message
          for (var i = 0; i < this.files.length; i++) {
            fileNamesDiv.innerHTML += this.files[i].name + "<br>";
          }
        } else {
          // Show the no files uploaded message if no file is selected
          fileNamesDiv.innerHTML = "[لم يتم إرفاق أي ملفات]";
        }
      });
    }

    // Initialize for each file input (fileInputId, fileNamesDivId)
    updateFileNamesDisplay(
      "id_formFileBeneficiaryNationalAddress",
      "id_fileNamesNationalAddress"
    );
    updateFileNamesDisplay(
      "id_formFileLeaseContractOrTitleDeed",
      "id_fileNamesLeaseContractOrTitleDeed"
    );
    updateFileNamesDisplay(
      "id_formFileDeptInstrument",
      "id_fileNamesDeptInstrument"
    );
    updateFileNamesDisplay(
      "id_formFileNationalIDForBeneficiaryForDependents",
      "id_fileNamesNationalIDForBeneficiaryForDependents"
    );
    updateFileNamesDisplay(
      "id_formFileBeneficiaryNationalID",
      "id_fileNamesBeneficiaryNationalID"
    );
    updateFileNamesDisplay(
      "id_formFileWaterOrElectricityBills",
      "id_fileNamesWaterOrElectricityBills"
    );
    updateFileNamesDisplay(
      "id_formFileSocialWarrantyInquiry",
      "id_fileNamesSocialWarrantyInquiry"
    );
    updateFileNamesDisplay(
      "id_formFilePensionOrSocialInsuranceInquiry",
      "id_fileNamesPensionOrSocialInsuranceInquiry"
    );
    updateFileNamesDisplay(
      "id_formFileFatherOrHusbandDeathCertificate",
      "id_fileNamesFatherOrHusbandDeathCertificate"
    );
    updateFileNamesDisplay(
      "id_formFileLetterFromPrison",
      "id_fileNamesLetterFromPrison"
    );
    updateFileNamesDisplay("id_formFileDivorceDeed", "id_fileNamesDivorceDeed");
    updateFileNamesDisplay(
      "id_formFileChildrenResponsibilityDeed",
      "id_fileNamesChildrenResponsibilityDeed"
    );
    updateFileNamesDisplay("id_formFileOther", "id_fileNamesOther");
    */

    /**
    * validates IBAN
    * @return {boolean}
    */
    function validateIBAN(iban) {
      if (!iban) {
        return false;
      }

      iban = iban.trim();

      if (iban.length !== 24) {
        return false;
      }

      if (!iban.startsWith("SA")) {
        return false;
      }

      const bankCode = iban.substring(4, 6);

      return banks.some((b) => b.samaCode === bankCode);
    }

    /**
    * Returns the bank object
    * @return {Object}
    */
    function getBankByIBAN(iban) {
      if (!validateIBAN(iban)) return null;

      const bankCode = iban.substring(4, 6);
      const bank = banks.find((b) => b.samaCode === bankCode);
      return bank ? bank.nameAr : null;
    }

    $("#id_personalinfo_bank_iban").on("input", function () {
      var iban = $(this).val();
      var bankNameAr = getBankByIBAN(iban);

      if (bankNameAr) {
        $("#id_personalinfo_bank_type").val(bankNameAr).change();
      } else {
        $("#id_personalinfo_bank_type").val("").change(); // Reset to default if IBAN is invalid
      }
    });

    // Validator method for the Saudi IBAN number
    $.validator.addMethod(
      "validateIBAN",
      function (value, element) {
        return this.optional(element) || validateIBAN(value);
      },
      "الرجاء إدخال رقم إيبان صحيح"
    );

    // The Code segment to calculate the incomeinfo

    // Select all your input fields
    var incomeinfo_inputs = document.querySelectorAll(
      "input[type=number][name^=incomeinfo_]:not([name=incomeinfo_total])"
    );

    // Function to calculate the sum
    function calculateSumIncome() {
      let sum = 0;
      incomeinfo_inputs.forEach((input) => {
        const value = parseFloat(input.value) || 0;
        sum += value;
      });
      document.getElementById("id_incomeinfo_total").value = sum.toFixed(2);
    }

    // Add event listeners to all input fields
    incomeinfo_inputs.forEach((input) =>
      input.addEventListener("input", calculateSumIncome)
    );

    // Code segment ends

    // The Code segment to calculate the expensesinfo

    // Select all your input fields
    var expensesinfo_inputs = document.querySelectorAll(
      "input[type=number][name^=expensesinfo_]:not([name=expensesinfo_total])"
    );

    // Function to calculate the sum
    function calculateSumExpenses() {
      let sum = 0;
      expensesinfo_inputs.forEach((input) => {
        const value = parseFloat(input.value) || 0;
        sum += value;
      });
      document.getElementById("id_expensesinfo_total").value = sum.toFixed(2);
    }

    // Add event listeners to all input fields
    expensesinfo_inputs.forEach((input) =>
      input.addEventListener("input", calculateSumExpenses)
    );

    // Validator method for first, second, and last name fields in the form
    $.validator.addMethod(
      "nameRegex",
      function (value, element) {
        return (
          this.optional(element) || /^[a-zA-Z0-9\u0621-\u064A]*$/i.test(value)
        );
      },
      "يحتوي الأسم على حروف فقط."
    );

    $.validator.addMethod(
      "fullNameRegex",
      function (value, element) {
        return (
          this.optional(element) ||
          /^[a-zA-Z\u0621-\u064A]+([ '-][a-zA-Z\u0621-\u064A]+)*$/i.test(value)
        );
      },
      "يجب أن يتكون الاسم الكامل من الاسم الأول والأوسط والأخير."
    );

    // Validate Saudi Arabia IDs (Iqama/Saudi Natioanl Id)
    function validateSAID(id) {
      let type = id.substr(0, 1);
      let sum = 0;
      const _idLength = 10;
      const _type1 = "1";
      const _type2 = "2";
      id = id.trim();
      if (
        isNaN(parseInt(id)) ||
        id.length !== _idLength ||
        (type !== _type2 && type !== _type1)
      ) {
        return false;
      }
      for (let num = 0; num < 10; num++) {
        const digit = Number(id[num]);
        if (num % 2 === 0) {
          const doubled = digit * 2;
          const ZFOdd = `00${doubled}`.slice(-2);
          sum += Number(ZFOdd[0]) + Number(ZFOdd[1]);
        } else {
          sum += digit;
        }
      }
      return sum % 10 !== 0 ? false : true;
    }

    // Validator method for the national id (Iqama/Saudi)
    $.validator.addMethod(
      "nationalidRegex",
      function (value, element) {
        return this.optional(element) || validateSAID(value);
      },
      "أدخل رقم هوية/إقامة صحيح."
    );

    // Validator method for the phone number [Working - International Phone Numbers]
    /*
        $.validator.addMethod(
          "phonenumberRegex",
          function (value, element) {
              return this.optional(element) || /^(?:\+?\d{1,3}[\s-]?)?(0\d{9}|(?:\d{3}[\s-]?\d{3}[\s-]?\d{4})|\d{10})$/i.test(value);
          },
          "الرجاء إدخال رقم جوال صحيح."
        );
        */

    // Validator method for the phone number [Saudi Arabia Only]
    $.validator.addMethod(
      "saudiPhoneRegex",
      function (value, element) {
        return (
          this.optional(element) || /^(?:\+966\s?5\d{8}|05\d{8})$/i.test(value)
        );
      },
      "الرجاء إدخال رقم جوال صحيح في المملكة العربية السعودية."
    );

    // Email address validator
    $.validator.addMethod(
      "emailRegex",
      function (value, element) {
        return (
          this.optional(element) ||
          /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(value)
        );
      },
      "الرجاء إدخال بريد إلكتروني صحيح."
    );

    $.validator.addMethod('filesize', function (value, element, param) {
      return this.optional(element) || (element.files[0].size <= param * 1000000)
    }, 'حجم الملف يجب أن يكون أقل من {0} MB');

    // Global variables
    var form = $("#edit_beneficiary_request_form");
    var alertContainer = $("#alert-danger-error-fields");
    var tabs = $(".nav-link.next"); //

    // The below code will change the default validation messages
    $.extend($.validator.messages, {
      required: "هذا الحقل مطلوب.",
      remote: "الرجاء اصلاح هذا الحقل.",
      email: "الرجاء إدخال بريد الكتروني صالح.",
      url: "الرجاء إدخال رابط صحيح وفعال.",
      date: "الرجاء إدخال تاريخ صالح.",
      dateISO: "الرجاء إدخال تاريخ صحيح (بصيغة ISO).",
      number: "الرجاء إدخال رقم صحيح.",
      digits: "الرجاء إدخال أرقام فقط.",
      creditcard: "الرجاء إدخال رقم بطاقة ائتمان صالحة.",
      equalTo: "رجاء أدخل نفس القيمة مره أخرى.",
      accept: "الرجاء إدخال قيمة بإمتداد صحيح.",
      maxlength: $.validator.format("الرجاء عدم إدخال أكثر من {0} أحرف."),
      minlength: $.validator.format("الرجاء إدخال على الأقل {0} حروف."),
      rangelength: $.validator.format(
        "Please enter a value between {0} and {1} characters long."
      ),
      range: $.validator.format("الرجاء إدخال رقم بين {0} و {1}."),
      max: $.validator.format(" الرجاء إدخال قيمة أقل من أو تساوي {0}."),
      min: $.validator.format("الرجاء إدخال قيمة أعلى من أو تساوي {0}."),
    });

    form.validate({
      errorElement: "span",
      errorClass: "help-block invalid-feedback",
      highlight: function (element, errorClass, validClass) {
        $(element).closest(".form-group").addClass("has-error");
        //$(element).fadeOut(function() {
        //  $(element).fadeIn();
        //  });
      },
      unhighlight: function (element, errorClass, validClass) {
        $(element).closest(".form-group").removeClass("has-error");
      },
      errorPlacement: function (error, element) {
        // Check if the element is inside an input-group
        if (element.parent(".input-group").length) {
          // Place the error after the input-group
          error.insertAfter(element.parent(".input-group"));
        } else {
          // Default placement for other elements
          error.insertAfter(element);
        }
      },
      focusInvalid: true,

      // Adding the rules (validations) for each input in the form.
      rules: {
        personalinfo_first_name: {
          required: true,
          nameRegex: true,
          minlength: 2,
          maxlength: 20,
        },
        personalinfo_second_name: {
          required: true,
          nameRegex: true,
          minlength: 2,
          maxlength: 20,
        },
        personalinfo_last_name: {
          required: true,
          nameRegex: true,
          minlength: 2,
          maxlength: 20,
        },
        personalinfo_date_of_birth: {
          required: true,
          dateISO: true,
        },
        personalinfo_gender: {
          required: true,
        },
        personalinfo_national_id: {
          required: true,
          nationalidRegex: true,
        },
        personalinfo_national_id_exp_date: {
          required: true,
          dateISO: true,
        },
        personalinfo_nationality: {
          required: true,
          maxlength: 30,
        },
        personalinfo_category: {
          required: true,
        },
        personalinfo_marital_status: {
          required: true,
        },
        personalinfo_educational_level: {
          required: true,
        },
        personalinfo_death_date_father_husband: {
          required: true,
          dateISO: true,
        },
        personalinfo_washing_place: {
          required: false,
        },
        personalinfo_health_status: {
          required: true,
        },
        personalinfo_disease_type: {
          required: true,
        },
        personalinfo_work_status: {
          required: true,
        },
        personalinfo_employer: {
          required: true,
        },
        personalinfo_phone_number: {
          required: true,
          saudiPhoneRegex: true,
        },
        personalinfo_email: {
          required: true,
          //emailRegex: true,
        },
        // dependent_information ---------
        dependent_info_name: {
          required: true,
          fullNameRegex: true,
          minlength: 2,
          maxlength: 50,
        },
        dependent_info_relationship: {
          required: true,
        },
        dependent_info_national_id: {
          required: true,
          nationalidRegex: true,
        },
        dependent_info_national_id_exp_date: {
          required: true,
          dateISO: true,
        },
        dependent_info_gender: {
          required: true,
        },
        dependent_info_marital_status: {
          required: true,
        },
        dependent_info_educational_status: {
          required: true,
        },
        dependent_info_educational_level: {
          required: true,
        },
        dependent_info_educational_degree: {
          required: true,
        },
        dependent_info_health_status: {
          required: true,
        },
        dependent_info_disease_type: {
          required: true,
        },
        dependent_info_date_of_birth: {
          required: true,
          dateISO: true,
        },
        dependent_info_needs_type: {
          required: true,
        },
        // housing_income_need_information ---------
        houseinfo_building_number: {
          required: true,
        },
        houseinfo_street_name: {
          required: true,
        },
        houseinfo_neighborhood: {
          required: true,
        },
        houseinfo_city: {
          required: true,
        },
        houseinfo_postal_code:{
          required: true,
        },
        houseinfo_additional_number: {
          required: true,
        },
        houseinfo_unit: {
          required: true,
        },
        houseinfo_location_url: {
          required: true,
        },
        houseinfo_housing_type: {
          required: true,
        },
        houseinfo_housing_ownership: {
          required: true,
        },
        incomeinfo_salary: {
          required: true,
        },
        incomeinfo_social_insurance: {
          required: true,
        },
        incomeinfo_charity: {
          required: true,
        },
        incomeinfo_social_warranty: {
          required: true,
        },
        incomeinfo_pension_agency: {
          required: true,
        },
        incomeinfo_citizen_account: {
          required: true,
        },
        incomeinfo_benefactor: {
          required: true,
        },
        incomeinfo_other: {
          required: true,
        },
        expensesinfo_housing_rent: {
          required: true,
        },
        expensesinfo_electricity_bills: {
          required: true,
        },
        expensesinfo_water_bills: {
          required: true,
        },
        expensesinfo_transportation: {
          required: true,
        },
        expensesinfo_health_supplies: {
          required: true,
        },
        expensesinfo_food_supplies: {
          required: true,
        },
        expensesinfo_educational_supplies: {
          required: true,
        },
        expensesinfo_proven_debts: {
          required: true,
        },
        expensesinfo_other: {
          required: true,
        },
        familyinfo_family_issues: {
          required: true,
        },
        familyinfo_needs_type: {
          required: true,
        },
        personalinfo_bank_iban: {
          required: true,
          validateIBAN: true,
        },
        personalinfo_bank_type: {
          required: true,
        },
        // attachments_information --------- // File rules are currently not working
        fileBeneficiaryNationalID: {
          required: true,
          accept: "application/pdf, image/*",
          filesize : 5, // here we are working with MB
        },
        fileNationalIDForBeneficiaryDependents: {
          required: true,
          accept: "application/pdf, image/*",
        },
        fileBeneficiaryNationalAddress: {
          required: true,
          accept: "application/pdf, image/*",
        },
        filePensionOrSocialInsuranceInquiry: {
          required: true,
          accept: "application/pdf, image/*",
        },
        fileFatherOrHusbandDeathCertificate: {
          required: true,
          accept: "application/pdf, image/*",
        },
        fileLetterFromPrison: {
          required: true,
          accept: "application/pdf, image/*",
        },
        fileDivorceDeed: {
          required: true,
          accept: "application/pdf, image/*",
        },
        fileChildrenResponsibilityDeed: {
          required: true,
          accept: "application/pdf, image/*",
        },
        fileLeaseContractOrTitleDeed: {
          required: true,
          accept: "application/pdf, image/*",
        },
        fileWaterOrElectricityBills: {
          required: true,
          accept: "application/pdf, image/*",
        },
        fileSocialWarrantyInquiry: {
          required: true,
          accept: "application/pdf, image/*",
        },
      },
      messages: {
        personalinfo_first_name: {
          required: "هذا الحقل مطلوب.",
        },
        password: {
          required: "Password required",
        },
        conf_password: {
          required: "Password required",
          equalTo: "Password don't match",
        },
        name: {
          required: "Name required",
        },
        email: {
          required: "Email required",
        },
      },
    });

    // When ".next" button is clicked, the following function is executed
    form.find("input, select, textarea").on("input change", function () {

      form.valid(); // Trigger validation
      updateAlert(); // Update the alert based on the validation result
      updateTabs(); // Update the tabs based on the validation result

    }); // input, select, textarea input fields (onclick, oninput) end line

    // Function to update the alert based on the form's validation status
    function updateAlert() {
      // Clear the content of the alert before updating
      alertContainer.empty();
      var errorMessages = [];

      // Check if the custom error message is visible
      var minChoiceErrorVisible = $('.minChoiceErrorMessage').length > 0;

      if (form.valid() && !minChoiceErrorVisible) {
        // If the form is valid and the custom error is not visible, hide the alert
        alertContainer.hide();

        // Enable the submit button
      $("#submit-btn").prop("disabled", false);
      } else {
        // If the form is invalid or the custom error is visible, construct the alert message with all validation errors
        errorMessages = [];

        form.find(".help-block.invalid-feedback").each(function () {
          var fieldName = $(this).prevAll("input, select, textarea").attr("data-bs-title");
          var errorMessage = $(this).text().trim(); // Get the trimmed text content

          // Check if the errorMessage is not empty before pushing it
          if (errorMessage !== "") {
            errorMessages.push("<li>" + fieldName + ": " + errorMessage + "</li>");
          }
        });

        if (errorMessages.length > 0 || minChoiceErrorVisible) {

          // Display the alert with the list of errors
          // If there's not minChoiceErrorVisible
          if(!minChoiceErrorVisible) {
            var errorMessage = "<strong>الرجاء تصحيح الأخطاء التالية:</strong><br><ul>" + errorMessages.join("") + "</ul>";
            alertContainer.html(errorMessage).show();
          } else {
            var errorMessageFamilyIssues = $("#minChoiceCountFamilyIssuesErrorMessage").length > 0;
            var errorMessageFamilyNeeds = $("#minChoiceCountFamilyNeedsErrorMessage").length > 0;

            if (errorMessageFamilyIssues && errorMessageFamilyNeeds) {
              errorMessages.push("<li>" + "المشكلات التي تعاني منها الأسرة" + ": " + "الرجاء تحديد نوع واحد على الأقل" + "</li>");
              errorMessages.push("<li>" + "نوع احتياج الأسرة" + ": " + "الرجاء تحديد نوع واحد على الأقل" + "</li>");
            } else if (errorMessageFamilyIssues) {
              errorMessages.push("<li>" + "المشكلات التي تعاني منها الأسرة" + ": " + "الرجاء تحديد نوع واحد على الأقل" + "</li>");

            } else {// in case of family needs
              errorMessages.push("<li>" + "نوع احتياج الأسرة" + ": " + "الرجاء تحديد نوع واحد على الأقل" + "</li>");
            }
            
            var errorMessage = "<strong>الرجاء تصحيح الأخطاء التالية:</strong><br><ul>" + errorMessages.join("") + "</ul>";
            alertContainer.html(errorMessage).show();
          }

          // Disable the submit button
          $("#submit-btn").prop("disabled", true);
        }
      }
    }

    // Function to update the tabs based on the form's validation status
    function updateTabs() {
      var minChoiceErrorsVisible = $('.minChoiceErrorMessage').length > 0;

      if (alertContainer.is(":visible") || minChoiceErrorsVisible) {
        // If the alert or custom error is visible, disable the tabs
        tabs.attr("data-bs-toggle", "");
      } else {
        // If neither the alert nor custom error is visible, enable the tabs
        tabs.attr("data-bs-toggle", "tab");
      }
    }

    
    // Add an event listener to the form inputs to check validity and enable/disable the button
    form.find("input, select, textarea").on("input change", function () {
      // Check if the form is valid
      var isFormValid = form.valid();

      // Check if the custom error message is visible
      var minChoiceErrorVisible = $('.minChoiceErrorMessage').length > 0;
      
      if (!minChoiceErrorVisible) {
        // Enable or disable the submit button based on form validity
        $("#submit-btn").prop("disabled", !isFormValid);
      } 
    });

    // Function to convert non-English numbers to English numbers
    function convertToEnglishNumber(input) {
      const easternArabicNumerals = '٠١٢٣٤٥٦٧٨٩';
      const englishNumerals = '0123456789';

      for (let i = 0; i < easternArabicNumerals.length; i++) {
          const regex = new RegExp(easternArabicNumerals[i], 'g');
          input = input.replace(regex, englishNumerals[i]);
      }

      return input;
    }

    // Event listener for all input fields with class 'convert-to-english'
    document.querySelectorAll('.convert-to-english').forEach(function (inputField) {
      inputField.addEventListener('input', function (event) {
        const inputValue = event.target.value;
        const convertedValue = convertToEnglishNumber(inputValue);
        event.target.value = convertedValue;

        // to fix the error where the alert is not detecting the changes
        updateAlert();
        updateTabs();
      });
    });

    // Function to display an error message
    function displayMinChoiceCountFamilyIssuesErrorMessage(message, duration) {
      // Check if the error message element already exists
      var errorMessageElement = document.getElementById('minChoiceCountFamilyIssuesErrorMessage');
      
      // If not, create a new element and append it to the page
      if (!errorMessageElement) {
        errorMessageElement = document.createElement('div');
        errorMessageElement.id = 'minChoiceCountFamilyIssuesErrorMessage';
        errorMessageElement.classList.add('alert', 'alert-danger', 'minChoiceErrorMessage');

        // Get the parent node of the dependent income table
        var parentElement = document.getElementById('id_familyinfo_family_issues').parentNode;

        // Insert the error message element at the top of the parent node
        parentElement.insertBefore(errorMessageElement, parentElement.firstChild);

        // Focus on the error message
        errorMessageElement.focus();

        // Remove the error message after a specified duration
        //setTimeout(function () {
        //  removeMaxRowErrorMessage();
        //}, duration);
      }

      // Listen for changes in the checkboxes to update the error message
      var checkboxes = document.querySelectorAll('#id_familyinfo_family_issues input[type="checkbox"]');
      checkboxes.forEach(function (checkbox) {
        checkbox.addEventListener('change', function () {
          // Check if more than one checkbox is checked
          var checkedCount = Array.from(checkboxes).filter(function (checkbox) {
            return checkbox.checked;
          }).length;

          // If more than one checkbox is checked, remove the error message
          if (checkedCount > 0) {
            removeMinChoiceCountFamilyIssuesErrorMessage();
            
          }
        });
      });

      // Set the error message text
      errorMessageElement.textContent = message;
    }

    // Function to remove the error message
    function removeMinChoiceCountFamilyIssuesErrorMessage() {
      var errorMessageElement = document.getElementById('minChoiceCountFamilyIssuesErrorMessage');
      if (errorMessageElement) {
        errorMessageElement.remove();
        $("#submit-btn").prop("disabled", false); // Enable the submit button when the error is removed
        // to fix the error where the alert is not detecting the changes
        updateAlert();
        updateTabs();
      }
    }

    // Function to display an error message
    function displayMinChoiceCountFamilyNeedsErrorMessage(message, duration) {
      // Check if the error message element already exists
      var errorMessageElement = document.getElementById('minChoiceCountFamilyNeedsErrorMessage');
      
      // If not, create a new element and append it to the page
      if (!errorMessageElement) {
        errorMessageElement = document.createElement('div');
        errorMessageElement.id = 'minChoiceCountFamilyNeedsErrorMessage';
        errorMessageElement.classList.add('alert', 'alert-danger', 'minChoiceErrorMessage');

        // Get the parent node of the dependent income table
        var parentElement = document.getElementById('id_familyinfo_needs_type').parentNode;

        // Insert the error message element at the top of the parent node
        parentElement.insertBefore(errorMessageElement, parentElement.firstChild);

        // Focus on the error message
        errorMessageElement.focus();

        // Remove the error message after a specified duration
        //setTimeout(function () {
        //  removeMaxRowErrorMessage();
        //}, duration);
      }

      // Listen for changes in the checkboxes to update the error message
      var checkboxes = document.querySelectorAll('#id_familyinfo_needs_type input[type="checkbox"]');
      checkboxes.forEach(function (checkbox) {
        checkbox.addEventListener('change', function () {
          // Check if more than one checkbox is checked
          var checkedCount = Array.from(checkboxes).filter(function (checkbox) {
            return checkbox.checked;
          }).length;

          // If more than one checkbox is checked, remove the error message
          if (checkedCount > 0) {
            removeMinChoiceCountFamilyNeedsErrorMessage();
          }
        });
      });

      // Set the error message text
      errorMessageElement.textContent = message;
    }

    // Function to remove the error message
    function removeMinChoiceCountFamilyNeedsErrorMessage() {
      var errorMessageElement = document.getElementById('minChoiceCountFamilyNeedsErrorMessage');
      if (errorMessageElement) {
        errorMessageElement.remove();
        $("#submit-btn").prop("disabled", false); // Enable the submit button when the error is removed
        // to fix the error where the alert is not detecting the changes
        updateAlert();
        updateTabs();
      }
    }

    // Initially update the alert and tabs based on the form's validation status
    updateAlert();
    updateTabs();

    // Add click and input event listeners to checkboxes inside the family issues container
    $('#id_familyinfo_family_issues input[type="checkbox"]').on('click input', function () {
      displayMinChoiceCountFamilyIssuesErrorMessage("الرجاء تحديد نوع واحد على الأقل.", 5000);
      
      updateAlert(); // Update the alert after displaying the custom error
      updateTabs();  // Update the tabs after displaying the custom error
    });

    // Add click and input event listeners to checkboxes inside the family needs container
    $('#id_familyinfo_needs_type input[type="checkbox"]').on('click input', function () {
      displayMinChoiceCountFamilyNeedsErrorMessage("الرجاء تحديد نوع واحد على الأقل.", 5000);
      
      updateAlert(); // Update the alert after displaying the custom error
      updateTabs();  // Update the tabs after displaying the custom error
    });

    /*
    function getTableDataAsJSON() {
        const table = document.getElementById('family-table');
        const rows = document.querySelectorAll('#family-table tr');
        let dependentsData = [];
    
        for (let i = 1; i < rows.length; i++) { // Start from 1 to skip table header
            const cells = rows[i].getElementsByTagName('td');
            let dependent = {
                firstName: cells[0].innerText, // Assuming first cell contains the first name
                secondName: cells[1].innerText,
                lastName: cells[2].innerText,
                gender: cells[3].innerText,
                relationship: cells[4].innerText,
                educationalStatus: cells[5].innerText,
                martialStatus: cells[6].innerText,
                nationalID: cells[7].innerText,
                healthStatus: cells[8].innerText,
                dependentIncomeTable: cells[9].innerText,
                needsType: cells[10].innerText,
                educationalDegree: cells[11].innerText,
                dateOfBitrh: cells[12].innerText,
                nationalIDExpDate: cells[13].innerText,
                needsDescription: cells[14].innerText,
                educationalLevel: cells[15].innerText,
                diseaseType: cells[16].innerText,
            };
            dependentsData.push(dependent);
        }
    
        return JSON.stringify(dependentsData);
    }
    */
    
    // Use this function to get JSON when you need it
    //const dependentsJSON = getTableDataAsJSON();
    //console.log(dependentsJSON); // Logs the JSON string
    
    document.getElementById('edit_beneficiary_request_form').addEventListener('submit', function(e) {
      e.preventDefault();

      const formData = new FormData(this);

      // Collecting checkbox values
      /*
      let dependentNeedsType = [];
      document.querySelectorAll('#id_dependent_info_needs_type input[type=checkbox]').forEach((checkbox) => {
          if (checkbox.checked) {
              dependentNeedsType.push(checkbox.value);
          }
      });
      formData.append('dependent_info_needs_type', JSON.stringify(dependentNeedsType));
      */

      // Collecting checkbox values
      let familyIssue = [];
      document.querySelectorAll('#id_familyinfo_family_issues input[type=checkbox]').forEach((checkbox) => {
          if (checkbox.checked) {
              familyIssue.push(checkbox.value);
          }
      });
      formData.append('familyinfo_family_issues', JSON.stringify(familyIssue));

      // Collecting checkbox values
      let familyNeedsType = [];
      document.querySelectorAll('#id_familyinfo_needs_type input[type=checkbox]').forEach((checkbox) => {
          if (checkbox.checked) {
              familyNeedsType.push(checkbox.value);
          }
      });
      formData.append('familyinfo_needs_type', JSON.stringify(familyNeedsType));

      // Adding information of the dependents table to the FormData
      //formData.append('dependents-table', getTableDataAsJSON());

      // Remove 'Content-Type' header to allow the browser to add it
      // along with the correct 'boundary'
      // delete options.headers['Content-Type'];

      fetch('http://127.0.0.1:8000{% url 'beneficiary_request_update_confirm' username=user_info.username b_request_id=request_id %}', {
          method: 'POST',
          body: formData,
      })
      .then(response => response.json())
      .then(data => {
          if (data.redirect) {
              window.location.href = data.redirect;
              // console.log(data);
          } else {
              // Handle other responses
          }
      })
      .catch((error) => {
          console.error('Error:', error);
          // Handle error
      });
    });


  }); // document end line 
</script>
{% endblock %}