{% extends "dashboard/dbase.html" %}
{% block title %} الصفحة الرئيسية {% endblock %}
{% block content %}
{% load static %}

<div class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
  <div class="col-md-12 ms-sm-auto col-lg-12">
    <div class="p-5 my-4 rounded-3 has-bg-img" style="background-image: radial-gradient(#00834d 1.6500000000000001px, #212529 1.6500000000000001px); background-size: 65px 65px;">
        <h1 class="text-light">مرحبا {{ user.username }}, هنا صفحة الاحصائيات الرئيسية</h1>
        <p class="lead text-light">هنا يمكنك التحكم وإدارة جميع خدمات وحسابات المستفيدين</p>
    </div>
    <div class="row column-gap-4 justify-content-md-center">
        <div class="col col-lg-3 p-4 my-4 rounded-3 justify-content-between align-self-center border d-flex align-items-center" style="min-height: 15vh;">
          <div class="w-100">      
            <h2 class="text-center">المستفيدين</h2>
            <p class="text-center fs-2 text-success">{{ beneficiaries_num }}</p>
          </div>
          <div class="pe-4">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6" width="52" height="52">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z" />
            </svg>  
          </div>  
        </div>
        <div class="col-xl-3 col-lg-3 p-4 my-4 rounded-3 justify-content-between align-self-center border d-flex align-items-center" style="min-height: 15vh;">
          <div class="w-100">
            <h2 class="text-center">التابعين</h2>
            <p class="text-center fs-2 text-success">{{ dependents_num }}</p>
          </div>
          <div class="pe-4">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6" width="52" height="52" >
              <path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z" />
            </svg>
          </div>
        </div>
        <div class="col col-lg-3 p-4 my-4 gap-5 rounded-3 justify-content-between align-self-center border d-flex align-items-center" style="min-height: 15vh;">
          <div class="w-100">     
            <h2 class="text-center">الأيتام</h2>
            <p class="text-center fs-2 text-success">{{ orphans_num }}</p>
          </div>
          <div class="pe-4">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6" width="52" height="52">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z" />
            </svg>
          </div>
        </div>
        <div class="col col-lg-3 p-4 my-4 gap-5 rounded-3 justify-content-between align-self-center border d-flex align-items-center" style="min-height: 15vh;">
          <div class="w-100">     
            <h2 class="text-center">المستفيدين ذو الحاجة الطبية</h2>
            <p class="text-center fs-2 text-success">{{ beneficiaries_with_medical_needs }}</p>
          </div>
          <div class="pe-4">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6" width="52" height="52">
              <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 21v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21m0 0h4.5V3.545M12.75 21h7.5V10.75M2.25 21h1.5m18 0h-18M2.25 9l4.5-1.636M18.75 3l-1.5.545m0 6.205 3 1m1.5.5-1.5-.5M6.75 7.364V3h-3v18m3-13.636 10.5-3.819" />
            </svg>
          </div>
        </div>
        <div class="col col-lg-3 p-4 my-4 gap-5 rounded-3 justify-content-between align-self-center border d-flex align-items-center" style="min-height: 15vh;">
          <div class="w-100">     
            <h2 class="text-center">متوسط الدخل</h2>
            <p class="text-center fs-2 text-success">{{ average_income }}</p>
          </div>
          <div class="pe-4">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6" width="52" height="52">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
            </svg>
          </div>
        </div>
        <div class="col col-lg-3 p-4 my-4 gap-5 rounded-3 justify-content-between align-self-center border d-flex align-items-center" style="min-height: 15vh;">
          <div class="w-100">     
            <h2 class="text-center">متوسط المصاريف</h2>
            <p class="text-center fs-2 text-success">{{ average_expense }}</p>
          </div>
          <div class="pe-4">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6" width="52" height="52">
              <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 21v-7.5a.75.75 0 0 1 .75-.75h3a.75.75 0 0 1 .75.75V21m-4.5 0H2.36m11.14 0H18m0 0h3.64m-1.39 0V9.349M3.75 21V9.349m0 0a3.001 3.001 0 0 0 3.75-.615A2.993 2.993 0 0 0 9.75 9.75c.896 0 1.7-.393 2.25-1.016a2.993 2.993 0 0 0 2.25 1.016c.896 0 1.7-.393 2.25-1.015a3.001 3.001 0 0 0 3.75.614m-16.5 0a3.004 3.004 0 0 1-.621-4.72l1.189-1.19A1.5 1.5 0 0 1 5.378 3h13.243a1.5 1.5 0 0 1 1.06.44l1.19 1.189a3 3 0 0 1-.621 4.72M6.75 18h3.75a.75.75 0 0 0 .75-.75V13.5a.75.75 0 0 0-.75-.75H6.75a.75.75 0 0 0-.75.75v3.75c0 .414.336.75.75.75Z" />
            </svg>     
          </div>
        </div>
        {% comment %} <div class="col col-lg-3 p-4 my-4 rounded-3 justify-content-center align-self-center border d-flex align-items-center">
          <div class="px-5">
            <h2 class="text-right">المستخدمين النشطين</h2>
            <p class="text-right fs-2 text-success">{{ active_users_num }}</p>
          </div>
          <div class="pe-4">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 d-flex justify-content-center align-items-center" width="52" height="52">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z" />
            </svg>        
          </div>  
        </div> {% endcomment %}
    </div>
  </div>

  <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2">لوحة القيادة</h1>
    <div class="btn-toolbar mb-2 mb-md-0">
      <div class="btn-group me-2">
        <button type="button" class="btn btn-sm btn-outline-secondary">مشاركة</button>
        <button type="button" class="btn btn-sm btn-outline-secondary">تصدير</button>
      </div>
      <button type="button" class="btn btn-sm btn-outline-secondary dropdown-toggle d-flex align-items-center gap-1">
        <svg class="bi"><use xlink:href="#calendar3"/></svg>
        هذا الأسبوع
      </button>
    </div>
  </div>

  <canvas class="my-4 w-100" id="myChart" width="900" height="380"></canvas>

  <h2>آخر التبرعات</h2>
  <div class="table-responsive small">
    <table class="table table-striped table-sm">
      <thead>
        <tr>
          <th scope="col">#</th>
          <th scope="col">اسم المتبرع</th>
          <th scope="col">المبلغ</th>
          <th scope="col">التاريخ</th>
          <th scope="col">نوع التبرع</th>
        </tr>
      </thead>
      <tbody>
        {% for donation in recent_donations %}
        <tr>
          <td>{{ forloop.counter }}</td>
          <td>{{ donation.supporter_name }}</td>
          <td>{{ donation.amount }} ريال</td>
          <td>{{ donation.date }}</td>
          <td>{{ donation.type }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

{% endblock %}
