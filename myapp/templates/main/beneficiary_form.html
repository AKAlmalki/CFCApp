{% extends "base.html" %} {% load static %} {% load humanize %} {% block head %}
<link rel="stylesheet" href="{% static 'css/custom_form2.css' %}" />
<!-- Include jQuery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<!-- Include jQuery Validation Plugin -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js"></script>

<script src="{% static 'js/utilities.js' %}"></script>
<script src="{% static 'js/beneficiary_request_form.js' %}"></script>
<style type="text/css">
  #dependent_information,
  #housing_income_need_information,
  #attachments_information,
  #submit_confirmation {
    display: none;
  }

  .file-names-list {
    list-style-type: none;
  }

  .file-names-list li {
    max-width: 350px;
  }
</style>
{% endblock %} {% block content %}
<div class="container mt-5 px-0 mb-4 p-5 rounded-3">
  <div>
    <h1 class="fw-bold">تقديم طلب دعم</h1>
    <div id="multi-step-form-container">
      <!-- Form Steps / Progress Bar -->
      <ul
        class="form-stepper form-stepper-horizontal text-center justify-content-center px-0 ps-lg-3 ps-xl-5 ps-md-0 mx-auto pl-0 d-flex justify-content-center row row-cols-md-5 row-cols-3"
      >
        <!-- Step 1 -->
        <li
          class="form-stepper-active text-center form-stepper-list"
          step="1"
          id="form-list-1"
        >
          <a class="mx-2 text-decoration-none">
            <span class="form-stepper-circle">
              <span>1</span>
            </span>
            <div class="label">بيانات مقدم الطلب</div>
          </a>
        </li>
        <!-- Step 2 -->
        <li
          class="form-stepper-unfinished text-center form-stepper-list"
          step="2"
          id="form-list-2"
        >
          <a class="mx-2 text-decoration-none">
            <span class="form-stepper-circle text-muted">
              <span>2</span>
            </span>
            <div class="label text-muted">بيانات المرافقين</div>
          </a>
        </li>
        <!-- Step 3 -->
        <li
          class="form-stepper-unfinished text-center form-stepper-list"
          step="3"
          id="form-list-3"
        >
          <a class="mx-2 text-decoration-none">
            <span class="form-stepper-circle text-muted">
              <span>3</span>
            </span>
            <div class="label text-muted">
              <p class="p-0 m-0">بيانات السكن</p>
              <p>والدخل والاحتياج</p>
            </div>
          </a>
        </li>
        <!-- Step 4 -->
        <li
          class="form-stepper-unfinished text-center form-stepper-list"
          step="4"
          id="form-list-4"
        >
          <a class="mx-2 text-decoration-none">
            <span class="form-stepper-circle text-muted">
              <span>4</span>
            </span>
            <div class="label text-muted">المرفقات</div>
          </a>
        </li>
        <!-- Step 5 -->
        <li
          class="form-stepper-unfinished text-center form-stepper-list"
          step="5"
          id="form-list-5"
        >
          <a class="mx-2 text-decoration-none">
            <span class="form-stepper-circle text-muted">
              <span>5</span>
            </span>
            <div class="label text-muted text-decoration-none">تقديم الطلب</div>
          </a>
        </li>
      </ul>
      <!-- Step Wise Form Content -->
      <form
        id="myform"
        name="myform"
        enctype="multipart/form-data"
        method="POST"
        action="/beneficiaries/new"
        class="needs-validation bg-light"
        novalidate
      >
        {% csrf_token %}
        <!-- Step 1 Content -->
        <fieldset id="personal_information" class="form-step px-3 px-lg-5">
          <legend class="fs-2 fw-bold mb-5">بيانات مقدم الطلب</legend>
          <!-- Step 1 input fields -->
          <div class="mt-3">
            <div class="">
              <div class="container">
                <div class="row row-cols-md-2 row-cols-xl-4">
                  <div class="col-md-6 mb-4 form-group">
                    <label for="id_personalinfo_first_name" class="form-label"
                      >الاسم الأول<span style="color: red">*</span></label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="id_personalinfo_first_name"
                      maxlength="55"
                      required
                      name="personalinfo_first_name"
                      value="{{ user.first_name }}" 
                      disabled
                      readonly
                    />
                  </div>
                  <div class="col-md-6 mb-4 form-group">
                    <label for="id_personalinfo_second_name" class="form-label"
                      >الاسم الثاني<span style="color: red">*</span></label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="id_personalinfo_second_name"
                      maxlength="55"
                      required
                      name="personalinfo_second_name"
                      value="{{ user.second_name }}" 
                      disabled
                      readonly
                    />
                  </div>
                  <div class="col-md-6 mb-4 form-group">
                    <label for="id_personalinfo_last_name" class="form-label"
                      >الاسم الاخير<span style="color: red">*</span> (اسم
                      العائلة)</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="id_personalinfo_last_name"
                      maxlength="55"
                      required
                      name="personalinfo_last_name"
                      value="{{ user.last_name }}" 
                      disabled
                      readonly
                    />
                  </div>
                  <div class="col-md-6 mb-4 form-group">
                    <label for="id_personalinfo_date_of_birth" class="form-label">تاريخ الميلاد<span style="color: red">*</span></label>
                    <input
                      type="date"
                      class="form-control"
                      id="id_personalinfo_date_of_birth"
                      name="personalinfo_date_of_birth"
                      value="{{ user.date_of_birth|date:'Y-m-d' }}"
                      disabled
                      readonly  
                    />
                  </div>
                </div>

                <hr />
                <div class="row row-cols-md-2 row-cols-xl-4">
                  <div class="col-md-6 mb-4 form-group">
                    <label for="id_personalinfo_gender" class="form-label">الجنس<span style="color: red">*</span></label>
                    <select
                      name="personalinfo_gender"
                      class="form-select"
                      id="id_personalinfo_gender"
                      disabled
                      readonly
                    >
                      <option value="ذكر" {% if user.gender == "ذكر" %} selected {% endif %}>ذكر</option>
                      <option value="انثى" {% if user.gender == "انثى" %} selected {% endif %}>انثى</option>
                    </select>
                  </div>
                  <!-- National ID Field (disabled) -->
                  <div class="col-md-6 mb-4 form-group">
                    <label for="id_personalinfo_national_id" class="form-label">رقم الهوية الوطنية \ الإقامة<span style="color: red">*</span></label>
                    <input
                      type="text"
                      class="form-control"
                      id="id_personalinfo_national_id"
                      maxlength="20"
                      name="personalinfo_national_id"
                      value="{{ user.national_id }}" 
                      disabled
                      readonly
                    />
                  </div>
                  <div class="col-md-6 mb-4 form-group">
                    <label
                      for="id_personalinfo_national_id_exp_date"
                      class="form-label"
                      >تاريخ انتهاء الهوية \ الإقامة<span style="color: red"
                        >*</span
                      ></label
                    >
                    <input
                      type="date"
                      class="form-control"
                      id="id_personalinfo_national_id_exp_date"
                      name="personalinfo_national_id_exp_date"
                      value="{{ user.national_id_exp_date|date:'Y-m-d' }}"
                      disabled
                      readonly
                    />
                  </div>
                  <div class="col-md-6 mb-4 form-group">
                    <label for="id_personalinfo_nationality" class="form-label"
                      >الجنسية<span style="color: red">*</span></label
                    >
                    <select
                      name="personalinfo_nationality"
                      class="form-select"
                      id="id_personalinfo_nationality"
                      disabled
                      readonly
                    >
                      <option value="إختر" {% if not user.nationality %} selected {% endif %}>إختر</option>
                      <option value="السعودية" {% if user.nationality == "السعودية" %} selected {% endif %}>السعودية</option>
                      <option value="أفغانستان" {% if user.nationality == "أفغانستان" %} selected {% endif %}>أفغانستان</option>
                      <option value="ألبانيا" {% if user.nationality == "ألبانيا" %} selected {% endif %}>ألبانيا</option>
                      <option value="الجزائر" {% if user.nationality == "الجزائر" %} selected {% endif %}>الجزائر</option>
                      <option value="أندورا" {% if user.nationality == "أندورا" %} selected {% endif %}>أندورا</option>
                      <option value="أنغولا" {% if user.nationality == "أنغولا" %} selected {% endif %}>أنغولا</option>
                      <option value="أنتيغوا وباربودا" {% if user.nationality == "أنتيغوا وباربودا" %} selected {% endif %}>أنتيغوا وباربودا</option>
                      <option value="الأرجنتين" {% if user.nationality == "الأرجنتين" %} selected {% endif %}>الأرجنتين</option>
                      <option value="أرمينيا" {% if user.nationality == "أرمينيا" %} selected {% endif %}>أرمينيا</option>
                      <option value="أستراليا" {% if user.nationality == "أستراليا" %} selected {% endif %}>أستراليا</option>
                      <option value="النمسا" {% if user.nationality == "النمسا" %} selected {% endif %}>النمسا</option>
                      <option value="أذربيجان" {% if user.nationality == "أذربيجان" %} selected {% endif %}>أذربيجان</option>
                      <option value="البهاما" {% if user.nationality == "البهاما" %} selected {% endif %}>البهاما</option>
                      <option value="البحرين" {% if user.nationality == "البحرين" %} selected {% endif %}>البحرين</option>
                      <option value="بنغلاديش" {% if user.nationality == "بنغلاديش" %} selected {% endif %}>بنغلاديش</option>
                      <option value="باربادوس" {% if user.nationality == "باربادوس" %} selected {% endif %}>باربادوس</option>
                      <option value="بيلاروسيا" {% if user.nationality == "بيلاروسيا" %} selected {% endif %}>بيلاروسيا</option>
                      <option value="بلجيكا" {% if user.nationality == "بلجيكا" %} selected {% endif %}>بلجيكا</option>
                      <option value="بليز" {% if user.nationality == "بليز" %} selected {% endif %}>بليز</option>
                      <option value="بنين" {% if user.nationality == "بنين" %} selected {% endif %}>بنين</option>
                      <option value="بوتان" {% if user.nationality == "بوتان" %} selected {% endif %}>بوتان</option>
                      <option value="بوليفيا" {% if user.nationality == "بوليفيا" %} selected {% endif %}>بوليفيا</option>
                      <option value="البوسنة والهرسك" {% if user.nationality == "البوسنة والهرسك" %} selected {% endif %}>البوسنة والهرسك</option>
                      <option value="بوتسوانا" {% if user.nationality == "بوتسوانا" %} selected {% endif %}>بوتسوانا</option>
                      <option value="البرازيل" {% if user.nationality == "البرازيل" %} selected {% endif %}>البرازيل</option>
                      <option value="بروناي" {% if user.nationality == "بروناي" %} selected {% endif %}>بروناي</option>
                      <option value="بلغاريا" {% if user.nationality == "بلغاريا" %} selected {% endif %}>بلغاريا</option>
                      <option value="بوركينا فاسو" {% if user.nationality == "بوركينا فاسو" %} selected {% endif %}>بوركينا فاسو</option>
                      <option value="بوروندي" {% if user.nationality == "بوروندي" %} selected {% endif %}>بوروندي</option>
                      <option value="كمبوديا" {% if user.nationality == "كمبوديا" %} selected {% endif %}>كمبوديا</option>
                      <option value="الكاميرون" {% if user.nationality == "الكاميرون" %} selected {% endif %}>الكاميرون</option>
                      <option value="كندا" {% if user.nationality == "كندا" %} selected {% endif %}>كندا</option>
                      <option value="الرأس الأخضر" {% if user.nationality == "الرأس الأخضر" %} selected {% endif %}>الرأس الأخضر</option>
                      <option value="تشاد" {% if user.nationality == "تشاد" %} selected {% endif %}>تشاد</option>
                      <option value="تشيلي" {% if user.nationality == "تشيلي" %} selected {% endif %}>تشيلي</option>
                      <option value="الصين" {% if user.nationality == "الصين" %} selected {% endif %}>الصين</option>
                      <option value="كولومبيا" {% if user.nationality == "كولومبيا" %} selected {% endif %}>كولومبيا</option>
                      <option value="جزر القمر" {% if user.nationality == "جزر القمر" %} selected {% endif %}>جزر القمر</option>
                      <option value="كوستاريكا" {% if user.nationality == "كوستاريكا" %} selected {% endif %}>كوستاريكا</option>
                      <option value="ساحل العاج" {% if user.nationality == "ساحل العاج" %} selected {% endif %}>ساحل العاج</option>
                      <option value="كرواتيا" {% if user.nationality == "كرواتيا" %} selected {% endif %}>كرواتيا</option>
                      <option value="كوبا" {% if user.nationality == "كوبا" %} selected {% endif %}>كوبا</option>
                      <option value="قبرص" {% if user.nationality == "قبرص" %} selected {% endif %}>قبرص</option>
                      <option value="التشيك" {% if user.nationality == "التشيك" %} selected {% endif %}>التشيك</option>
                      <option value="جمهورية الكونغو الديمقراطية" {% if user.nationality == "جمهورية الكونغو الديمقراطية" %} selected {% endif %}>جمهورية الكونغو الديمقراطية</option>
                      <option value="الدنمارك" {% if user.nationality == "الدنمارك" %} selected {% endif %}>الدنمارك</option>
                      <option value="جيبوتي" {% if user.nationality == "جيبوتي" %} selected {% endif %}>جيبوتي</option>
                      <option value="دومينيكا" {% if user.nationality == "دومينيكا" %} selected {% endif %}>دومينيكا</option>
                      <option value="جمهورية الدومينيكان" {% if user.nationality == "جمهورية الدومينيكان" %} selected {% endif %}>جمهورية الدومينيكان</option>
                      <option value="تيمور الشرقية" {% if user.nationality == "تيمور الشرقية" %} selected {% endif %}>تيمور الشرقية</option>
                      <option value="الإكوادور" {% if user.nationality == "الإكوادور" %} selected {% endif %}>الإكوادور</option>
                      <option value="مصر" {% if user.nationality == "مصر" %} selected {% endif %}>مصر</option>
                      <option value="السلفادور" {% if user.nationality == "السلفادور" %} selected {% endif %}>السلفادور</option>
                      <option value="غينيا الاستوائية" {% if user.nationality == "غينيا الاستوائية" %} selected {% endif %}>غينيا الاستوائية</option>
                      <option value="إريتريا" {% if user.nationality == "إريتريا" %} selected {% endif %}>إريتريا</option>
                      <option value="إستونيا" {% if user.nationality == "إستونيا" %} selected {% endif %}>إستونيا</option>
                      <option value="إثيوبيا" {% if user.nationality == "إثيوبيا" %} selected {% endif %}>إثيوبيا</option>
                      <option value="فيجي" {% if user.nationality == "فيجي" %} selected {% endif %}>فيجي</option>
                      <option value="فنلندا" {% if user.nationality == "فنلندا" %} selected {% endif %}>فنلندا</option>
                      <option value="فرنسا" {% if user.nationality == "فرنسا" %} selected {% endif %}>فرنسا</option>
                      <option value="الغابون" {% if user.nationality == "الغابون" %} selected {% endif %}>الغابون</option>
                      <option value="غامبيا" {% if user.nationality == "غامبيا" %} selected {% endif %}>غامبيا</option>
                      <option value="جورجيا" {% if user.nationality == "جورجيا" %} selected {% endif %}>جورجيا</option>
                      <option value="ألمانيا" {% if user.nationality == "ألمانيا" %} selected {% endif %}>ألمانيا</option>
                      <option value="غانا" {% if user.nationality == "غانا" %} selected {% endif %}>غانا</option>
                      <option value="اليونان" {% if user.nationality == "اليونان" %} selected {% endif %}>اليونان</option>
                      <option value="جرينادا" {% if user.nationality == "جرينادا" %} selected {% endif %}>جرينادا</option>
                      <option value="غواتيمالا" {% if user.nationality == "غواتيمالا" %} selected {% endif %}>غواتيمالا</option>
                      <option value="غينيا" {% if user.nationality == "غينيا" %} selected {% endif %}>غينيا</option>
                      <option value="غينيا بيساو" {% if user.nationality == "غينيا بيساو" %} selected {% endif %}>غينيا بيساو</option>
                      <option value="غويانا" {% if user.nationality == "غويانا" %} selected {% endif %}>غويانا</option>
                      <option value="هايتي" {% if user.nationality == "هايتي" %} selected {% endif %}>هايتي</option>
                      <option value="هندوراس" {% if user.nationality == "هندوراس" %} selected {% endif %}>هندوراس</option>
                      <option value="المجر" {% if user.nationality == "المجر" %} selected {% endif %}>المجر</option>
                      <option value="آيسلندا" {% if user.nationality == "آيسلندا" %} selected {% endif %}>آيسلندا</option>
                      <option value="الهند" {% if user.nationality == "الهند" %} selected {% endif %}>الهند</option>
                      <option value="إندونيسيا" {% if user.nationality == "إندونيسيا" %} selected {% endif %}>إندونيسيا</option>
                      <option value="إيران" {% if user.nationality == "إيران" %} selected {% endif %}>إيران</option>
                      <option value="العراق" {% if user.nationality == "العراق" %} selected {% endif %}>العراق</option>
                      <option value="جمهورية أيرلندا" {% if user.nationality == "جمهورية أيرلندا" %} selected {% endif %}>جمهورية أيرلندا</option>
                      <option value="فلسطين" {% if user.nationality == "فلسطين" %} selected {% endif %}>فلسطين</option>
                      <option value="إيطاليا" {% if user.nationality == "إيطاليا" %} selected {% endif %}>إيطاليا</option>
                      <option value="جامايكا" {% if user.nationality == "جامايكا" %} selected {% endif %}>جامايكا</option>
                      <option value="اليابان" {% if user.nationality == "اليابان" %} selected {% endif %}>اليابان</option>
                      <option value="الأردن" {% if user.nationality == "الأردن" %} selected {% endif %}>الأردن</option>
                      <option value="كازاخستان" {% if user.nationality == "كازاخستان" %} selected {% endif %}>كازاخستان</option>
                      <option value="كينيا" {% if user.nationality == "كينيا" %} selected {% endif %}>كينيا</option>
                      <option value="كيريباتي" {% if user.nationality == "كيريباتي" %} selected {% endif %}>كيريباتي</option>
                      <option value="الكويت" {% if user.nationality == "الكويت" %} selected {% endif %}>الكويت</option>
                      <option value="قرغيزستان" {% if user.nationality == "قرغيزستان" %} selected {% endif %}>قرغيزستان</option>
                      <option value="لاوس" {% if user.nationality == "لاوس" %} selected {% endif %}>لاوس</option>
                      <option value="لاتفيا" {% if user.nationality == "لاتفيا" %} selected {% endif %}>لاتفيا</option>
                      <option value="لبنان" {% if user.nationality == "لبنان" %} selected {% endif %}>لبنان</option>
                      <option value="ليسوتو" {% if user.nationality == "ليسوتو" %} selected {% endif %}>ليسوتو</option>
                      <option value="ليبيريا" {% if user.nationality == "ليبيريا" %} selected {% endif %}>ليبيريا</option>
                      <option value="ليبيا" {% if user.nationality == "ليبيا" %} selected {% endif %}>ليبيا</option>
                      <option value="ليختنشتاين" {% if user.nationality == "ليختنشتاين" %} selected {% endif %}>ليختنشتاين</option>
                      <option value="ليتوانيا" {% if user.nationality == "ليتوانيا" %} selected {% endif %}>ليتوانيا</option>
                      <option value="لوكسمبورغ" {% if user.nationality == "لوكسمبورغ" %} selected {% endif %}>لوكسمبورغ</option>
                      <option value="مدغشقر" {% if user.nationality == "مدغشقر" %} selected {% endif %}>مدغشقر</option>
                      <option value="مالاوي" {% if user.nationality == "مالاوي" %} selected {% endif %}>مالاوي</option>
                      <option value="ماليزيا" {% if user.nationality == "ماليزيا" %} selected {% endif %}>ماليزيا</option>
                      <option value="جزر المالديف" {% if user.nationality == "جزر المالديف" %} selected {% endif %}>جزر المالديف</option>
                      <option value="مالي" {% if user.nationality == "مالي" %} selected {% endif %}>مالي</option>
                      <option value="مالطا" {% if user.nationality == "مالطا" %} selected {% endif %}>مالطا</option>
                      <option value="جزر مارشال" {% if user.nationality == "جزر مارشال" %} selected {% endif %}>جزر مارشال</option>
                      <option value="موريتانيا" {% if user.nationality == "موريتانيا" %} selected {% endif %}>موريتانيا</option>
                      <option value="موريشيوس" {% if user.nationality == "موريشيوس" %} selected {% endif %}>موريشيوس</option>
                      <option value="المكسيك" {% if user.nationality == "المكسيك" %} selected {% endif %}>المكسيك</option>
                      <option value="مايكرونيزيا" {% if user.nationality == "مايكرونيزيا" %} selected {% endif %}>مايكرونيزيا</option>
                      <option value="مولدوفا" {% if user.nationality == "مولدوفا" %} selected {% endif %}>مولدوفا</option>
                      <option value="موناكو" {% if user.nationality == "موناكو" %} selected {% endif %}>موناكو</option>
                      <option value="منغوليا" {% if user.nationality == "منغوليا" %} selected {% endif %}>منغوليا</option>
                      <option value="الجبل الأسود" {% if user.nationality == "الجبل الأسود" %} selected {% endif %}>الجبل الأسود</option>
                      <option value="المغرب" {% if user.nationality == "المغرب" %} selected {% endif %}>المغرب</option>
                      <option value="موزمبيق" {% if user.nationality == "موزمبيق" %} selected {% endif %}>موزمبيق</option>
                      <option value="بورما" {% if user.nationality == "بورما" %} selected {% endif %}>بورما</option>
                      <option value="ناميبيا" {% if user.nationality == "ناميبيا" %} selected {% endif %}>ناميبيا</option>
                      <option value="ناورو" {% if user.nationality == "ناورو" %} selected {% endif %}>ناورو</option>
                      <option value="نيبال" {% if user.nationality == "نيبال" %} selected {% endif %}>نيبال</option>
                      <option value="هولندا" {% if user.nationality == "هولندا" %} selected {% endif %}>هولندا</option>
                      <option value="نيوزيلندا" {% if user.nationality == "نيوزيلندا" %} selected {% endif %}>نيوزيلندا</option>
                      <option value="نيكاراجوا" {% if user.nationality == "نيكاراجوا" %} selected {% endif %}>نيكاراجوا</option>
                      <option value="النيجر" {% if user.nationality == "النيجر" %} selected {% endif %}>النيجر</option>
                      <option value="نيجيريا" {% if user.nationality == "نيجيريا" %} selected {% endif %}>نيجيريا</option>
                      <option value="كوريا الشمالية" {% if user.nationality == "كوريا الشمالية" %} selected {% endif %}>كوريا الشمالية</option>
                      <option value="النرويج" {% if user.nationality == "النرويج" %} selected {% endif %}>النرويج</option>
                      <option value="سلطنة عمان" {% if user.nationality == "سلطنة عمان" %} selected {% endif %}>سلطنة عمان</option>
                      <option value="باكستان" {% if user.nationality == "باكستان" %} selected {% endif %}>باكستان</option>
                      <option value="بالاو" {% if user.nationality == "بالاو" %} selected {% endif %}>بالاو</option>
                      <option value="بنما" {% if user.nationality == "بنما" %} selected {% endif %}>بنما</option>
                      <option value="بابوا غينيا الجديدة" {% if user.nationality == "بابوا غينيا الجديدة" %} selected {% endif %}>بابوا غينيا الجديدة</option>
                      <option value="باراغواي" {% if user.nationality == "باراغواي" %} selected {% endif %}>باراغواي</option>
                      <option value="بيرو" {% if user.nationality == "بيرو" %} selected {% endif %}>بيرو</option>
                      <option value="الفلبين" {% if user.nationality == "الفلبين" %} selected {% endif %}>الفلبين</option>
                      <option value="بولندا" {% if user.nationality == "بولندا" %} selected {% endif %}>بولندا</option>
                      <option value="البرتغال" {% if user.nationality == "البرتغال" %} selected {% endif %}>البرتغال</option>
                      <option value="قطر" {% if user.nationality == "قطر" %} selected {% endif %}>قطر</option>
                      <option value="جمهورية الكونغو" {% if user.nationality == "جمهورية الكونغو" %} selected {% endif %}>جمهورية الكونغو</option>
                      <option value="جمهورية مقدونيا" {% if user.nationality == "جمهورية مقدونيا" %} selected {% endif %}>جمهورية مقدونيا</option>
                      <option value="رومانيا" {% if user.nationality == "رومانيا" %} selected {% endif %}>رومانيا</option>
                      <option value="روسيا" {% if user.nationality == "روسيا" %} selected {% endif %}>روسيا</option>
                      <option value="رواندا" {% if user.nationality == "رواندا" %} selected {% endif %}>رواندا</option>
                      <option value="سانت كيتس ونيفيس" {% if user.nationality == "سانت كيتس ونيفيس" %} selected {% endif %}>سانت كيتس ونيفيس</option>
                      <option value="سانت لوسيا" {% if user.nationality == "سانت لوسيا" %} selected {% endif %}>سانت لوسيا</option>
                      <option value="سانت فنسينت والجرينادينز" {% if user.nationality == "سانت فنسينت والجرينادينز" %} selected {% endif %}>سانت فنسينت والجرينادينز</option>
                      <option value="ساموا" {% if user.nationality == "ساموا" %} selected {% endif %}>ساموا</option>
                      <option value="سان مارينو" {% if user.nationality == "سان مارينو" %} selected {% endif %}>سان مارينو</option>
                      <option value="ساو تومي وبرينسيب" {% if user.nationality == "ساو تومي وبرينسيب" %} selected {% endif %}>ساو تومي وبرينسيب</option>
                      <option value="السنغال" {% if user.nationality == "السنغال" %} selected {% endif %}>السنغال</option>
                      <option value="صربيا" {% if user.nationality == "صربيا" %} selected {% endif %}>صربيا</option>
                      <option value="سيشيل" {% if user.nationality == "سيشيل" %} selected {% endif %}>سيشيل</option>
                      <option value="سيراليون" {% if user.nationality == "سيراليون" %} selected {% endif %}>سيراليون</option>
                      <option value="سنغافورة" {% if user.nationality == "سنغافورة" %} selected {% endif %}>سنغافورة</option>
                      <option value="سلوفاكيا" {% if user.nationality == "سلوفاكيا" %} selected {% endif %}>سلوفاكيا</option>
                      <option value="سلوفينيا" {% if user.nationality == "سلوفينيا" %} selected {% endif %}>سلوفينيا</option>
                      <option value="جزر سليمان" {% if user.nationality == "جزر سليمان" %} selected {% endif %}>جزر سليمان</option>
                      <option value="الصومال" {% if user.nationality == "الصومال" %} selected {% endif %}>الصومال</option>
                      <option value="جنوب أفريقيا" {% if user.nationality == "جنوب أفريقيا" %} selected {% endif %}>جنوب أفريقيا</option>
                      <option value="كوريا الجنوبية" {% if user.nationality == "كوريا الجنوبية" %} selected {% endif %}>كوريا الجنوبية</option>
                      <option value="جنوب السودان" {% if user.nationality == "جنوب السودان" %} selected {% endif %}>جنوب السودان</option>
                      <option value="إسبانيا" {% if user.nationality == "إسبانيا" %} selected {% endif %}>إسبانيا</option>
                      <option value="سريلانكا" {% if user.nationality == "سريلانكا" %} selected {% endif %}>سريلانكا</option>
                      <option value="السودان" {% if user.nationality == "السودان" %} selected {% endif %}>السودان</option>
                      <option value="سورينام" {% if user.nationality == "سورينام" %} selected {% endif %}>سورينام</option>
                      <option value="سوازيلاند" {% if user.nationality == "سوازيلاند" %} selected {% endif %}>سوازيلاند</option>
                      <option value="السويد" {% if user.nationality == "السويد" %} selected {% endif %}>السويد</option>
                      <option value="سويسرا" {% if user.nationality == "سويسرا" %} selected {% endif %}>سويسرا</option>
                      <option value="سوريا" {% if user.nationality == "سوريا" %} selected {% endif %}>سوريا</option>
                      <option value="طاجيكستان" {% if user.nationality == "طاجيكستان" %} selected {% endif %}>طاجيكستان</option>
                      <option value="تنزانيا" {% if user.nationality == "تنزانيا" %} selected {% endif %}>تنزانيا</option>
                      <option value="تايلاند" {% if user.nationality == "تايلاند" %} selected {% endif %}>تايلاند</option>
                      <option value="توغو" {% if user.nationality == "توغو" %} selected {% endif %}>توغو</option>
                      <option value="تونجا" {% if user.nationality == "تونجا" %} selected {% endif %}>تونجا</option>
                      <option value="ترينيداد وتوباغو" {% if user.nationality == "ترينيداد وتوباغو" %} selected {% endif %}>ترينيداد وتوباغو</option>
                      <option value="تونس" {% if user.nationality == "تونس" %} selected {% endif %}>تونس</option>
                      <option value="تركيا" {% if user.nationality == "تركيا" %} selected {% endif %}>تركيا</option>
                      <option value="تركمانستان" {% if user.nationality == "تركمانستان" %} selected {% endif %}>تركمانستان</option>
                      <option value="توفالو" {% if user.nationality == "توفالو" %} selected {% endif %}>توفالو</option>
                      <option value="أوغندا" {% if user.nationality == "أوغندا" %} selected {% endif %}>أوغندا</option>
                      <option value="أوكرانيا" {% if user.nationality == "أوكرانيا" %} selected {% endif %}>أوكرانيا</option>
                      <option value="الإمارات العربية المتحدة" {% if user.nationality == "الإمارات العربية المتحدة" %} selected {% endif %}>الإمارات العربية المتحدة</option>
                      <option value="المملكة المتحدة" {% if user.nationality == "المملكة المتحدة" %} selected {% endif %}>المملكة المتحدة</option>
                      <option value="الولايات المتحدة" {% if user.nationality == "الولايات المتحدة" %} selected {% endif %}>الولايات المتحدة</option>
                      <option value="أوروغواي" {% if user.nationality == "أوروغواي" %} selected {% endif %}>أوروغواي</option>
                      <option value="أوزبكستان" {% if user.nationality == "أوزبكستان" %} selected {% endif %}>أوزبكستان</option>
                      <option value="فانواتو" {% if user.nationality == "فانواتو" %} selected {% endif %}>فانواتو</option>
                      <option value="فنزويلا" {% if user.nationality == "فنزويلا" %} selected {% endif %}>فنزويلا</option>
                      <option value="فيتنام" {% if user.nationality == "فيتنام" %} selected {% endif %}>فيتنام</option>
                      <option value="اليمن" {% if user.nationality == "اليمن" %} selected {% endif %}>اليمن</option>
                      <option value="زامبيا" {% if user.nationality == "زامبيا" %} selected {% endif %}>زامبيا</option>
                      <option value="زيمبابوي" {% if user.nationality == "زيمبابوي" %} selected {% endif %}>زيمبابوي</option>
                    </select>
                  </div>
                </div>

                <hr />

                <div class="row row-cols-md-2 row-cols-xl-3">
                  <div class="col-md-6 mb-4 form-group">
                    <label for="id_personalinfo_category" class="form-label"
                      >التصنيف الرئيسي<span style="color: red">*</span></label
                    >
                    <select
                      name="personalinfo_category"
                      class="form-select"
                      required
                      id="id_personalinfo_category"
                      onchange="categoryCheck(this);"
                    >
                      <option value selected>---------</option>
                      <option value="أسرة عادية">أسرة عادية</option>
                      <option value="أسرة أيتام">أسرة أيتام</option>
                      <option value="أسرة أرملة">أسرة أرملة</option>
                      <option value="أسرة سجناء">أسرة سجناء</option>
                      <option value="أسرة مطلقة">أسرة مطلقة</option>
                      <option value="فرد">فرد</option>
                    </select>
                  </div>
                  <div class="col-md-6 mb-4 form-group">
                    <label
                      for="id_personalinfo_marital_status"
                      class="form-label"
                      >الحالة الاجتماعية<span style="color: red">*</span></label
                    >
                    <select
                      name="personalinfo_marital_status"
                      class="form-select"
                      required
                      id="id_personalinfo_marital_status"
                      onchange="widowerCheck(this);"
                    >
                      <option value selected>---------</option>
                      <option value="متزوج/ـة">متزوج/ـة</option>
                      <option value="أعزب/ـة">أعزب/ـة</option>
                      <option value="أرمل/ـة">أرمل/ـة</option>
                      <option value="مطلقة">مطلقة</option>
                      <option value="مهجورة">مهجورة</option>
                    </select>
                  </div>
                  <div class="col-md-12 mb-4 form-group">
                    <label
                      for="id_personalinfo_educational_level"
                      class="form-label"
                      >المؤهل التعليمي<span style="color: red">*</span></label
                    >
                    <select
                      name="personalinfo_educational_level"
                      class="form-select"
                      id="id_personalinfo_educational_level"
                    >
                      <option value="" selected>---------</option>
                      <option value="أُمّيّ (لا يقرأ ولا يكتب)">أُمّيّ (لا يقرأ ولا يكتب)</option>
                      <option value="يقرأ ويكتب">يقرأ ويكتب</option>
                      <option value="أول ابتدائي">أول ابتدائي</option>
                      <option value="ثاني ابتدائي">ثاني ابتدائي</option>
                      <option value="ثالث ابتدائي">ثالث ابتدائي</option>
                      <option value="رابع ابتدائي">رابع ابتدائي</option>
                      <option value="خامس ابتدائي">خامس ابتدائي</option>
                      <option value="سادس ابتدائي">سادس ابتدائي</option>
                      <option value="أول متوسط">أول متوسط</option>
                      <option value="ثاني متوسط">ثاني متوسط</option>
                      <option value="ثالث متوسط">ثالث متوسط</option>
                      <option value="أول ثانوي">أول ثانوي</option>
                      <option value="ثاني ثانوي">ثاني ثانوي</option>
                      <option value="ثالث ثانوي">ثالث ثانوي</option>
                      <option value="جامعي">جامعي</option>
                    </select>
                  </div>
                </div>

                <hr />
                <div
                  class="row"
                  id="id_personalinfo_widower_group_info"
                  style="display: none !important"
                >
                  <div class="col-md-6 mb-4 form-group">
                    <label
                      for="id_personalinfo_date_of_death_of_father_or_husband"
                      class="form-label"
                      >تاريخ وفاة الأب \ الزوج<span style="color: red">*</span>
                      (عند اختيار أرمله)</label
                    >
                    <input
                      type="date"
                      name="personalinfo_date_of_death_of_father_or_husband"
                      class="form-control"
                      id="id_personalinfo_date_of_death_of_father_or_husband"
                    />
                  </div>
                  <div class="col-md-6 mb-4 form-group">
                    <label
                      for="id_personalinfo_washing_place"
                      class="form-label"
                      >المغسلة التي تم التجهيز فيها</label
                    >
                    <select
                      name="personalinfo_washing_place"
                      class="form-select"
                      id="id_personalinfo_washing_place"
                    >
                      <option value="" selected>---------</option>
                      <option value="إكرام فلسطين">إكرام فلسطين</option>
                      <option value="الثنيان">الثنيان</option>
                      <option value="العمودي">العمودي</option>
                      <option value="ابن القيم">ابن القيم</option>
                      <option value="الأمير منصور">الأمير منصور</option>
                      <option value="الملك فهد">الملك فهد</option>
                      <option value="الملك عبدالعزيز">الملك عبدالعزيز</option>
                      <option value="اللامي">اللامي</option>
                      <option value="طيبة">طيبة</option>
                      <option value="القريقري">القريقري</option>
                      <option value="شرق جدة">شرق جدة</option>
                      <option value="أخرى">أخرى</option>
                    </select>
                  </div>
                </div>

                <hr id="widower_hr" style="display: none"/>

                <div class="row">
                  <div class="col-md-6 mb-4 form-group">
                    <label
                      for="id_personalinfo_health_status"
                      class="form-label"
                      >الحالة الصحية<span style="color: red">*</span></label
                    >
                    <select
                      name="personalinfo_health_status"
                      class="form-select"
                      id="id_personalinfo_health_status"
                      onchange="toggleConditionalField(this, 'id_personalinfo_disease_type_group_info', 'غير جيدة');"
                    >
                      <option value="" selected>---------</option>
                      <option value="جيدة">جيدة</option>
                      <option value="غير جيدة">غير جيدة</option>
                    </select>
                  </div>
                  <div
                    class="col-md-6 mb-4 form-group"
                    id="id_personalinfo_disease_type_group_info"
                    style="display: none"
                  >
                    <label for="id_personalinfo_disease_type" class="form-label"
                      >نوع المرض<span style="color: red">*</span> (عند اختيار
                      غير جيدة)</label
                    >
                    <input
                      type="text"
                      name="personalinfo_disease_type"
                      maxlength="100"
                      class="form-control"
                      id="id_personalinfo_disease_type"
                    />
                  </div>
                </div>

                <hr />

                <div class="row">
                  <div class="col-md-6 mb-4 form-group">
                    <label for="id_personalinfo_work_status" class="form-label"
                      >هل تعمل؟<span style="color: red">*</span></label
                    >
                    <select
                      name="personalinfo_work_status"
                      class="form-select"
                      required
                      id="id_personalinfo_work_status"
                      onchange="toggleConditionalField(this, 'id_personalinfo_employer_group_info');"
                    >
                      <option value="" selected>---------</option>
                      <option value="نعم">نعم</option>
                      <option value="لا">لا</option>
                    </select>
                  </div>
                  <div
                    class="col-md-6 mb-4 form-group"
                    id="id_personalinfo_employer_group_info"
                    style="display: none"
                  >
                    <label for="id_personalinfo_employer" class="form-label"
                      >جهة العمل<span style="color: red">*</span> (عند اختيار
                      نعم)</label
                    >
                    <input
                      type="text"
                      name="personalinfo_employer"
                      maxlength="100"
                      class="form-control"
                      id="id_personalinfo_employer"
                    />
                  </div>
                </div>

                <hr />

                <div class="row">
                  <div class="col mb-3 form-group">
                    <label for="id_personalinfo_phone_number" class="form-label"
                      >رقم الجوال<span style="color: red">*</span></label
                    >
                    <div class="input-group mb-1">
                      <input
                        type="text"
                        name="personalinfo_phone_number"
                        data-bs-title="رقم الجوال" 
                        class="form-control convert-to-english"
                        id="id_personalinfo_phone_number"
                        placeholder="5XXXXXXXX"
                        value="{{ user.phonenumber }}"
                        disabled
                        readonly
                      />
                      <span class="input-group-text" id="basic-addon1">966+</span>
                    </div>
                    <div class="form-text" id="basic-addon4">يبدا رقم الجوال بدون الصفر, مثال (512345678)</div>
                  </div>
                  <div class="col-md-6 mb-4 form-group">
                    <label for="id_personalinfo_email" class="form-label">البريد الالكتروني<span style="color: red">*</span></label>
                    <input
                      type="email"
                      name="personalinfo_email"
                      maxlength="254"
                      class="form-control"
                      id="id_personalinfo_email"
                      value="{{ user.email }}"
                      required
                      disabled readonly
                    />
                  </div>
                </div>

                <!-- Hidden Fields Container (Organized in one place) -->
                <div class="d-none">
                  <!-- Date of Birth Hidden Field -->
                  <input
                    type="hidden"
                    name="personalinfo_date_of_birth"
                    id="hidden_personalinfo_date_of_birth"
                    value="{{ user.date_of_birth|date:'Y-m-d' }}"
                  />

                  <!-- Gender Hidden Field -->
                  <input
                    type="hidden"
                    name="personalinfo_gender"
                    value="{{ user.gender }}"
                  />

                  <!-- National ID Hidden Field -->
                  <input
                    type="hidden"
                    name="personalinfo_national_id"
                    id="hidden_personalinfo_national_id"
                    value="{{ user.national_id }}"
                  />

                  <!-- Nationality Hidden Field -->
                  <input
                    type="hidden"
                    name="personalinfo_nationality"
                    id="hidden_personalinfo_nationality"
                    value="{{ user.nationality }}"
                  />

                  <!-- Email Hidden Field -->
                  <input
                    type="hidden"
                    name="personalinfo_email"
                    id="hidden_personalinfo_email"
                    value="{{ user.email }}"
                  />
                </div>
                
              </div>
            </div>
          </div>
          <div class="form-group">
            <div class="col-lg-8 col-lg-offset-4">
              <div class="checkbox form-check">
                <label class="form-check-label fs-6" for="skip-step"
                  >هل لديك أبناء/مرافقين ترغب بإضافتهم كمستفيدين؟</label
                >
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="skip-step"
                  name="addDependent"
                />
                <p class="text-muted" style="font-size: 0.8rem">
                  في حال الاختيار سوف تظهر نافذة المرافقين
                </p>
              </div>
            </div>
          </div>
          <div class="mt-3">
            <button
              class="button btn-navigate-form-step next"
              type="button"
              step_number="2"
            >
              التالي
            </button>
          </div>
        </fieldset>
        <!-- Step 2 Content, default hidden on page load. -->
        <fieldset id="dependent_information" class="form-step px-3 px-lg-5">
          <h2 class="fs-2 fw-bold mb-5">بيانات المرافقين</h2>
          <!-- Step 2 input fields -->
          <div class="mt-3">
            <div id="family-form">
              <div class="row row-cols-md-2 row-cols-xl-4">

                <div class="col-md-6 mb-4 form-group">
                  <label for="id_dependent_info_first_name" class="form-label"
                    >الأسم الأول<span style="color: red">*</span
                    ></label
                  >
                  <input
                    type="text"
                    id="id_dependent_info_first_name"
                    class="form-control"
                    name="dependent_info_first_name"
                  />
                </div>
                <div class="col-md-6 mb-4 form-group">
                  <label for="id_dependent_info_second_name" class="form-label"
                    >الأسم الثاني<span style="color: red">*</span
                    ></label
                  >
                  <input
                    type="text"
                    id="id_dependent_info_second_name"
                    class="form-control"
                    name="dependent_info_second_name"
                  />
                </div>
                <div class="col-md-6 mb-4 form-group">
                  <label for="id_dependent_info_last_name" class="form-label"
                    >الأسم الأخير<span style="color: red">*</span
                    ><span style="font-size: 0.9rem">
                      (أسم العائلة)</span
                    ></label
                  >
                  <input
                    type="text"
                    id="id_dependent_info_last_name"
                    class="form-control"
                    name="dependent_info_last_name"
                  />
                </div>
                <div class="col-md-6 mb-4 form-group">
                  <label
                    for="id_dependent_info_date_of_birth"
                    class="form-label"
                    >تاريخ الميلاد<span style="color: red">*</span></label
                  >
                  <input
                    type="date"
                    class="form-control"
                    id="id_dependent_info_date_of_birth"
                    maxlength="55"
                    name="dependent_info_date_of_birth"
                  />
                </div>
              </div>

              <hr>

              <div class="row row-cols-md-2 row-cols-xl-3">
                <div class="col-md-6 mb-4 form-group">
                  <label for="id_dependent_info_gender" class="form-label"
                    >الجنس<span style="color: red">*</span></label
                  >
                  <select
                    name="dependent_info_gender"
                    class="form-select"
                    id="id_dependent_info_gender"
                  >
                    <option value selected>---------</option>
                    <option value="ذكر">ذكر</option>
                    <option value="انثى">انثى</option>
                  </select>
                </div>
                <div class="col-md-6 mb-4 form-group">
                  <label for="id_dependent_info_relationship" class="form-label"
                    >صلة القرابة<span style="color: red">*</span></label
                  >
                  <select
                    name="dependent_info_relationship"
                    class="form-select"
                    id="id_dependent_info_relationship"
                  >
                    <option value selected>---------</option>
                    <option value="ابن">ابن</option>
                    <option value="ابنة">ابنة</option>
                    <option value="أخ">أخ</option>
                    <option value="أخت">أخت</option>
                    <option value="زوج/ـة">زوج/ـة</option>
                    <option value="خال/ـة">خال/ـة</option>
                    <option value="عم/ـة">عم/ـة</option>
                    <option value="جد/ـة">جد/ـة</option>
                  </select>
                </div>
                <div class="col-md-12 mb-4 form-group">
                  <label
                    for="id_dependent_info_marital_status"
                    class="form-label"
                    >الحالة الاجتماعية<span style="color: red">*</span></label
                  >
                  <select
                    name="dependent_info_marital_status"
                    class="form-select"
                    id="id_dependent_info_marital_status"
                  >
                    <option value selected>---------</option>
                    <option value="طفل/ـة">طفل/ـة</option>
                    <option value="ربة منزل">ربة منزل</option>
                    <option value="متزوج/ـة">متزوج/ـة</option>
                    <option value="أعزب/ـة">أعزب/ـة</option>
                    <option value="أرملة/ـة">أرمل/ـة</option>
                    <option value="مطلقة">مطلقة</option>
                    <option value="مهجورة">مهجورة</option>
                  </select>
                </div>
              </div>

              <hr />

              <div class="row row-cols-md-2">
                <div class="col-md-6 mb-4 form-group">
                  <label
                    for="id_dependent_info_educational_status"
                    class="form-label"
                    >الحالة الدراسية<span style="color: red">*</span></label
                  >
                  <select
                    name="dependent_info_educational_status"
                    class="form-select"
                    id="id_dependent_info_educational_status"
                    onchange="educationalStatusCheck(this);"
                  >
                    <option value selected>---------</option>
                    <option value="يدرس">يدرس</option>
                    <option value="لا يدرس">لا يدرس</option>
                  </select>
                </div>
                <div class="col-md-6 mb-4 form-group" style="display: none;" id="id_dependent_info_educational_level_group_info">
                  <label
                    for="id_dependent_info_educational_level"
                    class="form-label"
                    >المرحلة الدراسية<span style="color: red">*</span></label
                  >
                  <select
                    name="dependent_info_educational_level"
                    class="form-select"
                    id="id_dependent_info_educational_level"
                  >
                    <option value selected>---------</option>
                    <option value="أول ابتدائي">أول ابتدائي</option>
                    <option value="ثاني ابتدائي">ثاني ابتدائي</option>
                    <option value="ثالث ابتدائي">ثالث ابتدائي</option>
                    <option value="رابع ابتدائي">رابع ابتدائي</option>
                    <option value="خامس ابتدائي">خامس ابتدائي</option>
                    <option value="سادس ابتدائي">سادس ابتدائي</option>
                    <option value="اول متوسط">اول متوسط</option>
                    <option value="ثاني متوسط">ثاني متوسط</option>
                    <option value="ثالث متوسط">ثالث متوسط</option>
                    <option value="اول ثانوي">اول ثانوي</option>
                    <option value="ثاني ثانوي">ثاني ثانوي</option>
                    <option value="ثالث ثانوي">ثالث ثانوي</option>
                    <option value="جامعي">جامعي</option>
                  </select>
                </div>
                <div class="col-md-6 mb-4 form-group" style="display: none;" id="id_dependent_info_educational_degree_group_info">
                  <label
                    for="id_dependent_info_educational_degree"
                    class="form-label"
                    >المؤهل التعليمي<span style="color: red">*</span></label
                  >
                  <select
                    name="dependent_info_educational_degree"
                    class="form-select"
                    id="id_dependent_info_educational_degree"
                  >
                    <option value selected>---------</option>
                    <option value="أُمّيّ (لا يقرأ ولا يكتب)">أُمّيّ (لا يقرأ ولا يكتب)</option>
                    <option value="يقرأ ويكتب">يقرأ ويكتب</option>
                    <option value="ابتدائي">ابتدائي</option>
                    <option value="متوسط">متوسط</option>
                    <option value="ثانوي">ثانوي</option>
                    <option value="جامعي">جامعي</option>
                  </select>
                </div>
              </div>

              <hr />

              <div class="row">
                <div class="col-md-6 mb-4 form-group">
                  <label for="id_dependent_info_national_id" class="form-label"
                    >رقم الهوية الوطنية \ الإقامة<span style="color: red">*</span></label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="id_dependent_info_national_id"
                    maxlength="20"
                    name="dependent_info_national_id"
                  />
                </div>
                <div class="col-md-6 mb-4 form-group">
                  <label
                    for="id_dependent_info_national_id_exp_date"
                    class="form-label"
                    >تاريخ انتهاء الهوية \ الإقامة</label
                  >
                  <input
                    type="date"
                    class="form-control"
                    id="id_dependent_info_national_id_exp_date"
                    name="dependent_info_national_id_exp_date"
                  />
                </div>
              </div>

              <hr/>

              <div class="row">
                <div class="col-md-6 mb-4 form-group">
                  <label for="id_dependent_info_work_status" class="form-label"
                    >هل تعمل؟<span style="color: red">*</span></label
                  >
                  <select
                    name="dependent_info_work_status"
                    class="form-select"
                    required
                    id="id_dependent_info_work_status"
                    onchange="toggleConditionalField(this, 'id_dependent_info_employer_group_info');"
                  >
                    <option value="" selected>---------</option>
                    <option value="نعم">نعم</option>
                    <option value="لا">لا</option>
                  </select>
                </div>
                <div
                  class="col-md-6 mb-4 form-group"
                  id="id_dependent_info_employer_group_info"
                  style="display: none"
                >
                  <label for="id_dependent_info_employer" class="form-label"
                    >جهة العمل<span style="color: red">*</span> (عند اختيار
                    نعم)</label
                  >
                  <input
                    type="text"
                    name="dependent_info_employer"
                    maxlength="100"
                    class="form-control"
                    id="id_dependent_info_employer"
                  />
                </div>
              </div>

              <hr/>

              <h4 class="mb-4">مصادر الدخل</h4>
              <div class="row justify-content-center">
                <div class="col-md-4 mb-2 form-group">
                  <label for="id_dependent_info_monthly_income" class="form-label">دخل المرافق (شهريا)</label>
                  <div class="input-group mb-3">
                    <input type="number" name="dependent_info_monthly_income" max="9999999999999999" min="0" class="form-control" id="id_dependent_info_monthly_income" />
                    <span class="input-group-text" id="basic-addon1">ر.س.</span>
                  </div>
                </div>
                <div class="col-md-4 col-lg-5 mb-2 form-group">
                  <label for="id_dependent_info_income_source" class="form-label">مصدر الدخل</label>
                  <select name="dependent_info_income_source" class="form-select" id="id_dependent_info_income_source">
                    <option value selected>---------</option>
                    <option value="الراتب">الراتب</option>
                    <option value="التأمينات الاجتماعية">التأمينات الاجتماعية</option>
                    <option value="الضمان الاجتماعي">الضمان الاجتماعي</option>
                    <option value="مصلحة التقاعد">مصلحة التقاعد</option>
                    <option value="حساب المواطن">حساب المواطن</option>
                    <option value="التأهيل الشامل">التأهيل الشامل</option>
                    <option value="جمعية خيرية">جمعية خيرية</option>
                    <option value="فاعل خير">فاعل خير</option>
                    <option value="اخرى">اخرى</option>
                  </select>
                </div>
                <div class="col-md-4 col-lg-3 mb-sm-5 mb-md-3 mb-3 mt-4 row justify-content-center align-items-center" id="id_add_row_income_table">
                  <button type="button" class="btn btn-primary" onclick="addRowToIncomeInfoTable()">إضافة مصدر الدخل</button>
                </div>
              </div>
              
              {% comment %} Dependent Income Table {% endcomment %}
              <div>
                <table class="table table-striped table-hover mb-5" id="incomeInfoTable">
                  <thead>
                    <tr>
                      <th scope="col">دخل المرافق الشهري (ر.س.)</th>
                      <th scope="col">مصدر الدخل للمرافق</th>
                      <th scope="col">الإجراءات</th>
                    </tr>
                  </thead>
                  <tbody id="incomeInfoTableBody"></tbody>
                </table>
              </div>

              <hr />

              <div class="row">
                <div class="col-md-6 mb-4 form-group">
                  <label for="id_dependent_info_contribute_to_family_income" class="form-label"
                    >هل يساهم المرافق في دخل الأسرة؟<span style="color: red">*</span></label
                  >
                  <select
                    name="dependent_info_contribute_to_family_income"
                    class="form-select"
                    required
                    id="id_dependent_info_contribute_to_family_income"
                  >
                    <option value="" selected>---------</option>
                    <option value="نعم">نعم</option>
                    <option value="لا">لا</option>
                  </select>
                </div>
              </div>

              <hr/>

              <div class="row">
                <div class="col-md-6 mb-4 form-group">
                  <label for="id_dependent_info_bank_iban" class="form-label"
                    >الحساب البنكي للمرافق
                    (IBAN)</label
                  >
                  <input
                    type="text"
                    name="dependent_info_bank_iban"
                    maxlength="50"
                    class="form-control"
                    id="id_dependent_info_bank_iban"
                    placeholder=""
                  />
                </div>
                <div class="col-md-6 mb-4 form-group">
                  <label for="id_dependent_info_bank_type" class="form-label"
                    >البنك</label
                  >
                  <select
                    name="dependent_info_bank_type"
                    class="form-select"
                    id="id_dependent_info_bank_type"
                  >
                    <option value selected>---------</option>
                    <option value="الأهلي السعودي">الأهلي السعودي</option>
                    <option value="الراجحي">الراجحي</option>
                    <option value="الجزيرة">الجزيرة</option>
                    <option value="الإنماء">الإنماء</option>
                    <option value="البلاد">البلاد</option>
                    <option value="الرياض">الرياض</option>
                    <option value="ساب">ساب</option>
                    <option value="السعودي الفرنسي">السعودي الفرنسي</option>
                    <option value="العربي">العربي</option>
                    <option value="مسقط">مسقط</option>
                    <option value="الإمارات دبي الوطني">الإمارات دبي الوطني</option>
                    <option value="الخليج الدولي">الخليج الدولي</option>
                    <option value="البحرين الوطني">البحرين الوطني</option>
                    <option value="الكويت الوطني">الكويت الوطني</option>
                    <option value="باكستان الوطني">باكستان الوطني</option>
                    <option value="الأول">الأول</option>
                    <option value="السعودي للاستثمار">السعودي للاستثمار</option>
                    <option value="زراعات">زراعات</option>
                    <option value="أخرى">أخرى</option>
                  </select>
                </div>
              </div>

              <hr/>

              <div class="row">
                <div class="col-md-6 mb-4 form-group">
                  <label
                    for="id_dependent_info_health_status"
                    class="form-label"
                    >الحالة الصحية<span style="color: red">*</span></label
                  >
                  <select
                    name="dependent_info_health_status"
                    class="form-select"
                    id="id_dependent_info_health_status"
                    onchange="toggleConditionalField(this, 'id_dependentinfo_disease_type_group_info', 'غير جيدة');"
                  >
                    <option value selected>---------</option>
                    <option value="جيدة">جيدة</option>
                    <option value="غير جيدة">غير جيدة</option>
                  </select>
                </div>
                <div
                  class="col-md-6 mb-4 form-group"
                  id="id_dependentinfo_disease_type_group_info"
                  style="display: none"
                >
                  <label for="id_dependent_info_disease_type" class="form-label"
                    >نوع المرض<span style="color: red">*</span> (عند اختيار غير
                    جيدة)</label
                  >
                  <input
                    type="text"
                    name="dependent_info_disease_type"
                    maxlength="100"
                    class="form-control"
                    id="id_dependent_info_disease_type"
                  />
                </div>
              </div>

              <hr />

              <div class="row">
                <div class="col-md-6 mb-4 form-group">
                  <label
                    for="id_dependent_info_is_disabled"
                    class="form-label"
                    >هل المرافق من ذوي الاعاقة؟<span style="color: red">*</span></label
                  >
                  <select
                    name="dependent_info_is_disabled"
                    class="form-select"
                    id="id_dependent_info_is_disabled"
                    onchange="toggleConditionalField(this, 'id_dependentinfo_disability_type_group_info');"
                  >
                    <option value selected>---------</option>
                    <option value="نعم">نعم</option>
                    <option value="لا">لا</option>
                  </select>
                </div>
                <div
                  class="col-md-6 mb-4 form-group"
                  id="id_dependentinfo_disability_type_group_info"
                  style="display: none"
                >
                  <label for="id_dependent_info_disability_type" class="form-label"
                    >نوع الإعاقة<span style="color: red">*</span></label
                  >
                  <select
                    name="dependent_info_disability_type"
                    class="form-select"
                    id="id_dependent_info_disability_type"
                  >
                    <option value selected>---------</option>
                    <option value="حركية">حركية</option>
                    <option value="سمعية">سمعية</option>
                    <option value="بصرية">بصرية</option>
                    <option value="عقلية">عقلية</option>
                  </select>
                </div>
              </div>

              <hr />

              <div class="row">
                <div class="col-md-12 mb-4 form-group">
                  <label class="form-label"
                    >نوع الاحتياج للمرافق<span style="color: red"
                      >*</span
                    > <span style="font-size: 0.9rem">
                      (إختيار متعدد)</span
                    ></label
                  >
                  <div
                    name="dependent_info_needs_type"
                    class="d-grid gap-2"
                    style="grid-template-columns: 1fr 1fr 1fr;"
                    id="id_dependent_info_needs_type"
                  >
                    <input type="checkbox" class="btn-check" id="id_dependent_info_needs_type_economical" autocomplete="off" name="dependent_info_needs_type_economical" value="اقتصادي">
                    <label class="btn btn-outline-primary" for="id_dependent_info_needs_type_economical">اقتصادي</label>

                    <input type="checkbox" class="btn-check" id="id_dependent_info_needs_type_educational" autocomplete="off" name="dependent_info_needs_type_educational" value="تعليمي">
                    <label class="btn btn-outline-primary" for="id_dependent_info_needs_type_educational">تعليمي</label>

                    <input type="checkbox" class="btn-check" id="id_dependent_info_needs_type_employment" autocomplete="off" name="dependent_info_needs_type_employment" value="توظيف">
                    <label class="btn btn-outline-primary" for="id_dependent_info_needs_type_employment">توظيف</label>

                    <input type="checkbox" class="btn-check" id="id_dependent_info_needs_type_sponsorship" autocomplete="off" name="dependent_info_needs_type_sponsorship" value="كفالة">
                    <label class="btn btn-outline-primary" for="id_dependent_info_needs_type_sponsorship">كفالة</label>

                    <input type="checkbox" class="btn-check" id="id_dependent_info_needs_type_healthy" autocomplete="off" name="dependent_info_needs_type_healthy" value="صحي">
                    <label class="btn btn-outline-primary" for="id_dependent_info_needs_type_healthy">صحي</label>
                  </div>
                </div>
                <div class="col-md-12 mb-4 form-group">
                  <label for="id_dependent_info_needs_description" class="form-label">وصف الاحتياج</label>
                  <textarea type="textarea" class="form-control form-control-lg" id="id_dependent_info_needs_description" rows="5" name="dependentinfo_needs_description" maxlength="2000"></textarea>
                </div>
              </div>

              <button
                id="addChildButton"
                type="button"
                class="btn addChildBtn btn-success mb-4 mt-3 px-4 py-3"
              >
                إضافة مرافق
              </button>

              <hr class="mb-4">

              <h3 class="mb-3">المرافقين</h3>
              <div class="table-responsive-xl">
                <table
                  id="family-table"
                  class="table table-striped table-hover"
                  style="overflow-x: scroll"
                >
                  <thead>
                    <tr>
                      <th scope="col">الأسم الأول</th>
                      <th scope="col" class="d-none">الأسم الثاني</th>
                      <th scope="col" class="d-none">الأسم الأخير</th>
                      <th scope="col">الجنس</th>
                      <th scope="col">صلة القرابة</th>
                      <th scope="col">الحالة الدراسية</th>
                      <th scope="col">الحالة الاجتماعية</th>
                      <th scope="col">رقم الهوية</th>
                      <th scope="col">الحالة الصحية</th>
                      <th scope="col" class="d-none">دخل المرافق (شهريا)</th>
                      <th scope="col" class="d-none">مصدر الدخل</th>
                      <th scope="col" class="d-none">نوع الاحتياج</th>
                      <th scope="col" class="d-none">المؤهل التعليمي</th>
                      <th scope="col" class="d-none">تاريخ الميلاد</th>
                      <th scope="col" class="d-none">الحساب البنكي للمرافق (IBAN)</th>
                      <th scope="col" class="d-none">نوع البنك</th>
                      <th scope="col" class="d-none">
                        تاريح انتهاء الهوية/الإقامة
                      </th>
                      <th scope="col" class="d-none">وصف الاحتياج</th>
                      <th scope="col" class="text-center">خيارات</th>
                    </tr>
                  </thead>
                  <tbody>
                    <!-- Child rows will be added here -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>
          <div class="mt-5 d-flex column-gap-2 d-lg-block">
            <button
              class="col button btn-navigate-form-step previous"
              type="button"
              step_number="1"
            >
              السابق
            </button>
            <button
              class="col button btn-navigate-form-step nextDependent"
              type="button"
              step_number="3"
            >
              التالي
            </button>
          </div>
        </fieldset>
        <!-- Step 3 Content, default hidden on page load. -->
        <fieldset
          id="housing_income_need_information"
          class="form-step px-3 px-lg-5"
        >
          <h2 class="fs-2 fw-bold mb-5">بيانات السكن والدخل والاحتياج</h2>

          <!-- Step 3 input fields -->
          <div class="mt-5">
            <h4 class="font-normal">بيانات العنوان الوطني</h4>
            <div class="row row-cols-md-2 row-cols-xl-4 mt-4">
              <div class="col-md-6 mb-4 form-group">
                <label for="id_houseinfo_building_number" class="form-label"
                  >رقم المبنى<span style="color: red"
                  >*</span
                ></label
                >
                <input
                  type="number"
                  name="houseinfo_building_number"
                  min="0"
                  max="9999999"
                  class="form-control"
                  id="id_houseinfo_building_number"
                />
              </div>
              <div class="col-md-6 mb-4 form-group">
                <label for="id_houseinfo_street_name" class="form-label"
                  >اسم الشارع<span style="color: red"
                  >*</span
                ></label
                >
                <input
                  type="text"
                  name="houseinfo_street_name"
                  maxlength="50"
                  class="form-control"
                  id="id_houseinfo_street_name"
                />
              </div>
              <div class="col-md-6 mb-4 form-group">
                <label for="id_houseinfo_neighborhood" class="form-label"
                  >الحي<span style="color: red"
                  >*</span
                ></label
                >
                <input
                  type="text"
                  name="houseinfo_neighborhood"
                  maxlength="50"
                  class="form-control"
                  id="id_houseinfo_neighborhood"
                />
              </div>
              <div class="col-md-6 mb-4 form-group">
                <label for="id_houseinfo_city" class="form-label"
                  >المدينة<span style="color: red"
                  >*</span
                ></label
                >
                <input
                  type="text"
                  name="houseinfo_city"
                  maxlength="50"
                  class="form-control"
                  id="id_houseinfo_city"
                />
              </div>
            </div>
            <div class="row row-cols-md-2 row-cols-xl-4 mt-4">
              <div class="col-md-6 mb-4 form-group">
                <label for="id_houseinfo_postal_code" class="form-label"
                  >الرمز البريدي<span style="color: red"
                  >*</span
                ></label
                >
                <input
                  type="number"
                  name="houseinfo_postal_code"
                  min="0"
                  max="9999999"
                  class="form-control"
                  id="id_houseinfo_postal_code"
                />
              </div>
              <div class="col-md-6 mb-4 form-group">
                <label for="id_houseinfo_additional_number" class="form-label"
                  >الرقم الإضافي<span style="color: red"
                  >*</span
                ></label
                >
                <input
                  type="number"
                  name="houseinfo_additional_number"
                  min="0"
                  max="9999999"
                  class="form-control"
                  id="id_houseinfo_additional_number"
                />
              </div>
              <div class="col-md-6 mb-4 form-group">
                <label for="id_houseinfo_unit" class="form-label">الوحدة<span style="color: red"
                  >*</span
                ></label>
                <input
                  type="text"
                  name="houseinfo_unit"
                  maxlength="50"
                  class="form-control"
                  id="id_houseinfo_unit"
                />
              </div>
              <div class="col-md-6 mb-4 form-group">
                <label for="id_houseinfo_location_url" class="form-label"
                  >رابط موقع المنزل (google maps)<span style="color: red"
                  >*</span
                ></label
                >
                <input
                  type="url"
                  name="houseinfo_location_url"
                  maxlength="250"
                  class="form-control"
                  id="id_houseinfo_location_url"
                />
              </div>
            </div>
            <div class="row">
              <div class="col-md-6 mb-4 form-group">
                <label for="id_houseinfo_housing_type" class="form-label"
                  >نوع السكن<span style="color: red">*</span></label
                >
                <select
                  name="houseinfo_housing_type"
                  class="form-select"
                  id="id_houseinfo_housing_type"
                >
                  <option value selected>---------</option>
                  <option value="شعبي">شعبي</option>
                  <option value="شقة">شقة</option>
                  <option value="فيلا">فيلا</option>
                  <option value="ملحق">ملحق</option>
                </select>
              </div>
              <div class="col-md-6 mb-4 form-group">
                <label for="id_houseinfo_housing_ownership" class="form-label"
                  >ملكية السكن<span style="color: red">*</span></label
                >
                <select
                  name="houseinfo_housing_ownership"
                  class="form-select"
                  id="id_houseinfo_housing_ownership"
                >
                  <option value selected>---------</option>
                  <option value="ملك">ملك</option>
                  <option value="وقف">وقف</option>
                  <option value="إيجار">إيجار</option>
                  <option value="سكن تنموي (منتهي بالتمليك)">سكن تنموي (منتهي بالتمليك)</option>
                </select>
              </div>
            </div>

            <hr />

            <h4 class="font-normal">مصادر دخل رب الأسرة (المعيل - شهريًا)</h4>
            <div
              class="alert alert-warning mt-3"
              role="alert"
              id="checkboxError"
            >
              الرجاء إدخال مصادر الدخل ادناه, وفي حال عدم وجود الدخل المسمى,
              يرجى ادخال قيمة صفر (0)
            </div>
            <div class="row row-cols-md-2 row-cols-xl-4 mt-4">
              <div class="col-md-6 mb-4 form-group">
                <label for="id_incomeinfo_salary" class="form-label"
                  >الراتب<span style="color: red">*</span></label
                >
                <div class="input-group mb-3">
                  <input
                    type="number"
                    name="incomeinfo_salary"
                    min="0.00"
                    max="99999999.00"
                    class="form-control"
                    id="id_incomeinfo_salary"
                  />
                  <span class="input-group-text" id="basic-addon1">ر.س.</span>
                </div>
              </div>
              <div class="col-md-6 mb-4 form-group">
                <label for="id_incomeinfo_social_insurance" class="form-label"
                  >التأمينات الاجتماعية<span style="color: red">*</span></label
                >
                <div class="input-group mb-3">
                  <input
                    type="number"
                    name="incomeinfo_social_insurance"
                    min="0.00"
                    max="99999999.00"
                    class="form-control"
                    id="id_incomeinfo_social_insurance"
                  />
                  <span class="input-group-text" id="basic-addon1">ر.س.</span>
                </div>
              </div>
              <div class="col-md-6 mb-4 form-group">
                <label for="id_incomeinfo_charity" class="form-label"
                  >جمعيات خيرية<span style="color: red">*</span></label
                >
                <div class="input-group mb-3">
                  <input
                    type="number"
                    name="incomeinfo_charity"
                    min="0.00"
                    max="99999999.00"
                    class="form-control"
                    id="id_incomeinfo_charity"
                  />
                  <span class="input-group-text" id="basic-addon1">ر.س.</span>
                </div>
              </div>
              <div class="col-md-6 mb-4 form-group">
                <label for="id_incomeinfo_social_warranty" class="form-label"
                  >الضمان الاجتماعي<span style="color: red">*</span></label
                >
                <div class="input-group mb-3">
                  <input
                    type="number"
                    name="incomeinfo_social_warranty"
                    min="0.00"
                    max="99999999.00"
                    class="form-control"
                    id="id_incomeinfo_social_warranty"
                  />
                  <span class="input-group-text" id="basic-addon1">ر.س.</span>
                </div>
              </div>
            </div>
            <div class="row row-cols-md-2 row-cols-xl-4">
              <div class="col-md-6 mb-4 form-group">
                <label for="id_incomeinfo_pension_agency" class="form-label"
                  >مصلحة التقاعد<span style="color: red">*</span></label
                >
                <div class="input-group mb-3">
                  <input
                    type="number"
                    name="incomeinfo_pension_agency"
                    min="0.00"
                    max="99999999.00"
                    class="form-control"
                    id="id_incomeinfo_pension_agency"
                  />
                  <span class="input-group-text" id="basic-addon1">ر.س.</span>
                </div>
              </div>
              <div class="col-md-6 mb-4 form-group">
                <label for="id_incomeinfo_citizen_account" class="form-label"
                  >حساب المواطن<span style="color: red">*</span></label
                >
                <div class="input-group mb-3">
                  <input
                    type="number"
                    name="incomeinfo_citizen_account"
                    min="0.00"
                    max="99999999.00"
                    class="form-control"
                    id="id_incomeinfo_citizen_account"
                  />
                  <span class="input-group-text" id="basic-addon1">ر.س.</span>
                </div>
              </div>
              <div class="col-md-6 mb-4 form-group">
                <label for="id_incomeinfo_benefactor" class="form-label"
                  >فاعل خير<span style="color: red"
                  >*</span
                ></label
                >
                <div class="input-group mb-3">
                  <input
                    type="number"
                    name="incomeinfo_benefactor"
                    min="0.00"
                    max="99999999.00"
                    class="form-control"
                    id="id_incomeinfo_benefactor"
                  />
                  <span class="input-group-text" id="basic-addon1">ر.س.</span>
                </div>
              </div>
              <div class="col-md-6 mb-4 form-group">
                <label for="id_incomeinfo_other" class="form-label">أخرى<span style="color: red"
                  >*</span
                ></label>
                <div class="input-group mb-3">
                  <input
                    type="number"
                    name="incomeinfo_other"
                    min="0.00"
                    max="99999999.00"
                    class="form-control"
                    id="id_incomeinfo_other"
                  />
                  <span class="input-group-text" id="basic-addon1">ر.س.</span>
                </div>
              </div>
            </div>

            <hr />

            <h4 class="font-normal">مصروفات الأسرة (شهريًا)</h4>
            <div
              class="alert alert-warning mt-3"
              role="alert"
              id="checkboxError"
            >
              الرجاء ادخال مصروفات الأسرة ادناه, وفي حال عدم وجود الدخل المسمى, يرجى ادخال قيمة صفر (0)
            </div>
            <div class="row row-cols-md-2 row-cols-xl-4 mt-4">
              <div class="col-md-6 mb-4 form-group">
                <label for="id_expensesinfo_housing_rent" class="form-label"
                  >إيجار السكن<span style="color: red">*</span></label
                >
                <div class="input-group mb-3">
                  <input
                    type="number"
                    name="expensesinfo_housing_rent"
                    min="0.00"
                    max="99999999.00"
                    class="form-control"
                    id="id_expensesinfo_housing_rent"
                  />
                  <span class="input-group-text" id="basic-addon1">ر.س.</span>
                </div>
              </div>
              <div class="col-md-6 mb-4 form-group">
                <label
                  for="id_expensesinfo_electricity_bills"
                  class="form-label"
                  >فواتير كهرباء<span style="color: red">*</span></label
                >
                <div class="input-group mb-3">
                  <input
                    type="number"
                    name="expensesinfo_electricity_bills"
                    min="0.00"
                    max="99999999.00"
                    class="form-control"
                    id="id_expensesinfo_electricity_bills"
                  />
                  <span class="input-group-text" id="basic-addon1">ر.س.</span>
                </div>
              </div>
              <div class="col-md-6 mb-4 form-group">
                <label for="id_expensesinfo_water_bills" class="form-label"
                  >فواتير ماء<span style="color: red">*</span></label
                >
                <div class="input-group mb-3">
                  <input
                    type="number"
                    name="expensesinfo_water_bills"
                    min="0.00"
                    max="99999999.00"
                    class="form-control"
                    id="id_expensesinfo_water_bills"
                  />
                  <span class="input-group-text" id="basic-addon1">ر.س.</span>
                </div>
              </div>
              <div class="col-md-6 mb-4 form-group">
                <label for="id_expensesinfo_transportation" class="form-label"
                  >مواصلات<span style="color: red">*</span></label
                >
                <div class="input-group mb-3">
                  <input
                    type="number"
                    name="expensesinfo_transportation"
                    min="0.00"
                    max="99999999.00"
                    class="form-control"
                    id="id_expensesinfo_transportation"
                  />
                  <span class="input-group-text" id="basic-addon1">ر.س.</span>
                </div>
              </div>
            </div>
            <div class="row row-cols-md-2 row-cols-xl-4">
              <div class="col-md-6 mb-4 form-group">
                <label for="id_expensesinfo_health_supplies" class="form-label"
                  >مستلزمات صحية<span style="color: red">*</span></label
                >
                <div class="input-group mb-3">
                  <input
                    type="number"
                    name="expensesinfo_health_supplies"
                    min="0.00"
                    max="99999999.00"
                    class="form-control"
                    id="id_expensesinfo_health_supplies"
                  />
                  <span class="input-group-text" id="basic-addon1">ر.س.</span>
                </div>
              </div>
              <div class="col-md-6 mb-4 form-group">
                <label for="id_expensesinfo_food_supplies" class="form-label"
                  >مستلزمات غذائية<span style="color: red">*</span></label
                >
                <div class="input-group mb-3">
                  <input
                    type="number"
                    name="expensesinfo_food_supplies"
                    min="0.00"
                    max="99999999.00"
                    class="form-control"
                    id="id_expensesinfo_food_supplies"
                  />
                  <span class="input-group-text" id="basic-addon1">ر.س.</span>
                </div>
              </div>
              <div class="col-md-6 mb-4 form-group">
                <label
                  for="id_expensesinfo_educational_supplies"
                  class="form-label"
                  >مستلزمات دراسية<span style="color: red">*</span></label
                >
                <div class="input-group mb-3">
                  <input
                    type="number"
                    name="expensesinfo_educational_supplies"
                    min="0.00"
                    max="99999999.00"
                    class="form-control"
                    id="id_expensesinfo_educational_supplies"
                  />
                  <span class="input-group-text" id="basic-addon1">ر.س.</span>
                </div>
              </div>
              <div class="col-md-6 mb-4 form-group">
                <label for="id_expensesinfo_proven_debts" class="form-label"
                  >ديون مثبتة<span style="color: red"
                  >*</span
                ></label
                >
                <div class="input-group mb-3">
                  <input
                    type="number"
                    name="expensesinfo_proven_debts"
                    min="0.00"
                    max="99999999.00"
                    class="form-control"
                    id="id_expensesinfo_proven_debts"
                    oninput="provenDebtValueCheck(this);"
                  />
                  <span class="input-group-text" id="basic-addon1">ر.س.</span>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col mb-4 form-group">
                <label for="id_expensesinfo_other" class="form-label"
                  >أخرى<span style="color: red"
                  >*</span
                ></label
                >
                <div class="input-group mb-3">
                  <input
                    type="number"
                    name="expensesinfo_other"
                    min="0.00"
                    max="99999999.00"
                    class="form-control"
                    id="id_expensesinfo_other"
                  />
                  <span class="input-group-text" id="basic-addon1">ر.س.</span>
                </div>
              </div>
            </div>

            <hr />

            <div class="row mt-3">
              <div class="col-md-6 mb-4 form-group">
                <label class="form-label"
                  >المشكلات التي تعاني منها الأسرة<span style="color: red"
                    >*</span
                  > <span style="font-size: 0.9rem">
                    (إختيار متعدد)</span
                  ></label
                >
                  <div
                    name="familyinfo_family_issues"
                    class="d-grid gap-2"
                    style="grid-template-columns: 1fr 1fr;"
                    id="id_familyinfo_family_issues"
                  >
                    <input type="checkbox" class="btn-check" id="id_familyinfo_issues_economical" autocomplete="off" name="familyinfo_issues_economical" value="اقتصادية">
                    <label class="btn btn-outline-primary" for="id_familyinfo_issues_economical">اقتصادية</label>

                    <input type="checkbox" class="btn-check" id="id_familyinfo_issues_educational" autocomplete="off" name="familyinfo_issues_educational" value="تعليمية">
                    <label class="btn btn-outline-primary" for="id_familyinfo_issues_educational">تعليمية</label>

                    <input type="checkbox" class="btn-check" id="id_familyinfo_issues_employment" autocomplete="off" name="familyinfo_issues_employment" value="توظيف">
                    <label class="btn btn-outline-primary" for="id_familyinfo_issues_employment">توظيف</label>

                    <input type="checkbox" class="btn-check" id="id_familyinfo_issues_sponsorship" autocomplete="off" name="familyinfo_issues_sponsorship" value="كفالة">
                    <label class="btn btn-outline-primary" for="id_familyinfo_issues_sponsorship">كفالة</label>

                    <input type="checkbox" class="btn-check" id="id_familyinfo_issues_healthy" autocomplete="off" name="familyinfo_issues_healthy" value="صحية">
                    <label class="btn btn-outline-primary" for="id_familyinfo_issues_healthy">صحية</label>
                  </div>
              </div>
              <div class="col-md-6 mb-4 form-group">
                <label class="form-label"
                  >نوع الاحتياج<span style="color: red">*</span> <span style="font-size: 0.9rem">
                    (إختيار متعدد)</span
                  ></label
                >
                <div
                  name="familyinfo_needs_type"
                  class="d-grid gap-2"
                  style="grid-template-columns: 1fr 1fr;"
                  id="id_familyinfo_needs_type"
                >
                  <input type="checkbox" class="btn-check" id="id_familyinfo_needs_type_food_baskets" autocomplete="off" name="familyinfo_needs_type_food_baskets" value="سلال غذائية">
                  <label class="btn btn-outline-primary" for="id_familyinfo_needs_type_food_baskets">سلال غذائية</label>

                  <input type="checkbox" class="btn-check" id="id_familyinfo_needs_type_clothing" autocomplete="off" name="familyinfo_needs_type_clothing" value="كسوة">
                  <label class="btn btn-outline-primary" for="id_familyinfo_needs_type_clothing">كسوة</label>

                  <input type="checkbox" class="btn-check" id="id_familyinfo_needs_type_school_bags"  autocomplete="off" name="familyinfo_needs_type_school_bags" value="حقائب مدرسية">
                  <label class="btn btn-outline-primary" for="id_familyinfo_needs_type_school_bags">حقائب مدرسية</label>

                  <input type="checkbox" class="btn-check" id="id_familyinfo_needs_type_water_filters"  autocomplete="off" name="familyinfo_needs_type_water_filters" value="فلاتر مياه">
                  <label class="btn btn-outline-primary" for="id_familyinfo_needs_type_water_filters">فلاتر مياه</label>

                  <input type="checkbox" class="btn-check" id="id_familyinfo_needs_type_rent_payment"  autocomplete="off" name="familyinfo_needs_type_rent_payment" value="سداد إيجار">
                  <label class="btn btn-outline-primary" for="id_familyinfo_needs_type_rent_payment">سداد إيجار</label>

                  <input type="checkbox" class="btn-check" id="id_familyinfo_needs_type_electricity_payment"  autocomplete="off" name="familyinfo_needs_type_electricity_payment" value="سداد كهرباء">
                  <label class="btn btn-outline-primary" for="id_familyinfo_needs_type_electricity_payment">سداد كهرباء</label>

                  <input type="checkbox" class="btn-check" id="id_familyinfo_needs_type_dept_payment" autocomplete="off" name="familyinfo_needs_type_dept_payment" value="سداد دين">
                  <label class="btn btn-outline-primary" for="id_familyinfo_needs_type_dept_payment">سداد دين</label>

                  <input type="checkbox" class="btn-check" id="id_familyinfo_needs_type_training"  autocomplete="off" name="familyinfo_needs_type_training" value="تدريب">
                  <label class="btn btn-outline-primary" for="id_familyinfo_needs_type_training">تدريب</label>

                  <input type="checkbox" class="btn-check" id="id_familyinfo_needs_type_electronic_devices" autocomplete="off" name="familyinfo_needs_type_electronic_devices" value="أجهزة كهربائية">
                  <label class="btn btn-outline-primary" for="id_familyinfo_needs_type_electronic_devices">أجهزة كهربائية</label>

                  <input type="checkbox" class="btn-check" id="id_familyinfo_needs_type_furniture" autocomplete="off" name="familyinfo_needs_type_furniture" value="أثاث">
                  <label class="btn btn-outline-primary" for="id_familyinfo_needs_type_furniture">أثاث</label>

                  <input type="checkbox" class="btn-check" id="id_familyinfo_needs_type_home_renovation" autocomplete="off" name="familyinfo_needs_type_home_renovation" value="ترميم">
                  <label class="btn btn-outline-primary" for="id_familyinfo_needs_type_home_renovation">ترميم</label>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-6 mb-4 form-group">
                <label for="id_beneficiaryinfo_iban" class="form-label"
                  >الحساب البنكي للمستفيد<span style="color: red">*</span>
                  (IBAN)</label
                >
                <input
                  type="text"
                  name="beneficiaryinfo_iban"
                  maxlength="50"
                  class="form-control"
                  id="id_beneficiaryinfo_iban"
                  placeholder=""
                />
              </div>
              <div class="col-md-6 mb-4 form-group">
                <label for="id_beneficiaryinfo_bank" class="form-label"
                  >البنك<span style="color: red">*</span></label
                >
                <select
                  name="beneficiaryinfo_bank"
                  class="form-select"
                  id="id_beneficiaryinfo_bank"
                >
                  <option value selected>---------</option>
                  <option value="الأهلي السعودي">الأهلي السعودي</option>
                  <option value="الراجحي">الراجحي</option>
                  <option value="الجزيرة">الجزيرة</option>
                  <option value="الإنماء">الإنماء</option>
                  <option value="البلاد">البلاد</option>
                  <option value="الرياض">الرياض</option>
                  <option value="ساب">ساب</option>
                  <option value="السعودي الفرنسي">السعودي الفرنسي</option>
                  <option value="العربي">العربي</option>
                  <option value="مسقط">مسقط</option>
                  <option value="الإمارات دبي الوطني">الإمارات دبي الوطني</option>
                  <option value="الخليج الدولي">الخليج الدولي</option>
                  <option value="البحرين الوطني">البحرين الوطني</option>
                  <option value="الكويت الوطني">الكويت الوطني</option>
                  <option value="باكستان الوطني">باكستان الوطني</option>
                  <option value="الأول">الأول</option>
                  <option value="السعودي للاستثمار">السعودي للاستثمار</option>
                  <option value="زراعات">زراعات</option>
                  <option value="أخرى">أخرى</option>
                </select>
              </div>
            </div>

            <hr />
          </div>
          <div class="mt-3 d-flex column-gap-2 d-lg-block">
            <button
              class="col button btn-navigate-form-step previous"
              type="button"
              step_number="2"
            >
              السابق
            </button>
            <button
              class="col button btn-navigate-form-step next"
              type="button"
              step_number="4"
            >
              التالي
            </button>
          </div>
        </fieldset>
        <!-- Step 4 Content, default hidden on page load. -->
        <fieldset id="attachments_information" class="form-step px-3 px-lg-5">
          <h2 class="fs-2 fw-bold mb-5">المرفقات</h2>
          <!-- Step 4 input fields -->
          <div class="row mt-3">

            <div
              class="alert alert-warning mb-2"
              role="alert"
              id="checkboxError"
            >
              جميع المرفقات المحددة بنجمة حمراء (<span style="color: red">*</span>) مطلوبة وهي إلزامية لإكمال الطلب
            </div>

            <div
              class="alert alert-danger mt-1 mb-4"
              role="alert"
              id="checkboxError"
            >
              الحجم الاقصى للملف الواحد لجميع المرفقات هو ١ ميجابايت <span dir="ltr">(1 MB)</span>, بحيث انه يمكن رفع اكثر من ملف لبعض المرفقات بما لا يتجاوز حجم 1 ميجابايت للملف الواحد
            </div>

            <div class="col-12 col-lg-6 row-gap-3 mb-3 mt-2">

              <div class="mb-4 row column-gap-4 fileInputContainer">
                <div class="row pe-0">
                  <label class="form-label col pt-3" id="id_beneficiaryNationalIDTitle"
                    >صورة الهوية الوطنية/الإقامة<span style="color: red">*</span></label
                  >
                  <div class="col-4 d-flex justify-content-center">
                    <label
                      class="btn btn-success w-100 mb-2 mt-2 align-self-baseline"
                      for="id_formFileBeneficiaryNationalID"
                      >إرفاق ملف</label
                    >
                  </div>
                  <input
                    class="form-control d-none"
                    type="file"
                    id="id_formFileBeneficiaryNationalID"
                    name="fileBeneficiaryNationalID"
                    accept="application/pdf,image/png, image/jpg, image/jpeg"
                  />
                  
                </div>
                <div
                  class="col text-muted"
                  id="id_fileNamesBeneficiaryNationalID"
                ></div>
                <!--- Place of showing file names -->
                
              </div>

              <hr />

              <div class="mb-4 row column-gap-4 fileInputContainer">
                <div class="row pe-0">
                  <label class="form-label col pt-3">العنوان الوطني<span style="color: red">*</span></label>
                  <div class="col-4 d-flex justify-content-center">
                    <label
                      class="btn btn-success w-100 mb-2 mt-2 align-self-baseline"
                      for="id_formFileBeneficiaryNationalAddress"
                      >إرفاق ملف</label
                    >
                  </div>
                  <input
                    class="form-control d-none"
                    type="file"
                    id="id_formFileBeneficiaryNationalAddress"
                    name="fileBeneficiaryNationalAddress"
                    accept="application/pdf,image/png, image/jpg, image/jpeg"
                  />
                </div>
                <div
                  class="col text-muted"
                  id="id_fileNamesNationalAddress"
                ></div>
                <!--- Place of showing file names -->

              </div>

              <hr />

              <div class="mb-4 row column-gap-4 fileInputContainer">
                <div class="row pe-0">
                  <label class="form-label col pt-3">صك الدين<span style="color: red">*</span> (في حال وجود دين)</label>
                  <div class="col-4 d-flex justify-content-center">
                    <label
                      class="btn btn-success w-100 mb-2 mt-2 align-self-baseline"
                      for="id_formFileDeptInstrument"
                      >إرفاق ملفات</label
                    >
                  </div>
                  <input
                    class="form-control d-none"
                    type="file"
                    id="id_formFileDeptInstrument"
                    name="fileDeptInstrument"
                    accept="application/pdf,image/png, image/jpg, image/jpeg"
                    multiple
                  />
                </div>
                <div
                  class="col text-muted"
                  id="id_fileNamesDeptInstrument"
                ></div>
                <!--- Place of showing file names -->

              </div>

              <hr />

              <div
                class="mb-4 row column-gap-4 fileInputContainer"
                id="id_attachmentPensionOrSocialInsuranceInquiry_group_info"
                style="display: none"
              >
                <div class="row pe-0">
                  <label
                    class="form-label col pt-3"
                    id="id_PensionOrSocialInsuranceInquiryTitle"
                    >مشهد التقاعد أو التأمينات الاجتماعية<span style="color: red">*</span></label
                  >
                  <div class="col-4 d-flex justify-content-center">
                    <label
                      class="btn btn-success w-100 mb-2 mt-2 align-self-baseline"
                      for="id_formFilePensionOrSocialInsuranceInquiry"
                      >إرفاق ملفات</label
                    >
                  </div>
                  <input
                    class="form-control d-none"
                    type="file"
                    id="id_formFilePensionOrSocialInsuranceInquiry"
                    name="filePensionOrSocialInsuranceInquiry"
                    accept="application/pdf,image/png, image/jpg, image/jpeg"
                    multiple
                  />
                </div>
                <div
                  class="col text-muted"
                  id="id_fileNamesPensionOrSocialInsuranceInquiry"
                ></div>
                <!--- Place of showing file names -->

              </div>

              <hr
                id="id_attachmentPensionOrSocialInsuranceInquiry_group_info_hr"
                style="display: none"
              />

              <div
                class="mb-4 row column-gap-4 fileInputContainer"
                id="id_attachmentFatherOrHusbandDeathCertificate_group_info"
                style="display: none"
              >
                <div class="row pe-0">
                  <label class="form-label col pt-3">شهادة الوفاة للزوج / الأب<span style="color: red">*</span></label>
                  <div class="col-4 d-flex justify-content-center">
                    <label
                      class="btn btn-success w-100 mb-2 mt-2 align-self-baseline"
                      for="id_formFileFatherOrHusbandDeathCertificate"
                      >إرفاق ملف</label
                    >
                  </div>
                  <input
                    class="form-control d-none"
                    type="file"
                    id="id_formFileFatherOrHusbandDeathCertificate"
                    name="fileFatherOrHusbandDeathCertificate"
                    accept="application/pdf,image/png, image/jpg, image/jpeg"
                  />
                </div>
                <div
                  class="col text-muted"
                  id="id_fileNamesFatherOrHusbandDeathCertificate"
                ></div>
                <!--- Place of showing file names -->

              </div>

              <hr
                id="id_attachmentFatherOrHusbandDeathCertificate_group_info_hr"
                style="display: none"
              />

              <div
                class="mb-4 row column-gap-4 fileInputContainer"
                id="id_attachmentLetterFromPrison_group_info"
                style="display: none"
              >
                <div class="row pe-0">
                  <label class="form-label col pt-3"
                    >خطاب من السجن<span style="color: red">*</span> (في حال أسرة سجين)</label
                  >
                  <div class="col-4 d-flex justify-content-center">
                    <label
                      class="btn btn-success w-100 mb-2 mt-2 align-self-baseline"
                      for="id_formFileLetterFromPrison"
                      >إرفاق ملفات</label
                    >
                  </div>
                  <input
                    class="form-control d-none"
                    type="file"
                    id="id_formFileLetterFromPrison"
                    name="fileLetterFromPrison"
                    accept="application/pdf,image/png, image/jpg, image/jpeg"
                    multiple
                  />
                </div>
                <div
                  class="col text-muted"
                  id="id_fileNamesLetterFromPrison"
                ></div>
                <!--- Place of showing file names -->

              </div>

              <hr
                id="id_attachmentLetterFromPrison_group_info_hr"
                style="display: none"
              />

              <div
                class="mb-4 row column-gap-4 fileInputContainer"
                id="id_attachmentDivorceDeed_group_info"
                style="display: none"
              >
                <div class="row pe-0">
                  <label class="form-label col pt-3">صك الطلاق<span style="color: red">*</span></label>
                  <div class="col-4 d-flex justify-content-center">
                    <label
                      class="btn btn-success w-100 mb-2 mt-2 align-self-baseline"
                      for="id_formFileDivorceDeed"
                      >إرفاق ملف</label
                    >
                  </div>
                  <input
                    class="form-control d-none"
                    type="file"
                    id="id_formFileDivorceDeed"
                    name="fileDivorceDeed"
                    accept="application/pdf,image/png, image/jpg, image/jpeg"
                  />
                </div>
                <div
                  class="col text-muted"
                  id="id_fileNamesDivorceDeed"
                ></div>
                <!--- Place of showing file names -->
              </div>

              <hr
                id="id_attachmentDivorceDeed_group_info_hr"
                style="display: none"
              />

              <div
                class="mb-4 row column-gap-4 fileInputContainer"
                id="id_attachmentChildrenResponsibilityDeed_group_info"
                style="display: none"
              >
                <div class="row pe-0">
                  <label class="form-label col pt-3"
                    >صك إعالة الأبناء<span style="color: red">*</span> (في حال كانوا مرافقين)</label
                  >
                  <div class="col-4 d-flex justify-content-center">
                    <label
                      class="btn btn-success w-100 mb-2 mt-2 align-self-baseline"
                      for="id_formFileChildrenResponsibilityDeed"
                      >إرفاق ملفات</label
                    >
                  </div>
                  <input
                    class="form-control d-none"
                    type="file"
                    id="id_formFileChildrenResponsibilityDeed"
                    name="fileChildrenResponsibilityDeed"
                    accept="application/pdf,image/png, image/jpg, image/jpeg"
                    multiple
                  />
                </div>
                <div
                  class="col text-muted"
                  id="id_fileNamesChildrenResponsibilityDeed"
                ></div>
                <!--- Place of showing file names -->

              </div>

              <hr
                id="id_attachmentChildrenResponsibilityDeed_group_info_hr"
                style="display: none"
              />

              <div class="mb-4 row column-gap-4 fileInputContainer">
                <div class="row pe-0">
                  <label class="form-label col pt-3">إرفاق مستندات أخرى</label>
                  <div class="col-4 d-flex justify-content-center">
                    <label
                      class="btn btn-success w-100 mb-2 mt-2 align-self-baseline"
                      for="id_formFileOther"
                      >إرفاق ملفات</label
                    >
                  </div>
                  <input
                    class="form-control d-none"
                    type="file"
                    id="id_formFileOther"
                    name="fileOther"
                    accept="application/pdf,image/png, image/jpg, image/jpeg"
                    multiple
                  />
                </div>
                <div class="col text-muted" id="id_fileNamesOther"></div>
                  <!--- Place of showing file names -->
                
              </div>

              <hr />
            </div>

            <div class="col-12 col-lg-6 row-gap-3 mb-3 mt-2">

              <div class="mb-4 row column-gap-4 fileInputContainer">
                <div class="row pe-0">
                  <label class="form-label col pt-3"
                    >عقد الإيجار الالكتروني من منصة إيجار أو صك ملكية<span style="color: red">*</span></label
                  >
                  <div class="col-4 d-flex justify-content-center">
                    <label
                      class="btn btn-success w-100 mb-2 mt-2 align-self-baseline"
                      for="id_formFileLeaseContractOrTitleDeed"
                      >إرفاق ملفات</label
                    >
                  </div>
                  <input
                    class="form-control d-none"
                    type="file"
                    id="id_formFileLeaseContractOrTitleDeed"
                    name="fileLeaseContractOrTitleDeed"
                    accept="application/pdf,image/png, image/jpg, image/jpeg"
                    multiple
                  />
                </div>
                <div
                    class="col text-muted"
                    id="id_fileNamesLeaseContractOrTitleDeed"
                  ></div>
                  <!--- Place of showing file names -->

              </div>

              <hr />

              <div class="mb-4 row column-gap-4 fileInputContainer">
                <div class="row pe-0">
                  <label class="form-label col pt-3">الفواتير<span style="color: red">*</span> (كهرباء - ماء)</label>
                  <div class="col-4 d-flex justify-content-center">
                    <label
                      class="btn btn-success w-100 mb-2 mt-2 align-self-baseline"
                      for="id_formFileWaterOrElectricityBills"
                      >إرفاق ملفات</label
                    >
                  </div>
                  <input
                    class="form-control d-none"
                    type="file"
                    id="id_formFileWaterOrElectricityBills"
                    name="fileWaterOrElectricityBills"
                    accept="application/pdf,image/png, image/jpg, image/jpeg"
                    multiple
                  />
                </div>
                <div
                    class="col text-muted"
                    id="id_fileNamesWaterOrElectricityBills"
                  ></div>
                  <!--- Place of showing file names -->

              </div>

              <hr />

              <div
                class="mb-4 row column-gap-4 fileInputContainer"
                id="id_attachmentNationalIDForBeneficiaryForDependents_group_info"
                style="display: none"
              >
                <div class="row pe-0">
                  <label
                    class="form-label col pt-3"
                    id="id_NationalIDForBeneficiaryForDependentsTitle"
                    >صورة الهوية الوطنية/الإقامة للمرافقين<span style="color: red">*</span></label
                  >
                  <div class="col-4 d-flex justify-content-center">
                    <label
                      class="btn btn-success w-100 mb-2 mt-2 align-self-baseline"
                      for="id_formFileNationalIDForBeneficiaryForDependents"
                      >إرفاق ملفات</label
                    >
                  </div>
                  <input
                    class="form-control d-none"
                    type="file"
                    id="id_formFileNationalIDForBeneficiaryForDependents"
                    name="fileNationalIDForBeneficiaryDependents"
                    accept="application/pdf,image/png, image/jpg, image/jpeg"
                    multiple
                  />
                </div>
                <div
                  class="col text-muted"
                  id="id_fileNamesNationalIDForBeneficiaryForDependents"
                ></div>
                <!--- Place of showing file names -->
                
              </div>

              <hr
                id="id_attachmentNationalIDForBeneficiaryForDependents_group_info_hr"
                style="display: none"
              />

              <div
                class="mb-4 row column-gap-4 fileInputContainer"
                id="id_attachmentSocialWarrantyInquiry_group_info"
                style="display: none"
              >
                <div class="row pe-0">
                  <label class="form-label col pt-3" id="id_SocialWarrantyInquiryTitle"
                    >مشهد الضمان الاجتماعي<span style="color: red">*</span></label
                  >
                  <div class="col-4 d-flex justify-content-center">
                    <label
                      class="btn btn-success w-100 mb-2 mt-2 align-self-baseline"
                      for="id_formFileSocialWarrantyInquiry"
                      >إرفاق ملفات</label
                    >
                  </div>
                  <input
                    class="form-control d-none"
                    type="file"
                    id="id_formFileSocialWarrantyInquiry"
                    name="fileSocialWarrantyInquiry"
                    accept="application/pdf,image/png, image/jpg, image/jpeg"
                    multiple
                  />
                </div>
                <div
                  class="col text-muted"
                  id="id_fileNamesSocialWarrantyInquiry"
                ></div>
                <!--- Place of showing file names -->
                
              </div>

              <hr
                id="id_attachmentSocialWarrantyInquiry_group_info_hr"
                style="display: none"
              />
            </div>
          </div>
          <div class="mt-3 d-flex column-gap-2 d-lg-block">
            <button
              class="col button btn-navigate-form-step previous"
              type="button"
              step_number="3"
            >
              السابق
            </button>
            <button
              class="col button btn-navigate-form-step next next-attachment"
              type="button"
              step_number="5"
            >
              التالي
            </button>
          </div>
        </fieldset>

        <fieldset id="submit_confirmation" class="form-step px-3 px-lg-5">
          <h2 class="fs-2 fw-bold mb-5">تقديم الطلب</h2>
          <!-- Step 5 input fields -->
          <div class="mt-3">
            <div class="alert alert-primary" role="alert" id="checkboxError">
              يرجى الموافقة على جميع الشروط قبل تقديم الطلب.
            </div>
            <ul class="list-group">
              <li class="list-group-item d-flex gap-2">
                <input
                  class="form-check-input me-1"
                  type="checkbox"
                  value=""
                  id="id_agreement1"
                  name="agreement1"
                />
                <p class="form-check-label" for="id_agreement1">
                  أتعهد بأن كافة البيانات والمعلومات سواء الفنية أو المالية أو
                  القانونية وغيرها التي قدمتها في هذا الطلب جميعها صحيحة لا لبس
                  فيها ولا تحريف ولا تحوير وتطابق صحيح الواقع والقانون.
                </p>
              </li>
              <li class="list-group-item d-flex gap-2">
                <input
                  class="form-check-input me-1"
                  type="checkbox"
                  value=""
                  id="id_agreement2"
                  name="agreement2"
                />
                <p class="form-check-label" for="id_agreement2">
                  أقر بالتزامي ومسؤوليتي الكاملة عن عدم صحة كل أو بعض هذه
                  البيانات والمعلومات أو عن الخطأ أو النقص أو عدم الدقة.
                </p>
              </li>
              <li class="list-group-item d-flex gap-2">
                <input
                  class="form-check-input me-1"
                  type="checkbox"
                  value=""
                  id="id_agreement3"
                  name="agreement3"
                />
                <p class="form-check-label" for="id_agreement3">
                  أقبل النتائج المترتبة عن كافة هذه الأمور بما فيها استبعادي من
                  الجمعية.
                </p>
              </li>
              <li class="list-group-item d-flex gap-2">
                <input
                  class="form-check-input me-1"
                  type="checkbox"
                  value=""
                  id="id_agreement4"
                  name="agreement4"
                />
                <p class="form-check-label" for="id_agreement4">
                  أوافق على قيام الجمعية في حال قبول طلبي بعمل بحث ميداني عن
                  حالتي.
                </p>
              </li>
            </ul>
          </div>
          <div class="mt-5 d-flex column-gap-2 d-lg-block">
            <button
              class="col button btn-navigate-form-step previous"
              type="button"
              step_number="4"
            >
              السابق
            </button>
            <button
              class="col button submit-btn next"
              id="submit-btn"
              type="submit"
              disabled
            >
              تقديم الطلب
            </button>
          </div>
        </fieldset>
      </form>
    </div>
  </div>
</div>
<!-- Edit Modal -->
<div
  class="modal fade"
  id="editModal"
  tabindex="-1"
  aria-labelledby="editModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-xl modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="editModalLabel">تعديل معلومات المرافق</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body bg-light">
        <!-- Loading state content -->
        <div id="loadingStateEditModal" style="display: none; text-align: center;">
          <div class="spinner-border text-primary mt-5" role="status">
            <span class="sr-only visually-hidden">انتظار...</span>
          </div>
          <p>انتظار...</p>
        </div>

        <!-- Actual modal content -->
        <div id="editModalContent" style="display: none;">
          <form
            id="editModalForm"
            name="editModalForm"
            method="POST"
            action="/handle_test2"
            class="needs-validation"
            novalidate
          >
            {% csrf_token %}
            <div class="row row-cols-md-2 row-cols-xl-4">
              <div class="col-md-6 mb-4 form-group">
                <label for="id_dependent_edit_info_first_name" class="form-label"
                  >الأسم الأول<span style="color: red">*</span>
                </label>
                <input
                  type="text"
                  id="id_dependent_edit_info_first_name"
                  class="form-control"
                  name="dependent_edit_info_first_name"
                />
              </div>
              <div class="col-md-6 mb-4 form-group">
                <label for="id_dependent_edit_info_second_name" class="form-label"
                  >الأسم الثاني<span style="color: red">*</span
                  ></label
                >
                <input
                  type="text"
                  id="id_dependent_edit_info_second_name"
                  class="form-control"
                  name="dependent_edit_info_second_name"
                />
              </div>
              <div class="col-md-6 mb-4 form-group">
                <label for="id_dependent_edit_info_last_name" class="form-label"
                  >الأسم الأخير<span style="color: red">*</span
                  ><span style="font-size: 0.9rem">
                    (أسم العائلة)</span
                  ></label
                >
                <input
                  type="text"
                  id="id_dependent_edit_info_last_name"
                  class="form-control"
                  name="dependent_edit_info_last_name"
                />
              </div>
              <div class="col-md-6 mb-4 form-group">
                <label
                  for="id_dependent_edit_info_date_of_birth"
                  class="form-label"
                  >تاريخ الميلاد<span style="color: red">*</span></label
                >
                <input
                  type="date"
                  class="form-control"
                  id="id_dependent_edit_info_date_of_birth"
                  maxlength="55"
                  name="dependent_edit_info_date_of_birth"
                />
              </div>
            </div>

            <hr>

            <div class="row row-cols-md-2 row-cols-xl-3">
              <div class="col-md-6 mb-4 form-group">
                <label for="id_dependent_edit_info_gender" class="form-label"
                  >الجنس<span style="color: red">*</span></label
                >
                <select
                  name="dependent_edit_info_gender"
                  class="form-select"
                  id="id_dependent_edit_info_gender"
                >
                  <option value selected>---------</option>
                  <option value="ذكر">ذكر</option>
                  <option value="انثى">انثى</option>
                </select>
              </div>
              <div class="col-md-6 mb-4 form-group">
                <label for="id_dependent_edit_info_relationship" class="form-label"
                  >صلة القرابة<span style="color: red">*</span></label
                >
                <select
                  name="dependent_edit_info_relationship"
                  class="form-select"
                  id="id_dependent_edit_info_relationship"
                >
                  <option value selected>---------</option>
                  <option value="ابن">ابن</option>
                  <option value="ابنة">ابنة</option>
                  <option value="أخ">أخ</option>
                  <option value="أخت">أخت</option>
                  <option value="زوج/ـة">زوج/ـة</option>
                  <option value="خال/ـة">خال/ـة</option>
                  <option value="عم/ـة">عم/ـة</option>
                  <option value="جد/ـة">جد/ـة</option>
                </select>
              </div>
              <div class="col-md-6 mb-4 form-group">
                <label
                  for="id_dependent_edit_info_marital_status"
                  class="form-label"
                  >الحالة الاجتماعية<span style="color: red">*</span></label
                >
                <select
                  name="dependent_edit_info_marital_status"
                  class="form-select"
                  id="id_dependent_edit_info_marital_status"
                >
                  <option value selected>---------</option>
                  <option value="طفل/ـة">طفل/ـة</option>
                  <option value="ربة منزل">ربة منزل</option>
                  <option value="متزوج/ـة">متزوج/ـة</option>
                  <option value="أعزب/ـة">أعزب/ـة</option>
                  <option value="أرملة/ـة">أرمل/ـة</option>
                  <option value="مطلقة">مطلقة</option>
                  <option value="مهجورة">مهجورة</option>
                </select>
              </div>
            </div>

            <hr />

            <div class="row row-cols-md-2">
              <div class="col-md-6 mb-4 form-group">
                <label
                  for="id_dependent_edit_info_educational_status"
                  class="form-label"
                  >الحالة الدراسية<span style="color: red">*</span></label
                >
                <select
                  name="dependent_edit_info_educational_status"
                  class="form-select"
                  id="id_dependent_edit_info_educational_status"
                  onchange="educationalStatusEditInfoCheck(this);"
                >
                  <option value selected>---------</option>
                  <option value="يدرس">يدرس</option>
                  <option value="لا يدرس">لا يدرس</option>
                </select>
              </div>
              <div class="col-md-6 mb-4 form-group" style="display: none;" id="id_dependent_edit_info_educational_level_group_info">
                <label
                  for="id_dependent_edit_info_educational_level"
                  class="form-label"
                  >المرحلة الدراسية<span style="color: red">*</span></label
                >
                <select
                  name="dependent_edit_info_educational_level"
                  class="form-select"
                  id="id_dependent_edit_info_educational_level"
                >
                  <option value selected>---------</option>
                  <option value="أول ابتدائي">أول ابتدائي</option>
                  <option value="ثاني ابتدائي">ثاني ابتدائي</option>
                  <option value="ثالث ابتدائي">ثالث ابتدائي</option>
                  <option value="رابع ابتدائي">رابع ابتدائي</option>
                  <option value="خامس ابتدائي">خامس ابتدائي</option>
                  <option value="سادس ابتدائي">سادس ابتدائي</option>
                  <option value="اول متوسط">اول متوسط</option>
                  <option value="ثاني متوسط">ثاني متوسط</option>
                  <option value="ثالث متوسط">ثالث متوسط</option>
                  <option value="اول ثانوي">اول ثانوي</option>
                  <option value="ثاني ثانوي">ثاني ثانوي</option>
                  <option value="ثالث ثانوي">ثالث ثانوي</option>
                  <option value="جامعي">جامعي</option>
                </select>
              </div>
              <div class="col-md-6 mb-4 form-group" style="display: none;" id="id_dependent_edit_info_educational_degree_group_info">
                <label
                  for="id_dependent_edit_info_educational_degree"
                  class="form-label"
                  >المؤهل التعليمي<span style="color: red">*</span></label
                >
                <select
                  name="dependent_edit_info_educational_degree"
                  class="form-select"
                  id="id_dependent_edit_info_educational_degree"
                >
                  <option value selected>---------</option>
                  <option value="أُمّيّ (لا يقرأ ولا يكتب)">أُمّيّ (لا يقرأ ولا يكتب)</option>
                  <option value="يقرأ ويكتب">يقرأ ويكتب</option>
                  <option value="ابتدائي">ابتدائي</option>
                  <option value="متوسط">متوسط</option>
                  <option value="ثانوي">ثانوي</option>
                  <option value="جامعي">جامعي</option>
                </select>
              </div>
            </div>

            <hr />

            <div class="row">
              <div class="col-md-6 mb-4 form-group">
                <label for="id_dependent_edit_info_national_id" class="form-label"
                  >رقم الهوية الوطنية \ الإقامة<span style="color: red"
                  >*</span
                ></label
                >
                <input
                  type="text"
                  class="form-control"
                  id="id_dependent_edit_info_national_id"
                  maxlength="20"
                  name="dependent_edit_info_national_id"
                />
              </div>
              <div class="col-md-6 mb-4 form-group">
                <label
                  for="id_dependent_edit_info_national_id_exp_date"
                  class="form-label"
                  >تاريخ انتهاء الهوية \ الإقامة</label
                >
                <input
                  type="date"
                  class="form-control"
                  id="id_dependent_edit_info_national_id_exp_date"
                  name="dependent_edit_info_national_id_exp_date"
                />
              </div>
            </div>

            <hr/>

            <div class="row">
              <div class="col-md-6 mb-4 form-group">
                <label for="id_dependent_edit_info_work_status" class="form-label"
                  >هل تعمل؟<span style="color: red">*</span></label
                >
                <select
                  name="dependent_edit_info_work_status"
                  class="form-select"
                  required
                  id="id_dependent_edit_info_work_status"
                  onchange="toggleConditionalField(this, 'id_dependent_edit_info_employer_group_info');"
                >
                  <option value="" selected>---------</option>
                  <option value="نعم">نعم</option>
                  <option value="لا">لا</option>
                </select>
              </div>
              <div
                class="col-md-6 mb-4 form-group"
                id="id_dependent_edit_info_employer_group_info"
                style="display: none"
              >
                <label for="id_dependent_edit_info_employer" class="form-label"
                  >جهة العمل<span style="color: red">*</span> (عند اختيار
                  نعم)</label
                >
                <input
                  type="text"
                  name="dependent_edit_info_employer"
                  maxlength="100"
                  class="form-control"
                  id="id_dependent_edit_info_employer"
                />
              </div>
            </div>

            <hr/>

            <h4 class="mb-4">مصادر الدخل</h4>
            <div class="row row-cols-xl-3 justify-content-center">
              <div class="col-md-4 mb-2 form-group">
                <label for="id_dependent_edit_info_monthly_income" class="form-label">دخل المرافق (شهريا)</label>
                <div class="input-group mb-3">
                  <input type="number" name="dependent_edit_info_monthly_income" max="9999999999999999" min="0" class="form-control" id="id_dependent_edit_info_monthly_income" />
                  <span class="input-group-text" id="basic-addon1">ر.س.</span>
                </div>
              </div>
              <div class="col-md-4 col-lg-5 mb-2 form-group">
                <label for="id_dependent_edit_info_income_source" class="form-label">مصدر الدخل للمرافق</label>
                <select name="dependent_edit_info_income_source" class="form-select" id="id_dependent_edit_info_income_source">
                  <option value selected>---------</option>
                  <option value="الراتب">الراتب</option>
                  <option value="التأمينات الاجتماعية">التأمينات الاجتماعية</option>
                  <option value="الضمان الاجتماعي">الضمان الاجتماعي</option>
                  <option value="مصلحة التقاعد">مصلحة التقاعد</option>
                  <option value="حساب المواطن">حساب المواطن</option>
                  <option value="التأهيل الشامل">التأهيل الشامل</option>
                  <option value="جمعية خيرية">جمعية خيرية</option>
                  <option value="فاعل خير">فاعل خير</option>
                  <option value="اخرى">اخرى</option>
                </select>
              </div>
              <div class="col-md-4 col-lg-3 mb-sm-5 mb-md-3 mb-3 mt-4 row justify-content-center align-items-center" id="id_add_row_edit_income_table">
                <button type="button" class="btn btn-primary" id="id_add_row_income_edit_info" onclick="addRowToIncomeEditInfoTable()">إضافة مصدر الدخل</button>
              </div>
            </div>
            
            {% comment %} Dependent Income Table {% endcomment %}
            <table class="table table-striped table-hover mb-5" id="incomeEditInfoTable">
              <thead>
                <tr>
                  <th scope="col">دخل المرافق الشهري (ر.س.)</th>
                  <th scope="col">مصدر الدخل</th>
                  <th scope="col">الإجراءات</th>
                </tr>
              </thead>
              <tbody id="incomeEditInfoTableBody"></tbody>
            </table>

            <hr />

            <div class="row">
              <div class="col-md-6 mb-4 form-group">
                <label for="id_dependent_edit_info_contribute_to_family_income" class="form-label"
                  >هل يساهم المرافق في دخل الأسرة؟<span style="color: red">*</span></label
                >
                <select
                  name="dependent_edit_info_contribute_to_family_income"
                  class="form-select"
                  required
                  id="id_dependent_edit_info_contribute_to_family_income"
                >
                  <option value="" selected>---------</option>
                  <option value="نعم">نعم</option>
                  <option value="لا">لا</option>
                </select>
              </div>
            </div>

            <hr/>

            <div class="row">
              <div class="col-md-6 mb-4 form-group">
                <label for="id_dependent_edit_info_bank_iban" class="form-label"
                  >الحساب البنكي للمرافق
                  (IBAN)</label
                >
                <input
                  type="text"
                  name="dependent_edit_info_bank_iban"
                  maxlength="50"
                  class="form-control"
                  id="id_dependent_edit_info_bank_iban"
                  placeholder=""
                />
              </div>
              <div class="col-md-6 mb-4 form-group">
                <label for="id_dependent_edit_info_bank_type" class="form-label"
                  >البنك</label
                >
                <select
                  name="dependent_edit_info_bank_type"
                  class="form-select"
                  id="id_dependent_edit_info_bank_type"
                >
                  <option value selected>---------</option>
                  <option value="الأهلي السعودي">الأهلي السعودي</option>
                  <option value="الراجحي">الراجحي</option>
                  <option value="الجزيرة">الجزيرة</option>
                  <option value="الإنماء">الإنماء</option>
                  <option value="البلاد">البلاد</option>
                  <option value="الرياض">الرياض</option>
                  <option value="ساب">ساب</option>
                  <option value="السعودي الفرنسي">السعودي الفرنسي</option>
                  <option value="العربي">العربي</option>
                  <option value="مسقط">مسقط</option>
                  <option value="الإمارات دبي الوطني">الإمارات دبي الوطني</option>
                  <option value="الخليج الدولي">الخليج الدولي</option>
                  <option value="البحرين الوطني">البحرين الوطني</option>
                  <option value="الكويت الوطني">الكويت الوطني</option>
                  <option value="باكستان الوطني">باكستان الوطني</option>
                  <option value="الأول">الأول</option>
                  <option value="السعودي للاستثمار">السعودي للاستثمار</option>
                  <option value="زراعات">زراعات</option>
                  <option value="أخرى">أخرى</option>
                </select>
              </div>
            </div>

            <hr/>

            <div class="row">
              <div class="col-md-6 mb-4 form-group">
                <label
                  for="id_dependent_edit_info_health_status"
                  class="form-label"
                  >الحالة الصحية<span style="color: red"
                  >*</span
                ></label
                >
                <select
                  name="dependent_edit_info_health_status"
                  class="form-select"
                  id="id_dependent_edit_info_health_status"
                  onchange="toggleConditionalField(this, 'id_dependent_edit_info_disease_type_group_info', 'غير جيدة');"
                >
                  <option value selected>---------</option>
                  <option value="جيدة">جيدة</option>
                  <option value="غير جيدة">غير جيدة</option>
                </select>
              </div>
              <div
                class="col-md-6 mb-4 form-group"
                id="id_dependent_edit_info_disease_type_group_info"
                style="display: none"
              >
                <label
                  for="id_dependent_edit_info_disease_type"
                  class="form-label"
                  >نوع المرض<span style="color: red"
                  >*</span
                > (عند اختيار غير جيدة)</label
                >
                <input
                  type="text"
                  name="dependent_edit_info_disease_type"
                  maxlength="100"
                  class="form-control"
                  id="id_dependent_edit_info_disease_type"
                />
              </div>
            </div>

            <hr />

            <div class="row">
              <div class="col-md-6 mb-4 form-group">
                <label
                  for="id_dependent_edit_info_is_disabled"
                  class="form-label"
                  >هل المرافق من ذوي الاعاقة؟<span style="color: red">*</span></label
                >
                <select
                  name="dependent_edit_info_is_disabled"
                  class="form-select"
                  id="id_dependent_edit_info_is_disabled"
                  onchange="toggleConditionalField(this, 'id_dependent_edit_info_disability_type_group_info');"
                >
                  <option value selected>---------</option>
                  <option value="نعم">نعم</option>
                  <option value="لا">لا</option>
                </select>
              </div>
              <div
                class="col-md-6 mb-4 form-group"
                id="id_dependent_edit_info_disability_type_group_info"
                style="display: none"
              >
                <label for="id_dependent_edit_info_disability_type" class="form-label"
                  >نوع الإعاقة<span style="color: red">*</span></label
                >
                <select
                  name="dependent_edit_info_disability_type"
                  class="form-select"
                  id="id_dependent_edit_info_disability_type"
                >
                  <option value selected>---------</option>
                  <option value="حركية">حركية</option>
                  <option value="سمعية">سمعية</option>
                  <option value="بصرية">بصرية</option>
                  <option value="عقلية">عقلية</option>
                </select>
              </div>
            </div>

            <hr />

            <div class="row">
              <div class="col-md-12 mb-4 form-group">
                <label class="form-label"
                  >نوع الاحتياج للمرافق<span style="color: red"
                    >*</span
                  > <span style="font-size: 0.9rem">
                    (إختيار متعدد)</span
                  ></label
                >
                <div
                  name="dependent_edit_info_needs_type"
                  class="d-grid gap-2"
                  style="grid-template-columns: 1fr 1fr 1fr;"
                  id="id_dependent_edit_info_needs_type"
                >
                  <input type="checkbox" class="btn-check" id="id_dependent_edit_info_needs_type_economical" autocomplete="off" name="dependent_edit_info_needs_type_economical" value="اقتصادي">
                  <label class="btn btn-outline-primary" for="id_dependent_edit_info_needs_type_economical">اقتصادي</label>

                  <input type="checkbox" class="btn-check" id="id_dependent_edit_info_needs_type_educational" autocomplete="off" name="dependent_edit_info_needs_type_educational" value="تعليمي">
                  <label class="btn btn-outline-primary" for="id_dependent_edit_info_needs_type_educational">تعليمي</label>

                  <input type="checkbox" class="btn-check" id="id_dependent_edit_info_needs_type_employment" autocomplete="off" name="dependent_edit_info_needs_type_employment" value="توظيف">
                  <label class="btn btn-outline-primary" for="id_dependent_edit_info_needs_type_employment">توظيف</label>

                  <input type="checkbox" class="btn-check" id="id_dependent_edit_info_needs_type_sponsorship" autocomplete="off" name="dependent_edit_info_needs_type_sponsorship" value="كفالة">
                  <label class="btn btn-outline-primary" for="id_dependent_edit_info_needs_type_sponsorship">كفالة</label>

                  <input type="checkbox" class="btn-check" id="id_dependent_edit_info_needs_type_healthy" autocomplete="off" name="dependent_edit_info_needs_type_healthy" value="صحي">
                  <label class="btn btn-outline-primary" for="id_dependent_edit_info_needs_type_healthy">صحي</label>
                </div>
              </div>
              <div class="col-md-12 mb-4 form-group">
                <label
                  for="id_dependent_edit_info_needs_description"
                  class="form-label"
                  >وصف الاحتياج</label
                >
                <textarea
                  type="textarea"
                  class="form-control"
                  id="id_dependent_edit_info_needs_description"
                  name="dependent_edit_info_needs_description"
                  maxlength="2000"
                  rows="5"
                ></textarea>
              </div>
            </div>
          </form>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          إلغاء
        </button>
        <button
          type="button"
          class="btn btn-primary savechangesofedit"
          id="saveChanges"
          disabled
        >
          حفظ التغييرات
        </button>
      </div>
    </div>
  </div>
</div>
<!-- Confirmation Modal -->

<script>
  $(document).ready(function () {
    document.getElementById('myform').addEventListener('submit', function(e) {
      e.preventDefault();

      const formData = new FormData(this);

      // Collecting checkbox values
      let familyIssue = [];
      document.querySelectorAll('#id_familyinfo_family_issues input[type=checkbox]').forEach((checkbox) => {
          if (checkbox.checked) {
              familyIssue.push(checkbox.value);
          }
      });
      formData.append('familyinfo_family_issues', JSON.stringify(familyIssue));
  
      // Collecting checkbox values
      let familyNeedsType = [];
      document.querySelectorAll('#id_familyinfo_needs_type input[type=checkbox]').forEach((checkbox) => {
          if (checkbox.checked) {
              familyNeedsType.push(checkbox.value);
          }
      });
      formData.append('familyinfo_needs_type', JSON.stringify(familyNeedsType));
  
      // Adding information of the dependents table to the FormData
      formData.append('dependents-table', getTableDataAsJSON());
  
      // Remove 'Content-Type' header to allow the browser to add it
      // along with the correct 'boundary'
      // delete options.headers['Content-Type'];

      fetch("{% url 'beneficiary_new' user_id=user.id %}", {
          method: 'POST',
          body: formData,
      })
      .then(response => response.json())
      .then(data => {
          if (data.redirect) {
              window.location.href = data.redirect;
              // console.log(data);
          } else {
              // Handle other responses
          }
      })
      .catch((error) => {
          console.error('Error:', error);
          // Handle error
      });
    });

    var $modalForm = $("#editModalForm");
    var $saveChangesButton = $("#saveChanges");
    var csrfTokenDepForm = $('#myform input[name=csrfmiddlewaretoken]').val();

    // Retrieve the CSRF token from the specific form with id 'editModalForm'
    var csrfTokenEditDepForm = $('#editModalForm input[name=csrfmiddlewaretoken]').val();

    var includedFieldsEditModal = ["id_dependent_edit_info_national_id"]; // IDs of fields to include

    // Define your validation rules here
    $modalForm.validate({
      // Your validation rules
      rules: {
        // rules for your fields
        // dependent_information ---------
        dependent_edit_info_first_name: {
          required: true,
          dependentNameRegex: true,
          minlength: 2,
          maxlength: 50,
        },
        dependent_edit_info_second_name: {
          required: true,
          dependentNameRegex: true,
          minlength: 2,
          maxlength: 50,
        },
        dependent_edit_info_last_name: {
          required: true,
          dependentNameRegex: true,
          minlength: 2,
          maxlength: 50,
        },
        dependent_edit_info_relationship: {
          required: true,
        },
        dependent_edit_info_date_of_birth: {
          required: true,
          dateISO: true,
        },
        dependent_edit_info_gender: {
          required: true,
        },
        dependent_edit_info_marital_status: {
          required: true,
        },
        dependent_edit_info_educational_status: {
          required: true,
        },
        dependent_edit_info_educational_level: {
          required: true,
        },
        dependent_edit_info_educational_degree: {
          required: true,
        },
        dependent_edit_info_health_status: {
          required: true,
        },
        dependent_edit_info_disease_type: {
          required: true,
        },
        dependent_edit_info_national_id: {
          required: true,
          nationalidRegex: true,
          remote: {
            url: '/beneficiaries/' + '{{ request.user.id }}' + '/update/validate_national_id_edit_dependent/',
            type: 'post',
            data: {
              national_id: function() {
                return $('#id_dependent_edit_info_national_id').val();
              },
              csrfmiddlewaretoken: csrfTokenEditDepForm,  // Include CSRF token
              base_nid: function() { 
                // Get the value from the data-attr-base-nid attribute using plain JavaScript
                var element = document.getElementById('id_dependent_edit_info_national_id');
                return element.getAttribute('data-attr-base-nid');
              },
            },
          },
        },
        dependent_edit_info_national_id_exp_date: {
          required: false,
          dateISO: true,
        },
        dependent_edit_info_work_status: {
          required: true,
        },
        dependent_edit_info_bank_iban: {
          required: false,
          validateIBAN: true,
        },
        dependent_edit_info_bank_type: {
          required: false,
        },
        dependent_edit_info_employer: {
          required: true,
        },
        dependent_edit_info_contribute_to_family_income: {
          required: true,
        },
        dependent_edit_info_is_disabled: {
          required: true,
        },
        dependent_edit_info_disability_type: {
          required: true,
        },
        dependent_edit_info_needs_type: {
          required: true,
        },
        dependent_edit_info_needs_description: {
          required: false,
        },
      },
      messages: {
        dependent_edit_info_first_name: {
          required: "الرجاء إدخال الاسم حسب الهوية/الإقامة",
          minlength: "يجب ألا يقل الاسم عن حرفين",
        },
        dependent_edit_info_second_name: {
          required: "الرجاء إدخال الاسم حسب الهوية/الإقامة",
          minlength: "يجب ألا يقل الاسم عن حرفين",
        },
        dependent_edit_info_last_name: {
          required: "الرجاء إدخال الاسم حسب الهوية/الإقامة",
          minlength: "يجب ألا يقل الاسم عن حرفين",
        },
        dependent_edit_info_gender: {
          required: "الرجاء اختيار الجنس",
        },
        dependent_edit_info_relationship: {
          required: "الرجاء اختيار صلة القرابة",
        },
        // Add other field messages here
      },
      errorElement: "div",
      errorClass: "invalid-feedback",
      highlight: function (element, errorClass, validClass) {
        //$(element).addClass('is-invalid');
        $(element).closest(".form-group").addClass("has-error");

        // Check if the field is excluded
        if (includedFieldsEditModal.indexOf(element.id) !== -1) {
          $(element).addClass("is-invalid");
          $(element).removeClass("is-valid");
        }
      },
      unhighlight: function (element, errorClass, validClass) {
        $(element).closest(".form-group").removeClass("has-error");

        // Check if the field is excluded
        if (includedFieldsEditModal.indexOf(element.id) !== -1) {
          $(element).removeClass("is-invalid");
          $(element).addClass("is-valid");
        }
      },
      errorPlacement: function (error, element) {
        // Check if the element is inside an input-group
        if (element.parent(".input-group").length) {
          // Place the error after the input-group
          error.insertAfter(element.parent(".input-group"));
        } else {
          // Default placement for other elements
          error.insertAfter(element);
        }
      },
      // other options
    });


    // Check form validity on input change
    $modalForm.on("change keyup", function () {
      if ($modalForm.valid()) {
          $saveChangesButton.prop("disabled", false);
      } else {
          $saveChangesButton.prop("disabled", true);
      }
    });

    var includedFields = ["id_dependent_info_national_id", "id_personalinfo_phone_number", "id_personalinfo_email", "id_personalinfo_national_id", "id_beneficiaryinfo_iban"]; // IDs of fields to exclude

    // When ".next" button is clicked, the following function is executed
    $(".next").click(function () {
      // Check if on the dependent information step
      if ($("#dependent_information").is(":visible")) {
        // Check if the table has at least one row (one dependent)
        if ($("#family-table tbody tr").length === 0) {
          alert(
            "الرجاء إضافة مرافق واحد على الأقل قبل الانتقال الى الخطوة التالية. أو يمكنك الرجوع وإزالة خيار (إضافة ابناء / مرافقين)."
          );
          return false; // Prevent moving to next step
        }
      }

      var form = $("#myform");
      form.validate({
        errorElement: "span",
        errorClass: "help-block invalid-feedback",
        highlight: function (element, errorClass, validClass) {
          $(element).closest(".form-group").addClass("has-error");
          //$(element).fadeOut(function() {
          //  $(element).fadeIn();
          //  });

          // Check if the field is excluded
          if (includedFields.indexOf(element.id) !== -1) {
            $(element).addClass("is-invalid");
            $(element).removeClass("is-valid");
          }
        },
        unhighlight: function (element, errorClass, validClass) {
          $(element).closest(".form-group").removeClass("has-error");

          // Check if the field is excluded
          if (includedFields.indexOf(element.id) !== -1) {
            $(element).removeClass("is-invalid");
            $(element).addClass("is-valid");
          }
        },
        errorPlacement: function (error, element) {
          // Check if the element is inside an input-group
          if (element.parent(".input-group").length) {
            // Place the error after the input-group
            error.insertAfter(element.parent(".input-group"));
          } else {
            // Default placement for other elements
            error.insertAfter(element);
          }
        },
        focusInvalid: true,

        // Adding the rules (validations) for each input in the form.
        rules: {
          personalinfo_first_name: {
            required: true,
            nameRegex: true,
            minlength: 2,
            maxlength: 20,
          },
          personalinfo_second_name: {
            required: true,
            nameRegex: true,
            minlength: 2,
            maxlength: 20,
          },
          personalinfo_last_name: {
            required: true,
            nameRegex: true,
            minlength: 2,
            maxlength: 20,
          },
          personalinfo_date_of_birth: {
            required: true,
            dateISO: true,
          },
          personalinfo_gender: {
            required: true,
          },
          personalinfo_national_id: {
            required: true,
            nationalidRegex: true,
            remote: {
              url: '/beneficiaries/' + '{{ request.user.id }}' + '/new/validate_national_id_beneficiary/',
              type: 'post',
              data: {
                national_id: function() {
                  return $('#id_personalinfo_national_id').val();
                },
                csrfmiddlewaretoken: csrfTokenDepForm,  // Include CSRF token
              },
            },
          },
          personalinfo_national_id_exp_date: {
            required: true,
            dateISO: true,
          },
          personalinfo_nationality: {
            required: true,
            maxlength: 30,
          },
          personalinfo_category: {
            required: true,
          },
          personalinfo_marital_status: {
            required: true,
          },
          personalinfo_educational_level: {
            required: true,
          },
          personalinfo_date_of_death_of_father_or_husband: {
            required: true,
            dateISO: true,
          },
          personalinfo_washing_place: {
            required: false,
          },
          personalinfo_health_status: {
            required: true,
          },
          personalinfo_disease_type: {
            required: true,
          },
          personalinfo_work_status: {
            required: true,
          },
          personalinfo_employer: {
            required: true,
          },
          personalinfo_phone_number: {
            required: true,
            saudiPhoneRegex: true,
            remote: {
              url: '/beneficiaries/' + '{{ request.user.id }}' + '/new/validate_phonenumber_beneficiary/',
              type: 'post',
              data: {
                phonenumber: function() {
                  return $('#id_personalinfo_phone_number').val();
                },
                csrfmiddlewaretoken: csrfTokenDepForm,  // Include CSRF token
              },
            },
          },
          personalinfo_email: {
            required: true,
            //emailRegex: true,
          },
          // dependent_information ---------
          dependent_info_first_name: {
            required: true,
            minlength: 2,
            maxlength: 50,
          },
          dependent_info_second_name: {
            required: true,
            minlength: 2,
            maxlength: 50,
          },
          dependent_info_last_name: {
            required: true,
            minlength: 2,
            maxlength: 50,
          },
          dependent_info_relationship: {
            required: true,
          },
          dependent_info_national_id: {
            required: true,
            nationalidRegex: true,
            remote: {
              url: "{% url 'validate_national_id_dependent' user_id=request.user.id %}",
              type: 'post',
              data: {
                national_id: function() {
                  return $('#id_dependent_info_national_id').val();
                },
                csrfmiddlewaretoken: csrfTokenDepForm,  // Include CSRF token
              },
            },
          },
          dependent_info_national_id_exp_date: {
            required: false,
            dateISO: true,
          },
          dependent_info_work_status: {
            required: true,
          },
          dependent_info_employer: {
            required: true,
          },
          dependent_info_bank_iban: {
            required: false,
            validateIBAN: true,
          },
          dependent_info_bank_type: {
            required: false,
          },
          dependent_info_gender: {
            required: true,
          },
          dependent_info_marital_status: {
            required: true,
          },
          dependent_info_educational_status: {
            required: true,
          },
          dependent_info_educational_level: {
            required: true,
          },
          dependent_info_educational_degree: {
            required: true,
          },
          dependent_info_health_status: {
            required: true,
          },
          dependent_info_disease_type: {
            required: true,
          },
          dependent_info_date_of_birth: {
            required: true,
            dateISO: true,
          },
          dependent_info_needs_type: {
            required: true,
          },
          dependentinfo_needs_description: {
            required: false,
          },
          dependent_info_contribute_to_family_income: {
            required: true,
          },
          dependent_info_is_disabled: {
            required: true,
          },
          dependent_info_disability_type: {
            required: true,
          },
          // housing_income_need_information ---------
          houseinfo_building_number: {
            required: true,
          },
          houseinfo_street_name: {
            required: true,
          },
          houseinfo_neighborhood: {
            required: true,
          },
          houseinfo_city: {
            required: true,
          },
          houseinfo_postal_code:{
            required: true,
          },
          houseinfo_additional_number: {
            required: true,
          },
          houseinfo_unit: {
            required: true,
          },
          houseinfo_location_url: {
            required: true,
          },
          houseinfo_housing_type: {
            required: true,
          },
          houseinfo_housing_ownership: {
            required: true,
          },
          incomeinfo_salary: {
            required: true,
          },
          incomeinfo_social_insurance: {
            required: true,
          },
          incomeinfo_charity: {
            required: true,
          },
          incomeinfo_social_warranty: {
            required: true,
          },
          incomeinfo_pension_agency: {
            required: true,
          },
          incomeinfo_citizen_account: {
            required: true,
          },
          incomeinfo_benefactor: {
            required: true,
          },
          incomeinfo_other: {
            required: true,
          },
          expensesinfo_housing_rent: {
            required: true,
          },
          expensesinfo_electricity_bills: {
            required: true,
          },
          expensesinfo_water_bills: {
            required: true,
          },
          expensesinfo_transportation: {
            required: true,
          },
          expensesinfo_health_supplies: {
            required: true,
          },
          expensesinfo_food_supplies: {
            required: true,
          },
          expensesinfo_educational_supplies: {
            required: true,
          },
          expensesinfo_proven_debts: {
            required: true,
          },
          expensesinfo_other: {
            required: true,
          },
          familyinfo_family_issues: {
            required: true,
          },
          familyinfo_needs_type: {
            required: true,
          },
          beneficiaryinfo_iban: {
            required: true,
            validateIBAN: true,
          },
          beneficiaryinfo_bank: {
            required: true,
          },
          // attachments_information --------- // File rules are currently not working
          fileBeneficiaryNationalID: {
            required: true,
            accept: "application/pdf, image/*",
            filesize : 5, // here we are working with MB
          },
          fileNationalIDForBeneficiaryDependents: {
            required: true,
            accept: "application/pdf, image/*",
          },
          fileBeneficiaryNationalAddress: {
            required: true,
            accept: "application/pdf, image/*",
          },
          filePensionOrSocialInsuranceInquiry: {
            required: true,
            accept: "application/pdf, image/*",
          },
          fileFatherOrHusbandDeathCertificate: {
            required: true,
            accept: "application/pdf, image/*",
          },
          fileLetterFromPrison: {
            required: true,
            accept: "application/pdf, image/*",
          },
          fileDivorceDeed: {
            required: true,
            accept: "application/pdf, image/*",
          },
          fileChildrenResponsibilityDeed: {
            required: true,
            accept: "application/pdf, image/*",
          },
          fileLeaseContractOrTitleDeed: {
            required: true,
            accept: "application/pdf, image/*",
          },
          fileWaterOrElectricityBills: {
            required: true,
            accept: "application/pdf, image/*",
          },
          fileSocialWarrantyInquiry: {
            required: true,
            accept: "application/pdf, image/*",
          },
        },
        messages: {
          personalinfo_first_name: {
            required: "هذا الحقل مطلوب.",
          },
          personalinfo_national_id: {
            remote: "رقم الهوية / الإقامة تم استخدامه بالفعل!",
          },
          personalinfo_phone_number: {
            remote: "رقم الجوال تم استخدامه بالفعل!",
          },
          dependent_info_national_id: {
            remote: "رقم الهوية / الإقامة تم استخدامه بالفعل!",
          },
          password: {
            required: "Password required",
          },
          conf_password: {
            required: "Password required",
            equalTo: "Password don't match",
          },
          name: {
            required: "Name required",
          },
          email: {
            required: "Email required",
          },
        },
      });

      // In case of a valid form inputs, ".next" button will show the next step in the form
      if (form.valid() === true) {
        if ($("#personal_information").is(":visible")) {

          var personalNationalID = $("#id_personalinfo_national_id").val();

          // Alert the user if the provided national ID is added before in the family table
          if (isNationalIdExists(personalNationalID)) {
            alert("رقم الهوية/الإقامة لمقدم الطلب تم إضافته بالفعل في قائمة المرافقين!");
            return;
          }

          current_fs = $("#personal_information");
          // Check if the 'Skip the second step' checkbox is checked
          if ($("#skip-step").is(":checked")) {
            next_fs = $("#dependent_information"); // Set next_fs to the second step
          } else {
            next_fs = $("#housing_income_need_information"); // Proceed to the third stepas usual
          }
        } else if ($("#dependent_information").is(":visible")) {
          current_fs = $("#dependent_information");
          next_fs = $("#housing_income_need_information");
        } else if ($("#housing_income_need_information").is(":visible")) {
          
          // Count the number of checked checkboxes within the specified div
          var checked_count_needs_type = $("#id_familyinfo_needs_type input[type='checkbox']:checked").length;

          var checked_count_family_issues = $("#id_familyinfo_family_issues input[type='checkbox']:checked").length;

          // Check if at least one checkbox is checked
          if (checked_count_needs_type < 1) {
              displayMinChoiceCountNeedsTypeErrorMessage('الرجاء تحديد نوع واحد على الأقل.', 5000);
              if (checked_count_family_issues < 1) {
                displayMinChoiceCountFamilyIssuesErrorMessage('الرجاء تحديد نوع واحد على الأقل.', 5000);
                return false;
            }
              return false;
          }

          if (checked_count_family_issues < 1) {
              displayMinChoiceCountFamilyIssuesErrorMessage('الرجاء تحديد نوع واحد على الأقل.', 5000);
              if (checked_count_needs_type < 1) {
                displayMinChoiceCountNeedsTypeErrorMessage('الرجاء تحديد نوع واحد على الأقل.', 5000);
                return false;
            }
              return false;
          } 

          current_fs = $("#housing_income_need_information");
          next_fs = $("#attachments_information");
        } else if ($("#attachments_information").is(":visible")) {
          // Check if all attachments have at least one file
          var allAttachmentsValid = true;

          // Iterate over visible div containers with file input fields
          $('.fileInputContainer:visible input[type="file"]').each(function () {
            // Skip over the "other attachments" file input container
            if ($(this).attr('id') === 'id_formFileOther') {
                return true; // Continue to the next iteration
            }

            if (this.files.length === 0) {
                allAttachmentsValid = false;
                return false; // Exit the loop early since we already found an invalid attachment
            }
          });

          if (!allAttachmentsValid) {
              alert("الرجاء إرفاق ملف واحد على الأقل لكل مرفق مطلوب قبل الانتقال إلى الخطوة التالية.");
              return false;
          }

          if (!validateFileSizes()) {
              return false;
          }

          current_fs = $("#attachments_information");
          next_fs = $("#submit_confirmation");
        }

        next_fs.show();
        current_fs.hide();
      }
    });

    // Function to remove the error message
    function removeMinChoiceCountFamilyIssuesErrorMessage() {
      var errorMessageElement = document.getElementById('minChoiceCountFamilyIssuesErrorMessage');
      if (errorMessageElement) {
        errorMessageElement.remove();
      }
    }

    // When ".previous" button is clicked, the following function is called
    $(".previous").click(function () {
      if ($("#dependent_information").is(":visible")) {
        current_fs = $("#dependent_information");
        next_fs = $("#personal_information");
      } else if ($("#housing_income_need_information").is(":visible")) {
        current_fs = $("#housing_income_need_information");
        // Check if the 'Skip the second step' checkbox is checked
        if ($("#skip-step").is(":checked")) {
          next_fs = $("#dependent_information"); // Set next_fs to the second step
        } else {
          next_fs = $("#personal_information"); // Proceed to the first step as usual (there's no dependents)
        }
      } else if ($("#attachments_information").is(":visible")) {
        current_fs = $("#attachments_information");
        next_fs = $("#housing_income_need_information");
      } else if ($("#submit_confirmation").is(":visible")) {
        current_fs = $("#submit_confirmation");
        next_fs = $("#attachments_information");
      }

      next_fs.show();
      current_fs.hide();
    });

    // When "add Child button" is clicked, the following function is called
    $(".addChildBtn").click(function (event) {
      // This line prevents the form from submitting
      event.preventDefault();

      var dependentNationalID = $("#id_dependent_info_national_id").val().trim();
      // Alert the user if the provided national ID is added before in the family table
      if (isNationalIdExists(dependentNationalID)) {
          alert("رقم الهوية/الإقامة للمرافق تم إضافته بالفعل في قائمة المرافقين!");
          return;
      }

      var applierNationalID = $("#id_personalinfo_national_id").val().trim();
      // Alert the user if the provided national ID is equal to the applier national ID (in the first step)
      if (dependentNationalID === applierNationalID) {
        alert("رقم الهوية/الإقامة للمرافق لا يمكن أن يكون مماثلًا لرقم الهوية/الإقامة لمقدم الطلب!!");
        return;
      }

      let dependentIncomeJSON = getDependentIncomeTableDataAsJSON('incomeInfoTable');

      // Get all checkboxes within the specified container
      var checkboxes = document.querySelectorAll('#id_dependent_info_needs_type input[type="checkbox"]');
        
      // Check if at least one checkbox is selected
      var atLeastOneChecked = Array.from(checkboxes).some(function(checkbox) {
        return checkbox.checked;
      });

      //if (!atLeastOneChecked) {
        // Display an error message or perform any other action to indicate the requirement
      //  displayMinChoiceCountErrorMessage('الرجاء تحديد نوع واحد على الأقل.', 5000);
      //  $("#myform").validate();
      // return;
      //}

      if ($("#myform").valid() === true) {

        if (!atLeastOneChecked) {
          // Display an error message or perform any other action to indicate the requirement
          displayMinChoiceCountErrorMessage('الرجاء تحديد نوع واحد على الأقل.', 5000);
          return;
        }

        var $row = $("<tr></tr>");
        populateDependentRow($row);

        $("#family-table tbody").append($row);

        $('#dependent_information').find('input, select, textarea').each(function() {
            const $field = $(this);

            if ($field.is(':checkbox') || $field.is(':radio')) {
                $field.prop('checked', false);
            } else {
                $field.val('');
            }
        });

        // Clear existing rows in the income table
        $("#incomeInfoTableBody").empty();

        // Remove is-valid and is-invalid classes from all dependent information fields
        $("#dependent_information input, #dependent_information select, #dependent_information textarea").removeClass("is-valid is-invalid");

        // Remove error messages
        removeMaxRowErrorMessage();
        removeMinChoiceCountErrorMessage();

      } else {
        alert("الرجاء إدخال تفاصيل المرافقين!");

        if (!atLeastOneChecked) {
          // Display an error message or perform any other action to indicate the requirement
          displayMinChoiceCountErrorMessage('الرجاء تحديد نوع واحد على الأقل.', 5000);
          $("#myform").validate();
          return;
        }
      }
    });

    // Special button for dependent information step where the next button should work only of there's at least one dependent added to the list.
    $(".nextDependent").click(function () {
      // Check if on the dependent information step
      if ($("#dependent_information").is(":visible")) {
        // Check if the table has at least one row (one dependent)
        if ($("#family-table tbody tr").length === 0) {
          alert(
            "الرجاء إضافة مرافق واحد على الأقل قبل الانتقال الى الخطوة التالية. أو يمكنك الرجوع وإزالة خيار (إضافة ابناء / مرافقين)."
          );
          return false; // Prevent moving to next step
        }

        if ($("#personal_information").is(":visible")) {
          current_fs = $("#personal_information");
          // Check if the 'Skip the second step' checkbox is checked
          if ($("#skip-step").is(":checked")) {
            next_fs = $("#dependent_information"); // Set next_fs to the second step
          } else {
            next_fs = $("#housing_income_need_information"); // Proceed to the third stepas usual
          }
        } else if ($("#dependent_information").is(":visible")) {
          current_fs = $("#dependent_information");
          next_fs = $("#housing_income_need_information");
        }

        next_fs.show();
        current_fs.hide();
      }
    });


    $(".next, .previous, .nextDependent").click(function () {
      updateFormStep();
    });


    function updateFormStep() {
      // Check which div is visible and update form steps accordingly
      if ($("#personal_information").is(":visible")) {
        // Update for personal_information
        updateSteps(1);
      } else if ($("#dependent_information").is(":visible")) {
        // Update for dependent_information
        updateSteps(2);
      } else if ($("#housing_income_need_information").is(":visible")) {
        // Update for housing_income_need_information
        updateSteps(3);
      } else if ($("#attachments_information").is(":visible")) {
        updateSteps(4);
      } else if ($("#submit_confirmation").is(":visible")) {
        updateSteps(5);
      }
    }

    // Get the modal element
    var editModal = new bootstrap.Modal(document.getElementById('editModal'));

    // Add event listener to the modal's shown event
    editModal._element.addEventListener('shown.bs.modal', handleModalShown);

  });
</script>
{% endblock %}
